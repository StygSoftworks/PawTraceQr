import{c as Be,r as Q,j as s,s as pe}from"./index-i6Cfs9b8.js";import{a as he,C as W,c as X,b as Z,d as ee}from"./card-unPYtR4G.js";import{B as se}from"./button-DznmDcQc.js";import{B as be}from"./badge-m7swUxc1.js";import{c as je}from"./createLucideIcon-SwlWEdXL.js";import{C as ye}from"./credit-card-C9Soc_0X.js";/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ke=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],_e=je("circle-check-big",ke);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ae=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Me=je("loader-circle",Ae);function Te(){const e=Be.c(73),[ge,te]=Q.useState(!0),[t,S]=Q.useState(null),[i,Ne]=Q.useState(null),ve="P-74N21144BH7224146NDSS6MY",Se="P-002596997V2924715NDSS6MY",Pe="P-55P549186J183725GNDSS6NA",we="P-4R0311392G060980KNDSS6NA",P="https://www.sandbox.paypal.com",w=i?`${P}/webapps/billing/plans/subscribe?plan_id=${ve}&custom_id=${i}`:void 0,C=i?`${P}/webapps/billing/plans/subscribe?plan_id=${Se}&custom_id=${i}`:void 0,$=i?`${P}/webapps/billing/plans/subscribe?plan_id=${Pe}&custom_id=${i}`:void 0,B=i?`${P}/webapps/billing/plans/subscribe?plan_id=${we}&custom_id=${i}`:void 0;let k,A;e[0]===Symbol.for("react.memo_cache_sentinel")?(k=()=>{let l=!0;const a=async function(){te(!0);const{data:Ce}=await pe.auth.getUser(),xe=Ce.user?.id??null;if(!l)return;if(Ne(xe),!xe){S(null),te(!1);return}const{data:$e,error:ue}=await pe.from("subscriptions").select("*").eq("user_id",xe).single();l&&(ue?(ue.code==="PGRST116"||console.error("load subscription error:",ue),S(null)):S($e),te(!1))};a();const fe=()=>document.visibilityState==="visible"&&a();return document.addEventListener("visibilitychange",fe),()=>{l=!1,document.removeEventListener("visibilitychange",fe)}},A=[],e[0]=k,e[1]=A):(k=e[0],A=e[1]),Q.useEffect(k,A);const M=!!t?.paypal_sub_id_base,D=t?.addon_quantity??0,L=t?.status==="active",le=(M&&L?3:0)+D;let E;e[2]!==D||e[3]!==M||e[4]!==L||e[5]!==le?(E={hasBase:M,addonCount:D,petLimit:le,isActive:L},e[2]=D,e[3]=M,e[4]=L,e[5]=le,e[6]=E):E=e[6];const{hasBase:n,addonCount:r,petLimit:ae,isActive:I}=E;if(ge){let l;e[7]===Symbol.for("react.memo_cache_sentinel")?(l=s.jsx("h1",{className:"text-3xl md:text-4xl font-bold mb-8 tracking-tight",children:"Billing & Subscription"}),e[7]=l):l=e[7];let a;return e[8]===Symbol.for("react.memo_cache_sentinel")?(a=s.jsxs("div",{className:"container mx-auto px-4 sm:px-6 py-10 md:py-14 max-w-3xl",children:[l,s.jsx("div",{className:"flex justify-center items-center py-12",children:s.jsx(Me,{className:"animate-spin h-8 w-8 text-primary"})})]}),e[8]=a):a=e[8],a}if(!i){let l;e[9]===Symbol.for("react.memo_cache_sentinel")?(l=s.jsx("h1",{className:"text-3xl md:text-4xl font-bold mb-8 tracking-tight",children:"Billing & Subscription"}),e[9]=l):l=e[9];let a;return e[10]===Symbol.for("react.memo_cache_sentinel")?(a=s.jsxs("div",{className:"container mx-auto px-4 sm:px-6 py-10 md:py-14 max-w-3xl",children:[l,s.jsx(W,{className:"mb-8",children:s.jsxs(X,{children:[s.jsx(Z,{children:"Sign in required"}),s.jsx(ee,{children:"Please sign in to view or manage your subscription."})]})})]}),e[10]=a):a=e[10],a}let Y;e[11]!==t?(Y=t?.next_billing_time?new Date(t.next_billing_time).toLocaleDateString():null,e[11]=t,e[12]=Y):Y=e[12];const c=Y;let U;e[13]===Symbol.for("react.memo_cache_sentinel")?(U=s.jsx("h1",{className:"text-3xl md:text-4xl font-bold mb-8 tracking-tight",children:"Billing & Subscription"}),e[13]=U):U=e[13];let R;e[14]===Symbol.for("react.memo_cache_sentinel")?(R=s.jsx(Z,{children:"Your plan summary"}),e[14]=R):R=e[14];const ie=n?"Base plan active":"No base plan";let o;e[15]!==ae?(o=s.jsx("span",{className:"font-medium",children:ae}),e[15]=ae,e[16]=o):o=e[16];let d;e[17]!==r||e[18]!==ie||e[19]!==o?(d=s.jsxs(X,{children:[R,s.jsxs(ee,{children:[ie," • ",r," add-on(s) • Pet limit:"," ",o]})]}),e[17]=r,e[18]=ie,e[19]=o,e[20]=d):d=e[20];let m;e[21]!==r||e[22]!==n||e[23]!==I||e[24]!==c||e[25]!==t?(m=s.jsx(he,{children:t?s.jsxs("div",{className:"divide-y",children:[n&&s.jsxs("div",{className:"flex justify-between items-center py-3",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium",children:"PawTrace Base Plan"}),s.jsxs("div",{className:"text-xs text-muted-foreground",children:["Status: ",s.jsx(be,{variant:"outline",className:"uppercase",children:t.status})," ",c&&s.jsxs(s.Fragment,{children:["• Renews: ",c]})]}),t.paypal_plan_id_base&&s.jsxs("div",{className:"text-xs text-muted-foreground",children:["Plan ID: ",s.jsx("span",{className:"font-mono",children:t.paypal_plan_id_base})]})]}),I?s.jsx(_e,{className:"h-5 w-5 text-green-500"}):s.jsx(ye,{className:"h-5 w-5 text-muted-foreground"})]}),t.paypal_sub_id_addon&&r>0&&s.jsxs("div",{className:"flex justify-between items-center py-3",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"font-medium",children:["Extra Pets Add-ons (",r,")"]}),s.jsxs("div",{className:"text-xs text-muted-foreground",children:["Status: ",s.jsx(be,{variant:"outline",className:"uppercase",children:t.status})," ",c&&s.jsxs(s.Fragment,{children:["• Renews: ",c]})]}),t.paypal_plan_id_addon&&s.jsxs("div",{className:"text-xs text-muted-foreground",children:["Plan ID: ",s.jsx("span",{className:"font-mono",children:t.paypal_plan_id_addon})]})]}),I?s.jsx(_e,{className:"h-5 w-5 text-green-500"}):s.jsx(ye,{className:"h-5 w-5 text-muted-foreground"})]})]}):s.jsx("div",{className:"text-sm text-muted-foreground",children:"No subscription on file."})}),e[21]=r,e[22]=n,e[23]=I,e[24]=c,e[25]=t,e[26]=m):m=e[26];let x;e[27]!==d||e[28]!==m?(x=s.jsxs(W,{className:"mb-8",children:[d,m]}),e[27]=d,e[28]=m,e[29]=x):x=e[29];let T;e[30]===Symbol.for("react.memo_cache_sentinel")?(T=s.jsxs(X,{children:[s.jsx(Z,{children:"PawTrace Base"}),s.jsx(ee,{children:"Up to 3 pets included"})]}),e[30]=T):T=e[30];let q;e[31]===Symbol.for("react.memo_cache_sentinel")?(q=s.jsx("div",{className:"text-2xl font-bold",children:"$3 / mo"}),e[31]=q):q=e[31];const ne=!w||n,re=n?"Already Subscribed":"Subscribe Monthly (PayPal)";let u;e[32]!==w||e[33]!==re?(u=s.jsx("a",{href:w,target:"_blank",rel:"noreferrer",children:re}),e[32]=w,e[33]=re,e[34]=u):u=e[34];let h;e[35]!==ne||e[36]!==u?(h=s.jsx(se,{asChild:!0,className:"w-full",disabled:ne,children:u}),e[35]=ne,e[36]=u,e[37]=h):h=e[37];let G,z;e[38]===Symbol.for("react.memo_cache_sentinel")?(G=s.jsx("div",{className:"text-sm text-muted-foreground",children:"or"}),z=s.jsx("div",{className:"text-2xl font-bold",children:"$30 / yr"}),e[38]=G,e[39]=z):(G=e[38],z=e[39]);const ce=!C||n,oe=n?"Already Subscribed":"Subscribe Yearly (PayPal)";let f;e[40]!==C||e[41]!==oe?(f=s.jsx("a",{href:C,target:"_blank",rel:"noreferrer",children:oe}),e[40]=C,e[41]=oe,e[42]=f):f=e[42];let p;e[43]!==ce||e[44]!==f?(p=s.jsx(se,{asChild:!0,variant:"outline",className:"w-full",disabled:ce,children:f}),e[43]=ce,e[44]=f,e[45]=p):p=e[45];let b;e[46]!==h||e[47]!==p?(b=s.jsxs(W,{children:[T,s.jsxs(he,{className:"space-y-3",children:[q,h,G,z,p]})]}),e[46]=h,e[47]=p,e[48]=b):b=e[48];let F;e[49]===Symbol.for("react.memo_cache_sentinel")?(F=s.jsxs(X,{children:[s.jsx(Z,{children:"Extra Pets Add-on"}),s.jsx(ee,{children:"Each add-on adds 1 pet"})]}),e[49]=F):F=e[49];let H;e[50]===Symbol.for("react.memo_cache_sentinel")?(H=s.jsx("div",{className:"text-2xl font-bold",children:"$1.50 / mo"}),e[50]=H):H=e[50];const de=!$;let y;e[51]!==$?(y=s.jsx("a",{href:$,target:"_blank",rel:"noreferrer",children:"Add Monthly (PayPal)"}),e[51]=$,e[52]=y):y=e[52];let _;e[53]!==de||e[54]!==y?(_=s.jsx(se,{asChild:!0,className:"w-full",disabled:de,children:y}),e[53]=de,e[54]=y,e[55]=_):_=e[55];let V,J;e[56]===Symbol.for("react.memo_cache_sentinel")?(V=s.jsx("div",{className:"text-sm text-muted-foreground",children:"or"}),J=s.jsx("div",{className:"text-2xl font-bold",children:"$18 / yr"}),e[56]=V,e[57]=J):(V=e[56],J=e[57]);const me=!B;let j;e[58]!==B?(j=s.jsx("a",{href:B,target:"_blank",rel:"noreferrer",children:"Add Yearly (PayPal)"}),e[58]=B,e[59]=j):j=e[59];let g;e[60]!==me||e[61]!==j?(g=s.jsx(se,{asChild:!0,variant:"outline",className:"w-full",disabled:me,children:j}),e[60]=me,e[61]=j,e[62]=g):g=e[62];let N;e[63]!==_||e[64]!==g?(N=s.jsxs(W,{children:[F,s.jsxs(he,{className:"space-y-3",children:[H,_,V,J,g]})]}),e[63]=_,e[64]=g,e[65]=N):N=e[65];let v;e[66]!==b||e[67]!==N?(v=s.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[b,N]}),e[66]=b,e[67]=N,e[68]=v):v=e[68];let K;e[69]===Symbol.for("react.memo_cache_sentinel")?(K=s.jsx("p",{className:"mt-6 text-xs text-muted-foreground",children:"Payments are handled by PayPal. After subscribing, it can take a moment for your subscription to appear here. To cancel or manage your subscription, log in to PayPal and go to Settings → Payments → Manage automatic payments."}),e[69]=K):K=e[69];let O;return e[70]!==x||e[71]!==v?(O=s.jsxs("div",{className:"container mx-auto px-4 sm:px-6 py-10 md:py-14 max-w-3xl",children:[U,x,v,K]}),e[70]=x,e[71]=v,e[72]=O):O=e[72],O}export{Te as default};
