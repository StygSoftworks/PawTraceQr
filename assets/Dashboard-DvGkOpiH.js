const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./browser-BNqLoEEY.js","./index-LiyORjfY.js","./index-B0tW_8hb.css"])))=>i.map(i=>d[i]);
import{c as $,j as t,u as ft,_ as is,s as Z,a as ht,r as i,D as Qe,b as cs,T as ds}from"./index-LiyORjfY.js";import{u as At}from"./useQuery-BWUsH6HQ.js";import{u as us}from"./useMutation-CFcSmhg3.js";import{a as et,b as tt,c as rt,d as st,C as De}from"./card-DsIDPC-J.js";import{B as at}from"./badge-Cct1v-sm.js";import{T as ms,a as ps,b as yt,c as jt}from"./tabs-BC2ISPjj.js";import{B as G}from"./button-CR-ztS2M.js";import{S as ye}from"./skeleton-Dsok01LA.js";import{A as Mt,a as Dt,b as Ot,c as Bt,d as Lt,e as Ft,f as $t,g as Vt,T as zt,h as fs}from"./textarea-2pZnMBTo.js";import{u as hs,S as Ut,P as Nt,a as gs}from"./switch-DqMEx6LL.js";import{L as X,I as ne}from"./input-V7LCgHC1.js";import{A as qt,a as Ht}from"./alert-SP1DgqLf.js";import{l as xs,D as Wt,a as Kt,b as Qt,c as Gt,d as Yt,e as Xt}from"./dialog-CW-6S3IL.js";import{c as J,a as U}from"./createLucideIcon-Te5DWUAa.js";import{Q as Zt,I as vs}from"./qr-code-Dm7-kLVI.js";import{T as ot,c as Fe,R as Jt,A as gt,C as er,a as tr}from"./index-DdDisVo2.js";import{u as bs,a as ws,o as St,s as oe,n as ys,_ as js,b as Ns}from"./zod-CNEpRKNq.js";import{P as L,r as rr}from"./index-QHkby-3j.js";import{u as Ss,a as nt,c as sr,b as le,d as Cs,e as z,f as ie,g as Ps,P as ar}from"./index-OLaYxycV.js";import{u as te,c as or,a as Te}from"./index-4Aqkm6gw.js";import{P as nr,h as lr,u as ir,R as cr,F as dr,D as ur,a as ks,b as _s,O as Rs,C as Ts}from"./index-DYR0Y6wq.js";import{C as mr}from"./chevron-down-C90WfCcI.js";import{C as pr}from"./check-CJHDuZLm.js";import{C as Es}from"./chevron-up-Cd_qJ8Ej.js";import{S as Ge}from"./separator-DrS1Fnld.js";import{X as Is}from"./x-C-xR7I8D.js";import{P as ge}from"./paw-print-D6FK8Z1H.js";import{C as Oe}from"./circle-alert-i5zhLawW.js";import{F as As}from"./file-text-Dut7DcPy.js";import{E as Ms}from"./eye-DRg2qUxx.js";import"./index-vQwgpaKD.js";/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ds=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],Os=J("activity",Ds);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bs=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],Ls=J("calendar",Bs);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fs=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],$s=J("camera",Fs);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vs=[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]],zs=J("chevrons-up-down",Vs);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Us=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],qs=J("copy",Us);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hs=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],Ws=J("download",Hs);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ks=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Ct=J("plus",Ks);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qs=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],Be=J("refresh-cw",Qs);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gs=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],Ys=J("search",Gs);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xs=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],Zs=J("square-pen",Xs);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Js=[["path",{d:"m18 2 4 4",key:"22kx64"}],["path",{d:"m17 7 3-3",key:"1w1zoj"}],["path",{d:"M19 9 8.7 19.3c-1 1-2.5 1-3.4 0l-.6-.6c-1-1-1-2.5 0-3.4L15 5",key:"1exhtz"}],["path",{d:"m9 11 4 4",key:"rovt3i"}],["path",{d:"m5 19-3 3",key:"59f2uf"}],["path",{d:"m14 4 6 6",key:"yqp9t2"}]],ea=J("syringe",Js);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ta=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],ra=J("upload",ta);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sa=[["circle",{cx:"12",cy:"5",r:"3",key:"rqqgnr"}],["path",{d:"M6.5 8a2 2 0 0 0-1.905 1.46L2.1 18.5A2 2 0 0 0 4 21h16a2 2 0 0 0 1.925-2.54L19.4 9.5A2 2 0 0 0 17.48 8Z",key:"56o5sh"}]],aa=J("weight",sa);function oa(s){const e=$.c(8);let r,a;e[0]!==s?({className:r,...a}=s,e[0]=s,e[1]=r,e[2]=a):(r=e[1],a=e[2]);let o;e[3]!==r?(o=U("w-full caption-bottom text-sm",r),e[3]=r,e[4]=o):o=e[4];let n;return e[5]!==a||e[6]!==o?(n=t.jsx("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:t.jsx("table",{"data-slot":"table",className:o,...a})}),e[5]=a,e[6]=o,e[7]=n):n=e[7],n}function na(s){const e=$.c(8);let r,a;e[0]!==s?({className:r,...a}=s,e[0]=s,e[1]=r,e[2]=a):(r=e[1],a=e[2]);let o;e[3]!==r?(o=U("[&_tr]:border-b",r),e[3]=r,e[4]=o):o=e[4];let n;return e[5]!==a||e[6]!==o?(n=t.jsx("thead",{"data-slot":"table-header",className:o,...a}),e[5]=a,e[6]=o,e[7]=n):n=e[7],n}function la(s){const e=$.c(8);let r,a;e[0]!==s?({className:r,...a}=s,e[0]=s,e[1]=r,e[2]=a):(r=e[1],a=e[2]);let o;e[3]!==r?(o=U("[&_tr:last-child]:border-0",r),e[3]=r,e[4]=o):o=e[4];let n;return e[5]!==a||e[6]!==o?(n=t.jsx("tbody",{"data-slot":"table-body",className:o,...a}),e[5]=a,e[6]=o,e[7]=n):n=e[7],n}function fr(s){const e=$.c(8);let r,a;e[0]!==s?({className:r,...a}=s,e[0]=s,e[1]=r,e[2]=a):(r=e[1],a=e[2]);let o;e[3]!==r?(o=U("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",r),e[3]=r,e[4]=o):o=e[4];let n;return e[5]!==a||e[6]!==o?(n=t.jsx("tr",{"data-slot":"table-row",className:o,...a}),e[5]=a,e[6]=o,e[7]=n):n=e[7],n}function Ae(s){const e=$.c(8);let r,a;e[0]!==s?({className:r,...a}=s,e[0]=s,e[1]=r,e[2]=a):(r=e[1],a=e[2]);let o;e[3]!==r?(o=U("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",r),e[3]=r,e[4]=o):o=e[4];let n;return e[5]!==a||e[6]!==o?(n=t.jsx("th",{"data-slot":"table-head",className:o,...a}),e[5]=a,e[6]=o,e[7]=n):n=e[7],n}function Me(s){const e=$.c(8);let r,a;e[0]!==s?({className:r,...a}=s,e[0]=s,e[1]=r,e[2]=a):(r=e[1],a=e[2]);let o;e[3]!==r?(o=U("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",r),e[3]=r,e[4]=o):o=e[4];let n;return e[5]!==a||e[6]!==o?(n=t.jsx("td",{"data-slot":"table-cell",className:o,...a}),e[5]=a,e[6]=o,e[7]=n):n=e[7],n}function ia(s){const e=$.c(18),{days:r}=s,a=r===void 0?14:r,{user:o}=ft(),n=o?.id??null;let l,d;e[0]!==a||e[1]!==n?(l=["scan_events",n,a],d=()=>n?xs(n,a):Promise.resolve([]),e[0]=a,e[1]=n,e[2]=l,e[3]=d):(l=e[2],d=e[3]);const c=!!n;let u;e[4]!==l||e[5]!==d||e[6]!==c?(u={queryKey:l,queryFn:d,enabled:c,staleTime:3e4},e[4]=l,e[5]=d,e[6]=c,e[7]=u):u=e[7];const{data:m,isLoading:g,isError:w}=At(u);let x;e[8]===Symbol.for("react.memo_cache_sentinel")?(x=t.jsx(tt,{children:"QR Scan Events"}),e[8]=x):x=e[8];let v;e[9]!==a?(v=t.jsxs(rt,{children:[x,t.jsxs(st,{children:["Last ",a," days"]})]}),e[9]=a,e[10]=v):v=e[10];let f;e[11]!==m||e[12]!==w||e[13]!==g?(f=t.jsx(et,{children:g?t.jsx("div",{className:"text-sm text-muted-foreground",children:"Loading…"}):w?t.jsx("div",{className:"text-sm text-destructive",children:"Failed to load scans."}):m?.length?t.jsxs(oa,{children:[t.jsx(na,{children:t.jsxs(fr,{children:[t.jsx(Ae,{children:"When"}),t.jsx(Ae,{children:"Pet"}),t.jsx(Ae,{children:"Location"}),t.jsx(Ae,{children:"Referrer"})]})}),t.jsx(la,{children:m.map(ca)})]}):t.jsx("div",{className:"text-sm text-muted-foreground",children:"No scans yet."})}),e[11]=m,e[12]=w,e[13]=g,e[14]=f):f=e[14];let j;return e[15]!==v||e[16]!==f?(j=t.jsxs(De,{children:[v,f]}),e[15]=v,e[16]=f,e[17]=j):j=e[17],j}function ca(s){return t.jsxs(fr,{children:[t.jsx(Me,{className:"whitespace-nowrap",children:new Date(s.scanned_at).toLocaleString()}),t.jsx(Me,{className:"font-medium",children:s.pet_name}),t.jsx(Me,{className:"text-muted-foreground",children:s.city||s.region||s.country?[s.city,s.region,s.country].filter(Boolean).join(", "):t.jsx(at,{variant:"outline",children:"unknown"})}),t.jsx(Me,{className:"truncate max-w-[240px] text-muted-foreground",children:s.referrer||"—"})]},s.id)}async function da(s){return await(await is(async()=>{const{default:r}=await import("./browser-BNqLoEEY.js").then(a=>a.b);return{default:r}},__vite__mapDeps([0,1,2]),import.meta.url)).default.toDataURL(s,{errorCorrectionLevel:"M",margin:1,scale:8,color:{dark:"#000000",light:"#ffffff"}})}async function ua(s){return await(await fetch(s)).blob()}async function ma(s,e,r){const a=`${s}/${e}.png`,{error:o}=await Z.storage.from("pet-qr").upload(a,r,{contentType:"image/png",upsert:!0});if(o)throw o;const{data:n}=Z.storage.from("pet-qr").getPublicUrl(a);return n.publicUrl}async function xt(s,e){const r=`https://www.pawtraceqr.com/p/${e}`,a=await da(r),o=await ua(a);return await ma(s,e,o)}let pa=s=>crypto.getRandomValues(new Uint8Array(s)),fa=(s,e,r)=>{let a=(2<<Math.log2(s.length-1))-1,o=-~(1.6*a*e/s.length);return(n=e)=>{let l="";for(;;){let d=r(o),c=o|0;for(;c--;)if(l+=s[d[c]&a]||"",l.length>=n)return l}}},ha=(s,e=21)=>fa(s,e|0,pa);const ga="0123456789abcdefghijklmnopqrstuvwxyz";function xa(s=4){return ha(ga,s)()}async function va(s){let e=3;for(let r=0;r<7;r++){const a=xa(e),{data:o,error:n}=await Z.from("pets").insert({...s,short_id:a}).select("*").single();if(!n)return o;if(n.code==="23505"&&n.message.includes("pets_short_id_key")){e++;continue}throw n}throw new Error("Could not generate a unique short id for pet.")}async function Re(s,e){const{error:r}=await Z.from("pets").update(e).eq("id",s);if(r)throw r;const{data:a,error:o}=await Z.from("pets").select("*").eq("id",s).maybeSingle();return o?(console.warn("updatePet: select after update blocked by RLS:",o?.message),{id:s,...e}):a??{id:s,...e}}async function ba(s){const{data:e,error:r}=await Z.from("pets").select("*").eq("owner_id",s).order("created_at",{ascending:!1});if(r)throw r;return e??[]}async function Pt(s,e,r){if(!r||r.size===0)throw new Error("Empty image blob");const a=r.type||"image/webp",o=a==="image/jpeg"||a==="image/jpg"?"jpg":a==="image/png"?"png":a==="image/avif"?"avif":"webp",n=Date.now(),l=`${s}/${e}-${n}.${o}`,{error:d}=await Z.storage.from("pet-photos").upload(l,r,{contentType:a,upsert:!1});if(d)throw console.error("storage.upload error:",d),d;const{data:c}=Z.storage.from("pet-photos").getPublicUrl(l);return c.publicUrl}async function wa(s){const{error:e}=await Z.from("pets").delete().eq("id",s);if(e)throw e}async function ya(s){if(!s)return;const e=s.indexOf("/pet-photos/");if(e===-1)return;const r=s.substring(e+12);if(!r)return;const{error:a}=await Z.storage.from("pet-photos").remove([r]);a&&console.warn("storage.remove warning:",a.message)}async function ja(s){const{data:e,error:r}=await Z.from("pets").select("id, qr_url").eq("owner_id",s);if(r)throw r;for(const a of e??[])if(!a.qr_url){const o=await xt(s,a.id),{error:n}=await Z.from("pets").update({qr_url:o}).eq("id",a.id);if(n)throw n}}function Na({pet:s,open:e,onOpenChange:r,ownerId:a}){const o=ht(),[n,l]=i.useState(!1),[d,c]=i.useState(s?.qr_url??null),u=async()=>{if(!(!s||d)){l(!0);try{const v=await xt(a,s.short_id);await Re(s.id,{qr_url:v}),c(v),await o.invalidateQueries({queryKey:["pets",a]})}catch(v){alert(v?.message??"Failed to generate QR code")}finally{l(!1)}}},m=v=>{v&&s&&!s.qr_url&&!d&&u(),r(v)},g=async v=>{if(v)try{await navigator.clipboard.writeText(v),alert("Copied to clipboard")}catch{alert("Failed to copy")}},w=v=>{if(!v||!s)return;const f=document.createElement("a");f.href=v,f.download=`${s.name}-qr.png`,f.target="_blank",f.rel="noopener noreferrer",f.click()},x=d||s?.qr_url;return t.jsx(Wt,{open:e,onOpenChange:m,children:t.jsxs(Kt,{className:"sm:max-w-md bg-white dark:bg-[#1E1F24] border-2",children:[t.jsx(Qt,{className:"space-y-3",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"h-10 w-10 bg-[#3B3A7A] rounded-xl flex items-center justify-center shadow-md",children:t.jsx(Zt,{className:"h-5 w-5 text-white"})}),t.jsxs("div",{children:[t.jsxs(Gt,{className:"text-xl text-foreground",children:["QR Code ",s?`– ${s.name}`:""]}),t.jsx(Yt,{className:"text-muted-foreground",children:"Scan to open the public pet page"})]})]})}),t.jsx("div",{className:"flex flex-col items-center gap-4 py-4",children:n?t.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground py-8",children:[t.jsx(Be,{className:"h-4 w-4 animate-spin"}),"Generating QR code…"]}):x?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"p-8 bg-white rounded-md border-4 border-[#3B3A7A] shadow-lg",children:t.jsx("img",{src:x,alt:"QR code",className:"h-64 w-64 object-contain",style:{backgroundColor:"#ffffff"}})}),t.jsxs("div",{className:"w-full space-y-2",children:[t.jsx(X,{className:"text-sm font-semibold text-foreground",children:"QR Code URL"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(ne,{readOnly:!0,value:x,className:"text-xs bg-background text-foreground border-2"}),t.jsx(G,{type:"button",variant:"outline",size:"icon",onClick:()=>g(x),className:"flex-shrink-0",title:"Copy URL",children:t.jsx(qs,{className:"h-4 w-4"})})]}),t.jsxs(G,{type:"button",onClick:()=>w(x),className:"w-full gap-2 bg-[#3B3A7A] hover:bg-[#3B3A7A]/90 text-white",children:[t.jsx(Ws,{className:"h-4 w-4"}),"Download QR Code"]})]})]}):t.jsx("div",{className:"text-sm text-muted-foreground py-8",children:"No QR code available"})}),t.jsx(Xt,{children:t.jsx(G,{type:"button",variant:"outline",onClick:()=>r(!1),className:"border-2",children:"Close"})})]})})}function Sa({pet:s,open:e,onOpenChange:r,onDeleted:a}){const[o,n]=i.useState(!1),l=async()=>{if(s){n(!0);try{s.photo_url&&await ya(s.photo_url),await wa(s.id),a(),r(!1)}catch(d){alert(d?.message??"Failed to delete pet")}finally{n(!1)}}};return s?t.jsx(Mt,{open:e,onOpenChange:r,children:t.jsxs(Dt,{children:[t.jsxs(Ot,{children:[t.jsxs(Bt,{className:"flex items-center gap-2",children:[t.jsx(ot,{className:"h-5 w-5 text-destructive"}),"Delete ",s.name,"?"]}),t.jsxs(Lt,{children:["This will permanently remove the pet profile",s.photo_url?" and its photo":"",". This action cannot be undone."]})]}),t.jsxs(Ft,{children:[t.jsx($t,{disabled:o,children:"Cancel"}),t.jsx(Vt,{disabled:o,onClick:l,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90 gap-2",children:o?t.jsxs(t.Fragment,{children:[t.jsx(Be,{className:"h-4 w-4 animate-spin"}),"Deleting…"]}):t.jsxs(t.Fragment,{children:[t.jsx(zt,{className:"h-4 w-4"}),"Delete"]})})]})]})}):null}function Ca(s){const e=ht(),[r,a]=i.useState(!1);return{backfillAllQR:async()=>{if(s){a(!0);try{await ja(s),await e.invalidateQueries({queryKey:["pets",s]}),alert("QR backfill completed successfully")}catch(n){alert(n?.message??"Backfill failed")}finally{a(!1)}}},isBackfilling:r}}function kt(s,[e,r]){return Math.min(r,Math.max(e,s))}var hr=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),Pa="VisuallyHidden",ka=i.forwardRef((s,e)=>t.jsx(L.span,{...s,ref:e,style:{...hr,...s.style}}));ka.displayName=Pa;var _a=[" ","Enter","ArrowUp","ArrowDown"],Ra=[" ","Enter"],xe="Select",[$e,Ve,Ta]=Cs(xe),[Ce]=sr(xe,[Ta,Fe]),ze=Fe(),[Ea,de]=Ce(xe),[Ia,Aa]=Ce(xe),gr=s=>{const{__scopeSelect:e,children:r,open:a,defaultOpen:o,onOpenChange:n,value:l,defaultValue:d,onValueChange:c,dir:u,name:m,autoComplete:g,disabled:w,required:x,form:v}=s,f=ze(e),[j,R]=i.useState(null),[S,k]=i.useState(null),[T,h]=i.useState(!1),A=Ss(u),[C,D]=nt({prop:a,defaultProp:o??!1,onChange:n,caller:xe}),[F,y]=nt({prop:l,defaultProp:d,onChange:c,caller:xe}),B=i.useRef(null),q=j?v||!!j.closest("form"):!0,[re,K]=i.useState(new Set),Q=Array.from(re).map(H=>H.props.value).join(";");return t.jsx(Jt,{...f,children:t.jsxs(Ea,{required:x,scope:e,trigger:j,onTriggerChange:R,valueNode:S,onValueNodeChange:k,valueNodeHasChildren:T,onValueNodeHasChildrenChange:h,contentId:le(),value:F,onValueChange:y,open:C,onOpenChange:D,dir:A,triggerPointerDownPosRef:B,disabled:w,children:[t.jsx($e.Provider,{scope:e,children:t.jsx(Ia,{scope:s.__scopeSelect,onNativeOptionAdd:i.useCallback(H=>{K(Y=>new Set(Y).add(H))},[]),onNativeOptionRemove:i.useCallback(H=>{K(Y=>{const ee=new Set(Y);return ee.delete(H),ee})},[]),children:r})}),q?t.jsxs(Lr,{"aria-hidden":!0,required:x,tabIndex:-1,name:m,autoComplete:g,value:F,onChange:H=>y(H.target.value),disabled:w,form:v,children:[F===void 0?t.jsx("option",{value:""}):null,Array.from(re)]},Q):null]})})};gr.displayName=xe;var xr="SelectTrigger",vr=i.forwardRef((s,e)=>{const{__scopeSelect:r,disabled:a=!1,...o}=s,n=ze(r),l=de(xr,r),d=l.disabled||a,c=te(e,l.onTriggerChange),u=Ve(r),m=i.useRef("touch"),[g,w,x]=$r(f=>{const j=u().filter(k=>!k.disabled),R=j.find(k=>k.value===l.value),S=Vr(j,f,R);S!==void 0&&l.onValueChange(S.value)}),v=f=>{d||(l.onOpenChange(!0),x()),f&&(l.triggerPointerDownPosRef.current={x:Math.round(f.pageX),y:Math.round(f.pageY)})};return t.jsx(gt,{asChild:!0,...n,children:t.jsx(L.button,{type:"button",role:"combobox","aria-controls":l.contentId,"aria-expanded":l.open,"aria-required":l.required,"aria-autocomplete":"none",dir:l.dir,"data-state":l.open?"open":"closed",disabled:d,"data-disabled":d?"":void 0,"data-placeholder":Fr(l.value)?"":void 0,...o,ref:c,onClick:z(o.onClick,f=>{f.currentTarget.focus(),m.current!=="mouse"&&v(f)}),onPointerDown:z(o.onPointerDown,f=>{m.current=f.pointerType;const j=f.target;j.hasPointerCapture(f.pointerId)&&j.releasePointerCapture(f.pointerId),f.button===0&&f.ctrlKey===!1&&f.pointerType==="mouse"&&(v(f),f.preventDefault())}),onKeyDown:z(o.onKeyDown,f=>{const j=g.current!=="";!(f.ctrlKey||f.altKey||f.metaKey)&&f.key.length===1&&w(f.key),!(j&&f.key===" ")&&_a.includes(f.key)&&(v(),f.preventDefault())})})})});vr.displayName=xr;var br="SelectValue",wr=i.forwardRef((s,e)=>{const{__scopeSelect:r,className:a,style:o,children:n,placeholder:l="",...d}=s,c=de(br,r),{onValueNodeHasChildrenChange:u}=c,m=n!==void 0,g=te(e,c.onValueNodeChange);return ie(()=>{u(m)},[u,m]),t.jsx(L.span,{...d,ref:g,style:{pointerEvents:"none"},children:Fr(c.value)?t.jsx(t.Fragment,{children:l}):n})});wr.displayName=br;var Ma="SelectIcon",yr=i.forwardRef((s,e)=>{const{__scopeSelect:r,children:a,...o}=s;return t.jsx(L.span,{"aria-hidden":!0,...o,ref:e,children:a||"▼"})});yr.displayName=Ma;var Da="SelectPortal",jr=s=>t.jsx(nr,{asChild:!0,...s});jr.displayName=Da;var ve="SelectContent",Nr=i.forwardRef((s,e)=>{const r=de(ve,s.__scopeSelect),[a,o]=i.useState();if(ie(()=>{o(new DocumentFragment)},[]),!r.open){const n=a;return n?rr.createPortal(t.jsx(Sr,{scope:s.__scopeSelect,children:t.jsx($e.Slot,{scope:s.__scopeSelect,children:t.jsx("div",{children:s.children})})}),n):null}return t.jsx(Cr,{...s,ref:e})});Nr.displayName=ve;var ae=10,[Sr,ue]=Ce(ve),Oa="SelectContentImpl",Ba=or("SelectContent.RemoveScroll"),Cr=i.forwardRef((s,e)=>{const{__scopeSelect:r,position:a="item-aligned",onCloseAutoFocus:o,onEscapeKeyDown:n,onPointerDownOutside:l,side:d,sideOffset:c,align:u,alignOffset:m,arrowPadding:g,collisionBoundary:w,collisionPadding:x,sticky:v,hideWhenDetached:f,avoidCollisions:j,...R}=s,S=de(ve,r),[k,T]=i.useState(null),[h,A]=i.useState(null),C=te(e,b=>T(b)),[D,F]=i.useState(null),[y,B]=i.useState(null),q=Ve(r),[re,K]=i.useState(!1),Q=i.useRef(!1);i.useEffect(()=>{if(k)return lr(k)},[k]),ir();const H=i.useCallback(b=>{const[I,...M]=q().map(W=>W.ref.current),[O]=M.slice(-1),V=document.activeElement;for(const W of b)if(W===V||(W?.scrollIntoView({block:"nearest"}),W===I&&h&&(h.scrollTop=0),W===O&&h&&(h.scrollTop=h.scrollHeight),W?.focus(),document.activeElement!==V))return},[q,h]),Y=i.useCallback(()=>H([D,k]),[H,D,k]);i.useEffect(()=>{re&&Y()},[re,Y]);const{onOpenChange:ee,triggerPointerDownPosRef:se}=S;i.useEffect(()=>{if(k){let b={x:0,y:0};const I=O=>{b={x:Math.abs(Math.round(O.pageX)-(se.current?.x??0)),y:Math.abs(Math.round(O.pageY)-(se.current?.y??0))}},M=O=>{b.x<=10&&b.y<=10?O.preventDefault():k.contains(O.target)||ee(!1),document.removeEventListener("pointermove",I),se.current=null};return se.current!==null&&(document.addEventListener("pointermove",I),document.addEventListener("pointerup",M,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",I),document.removeEventListener("pointerup",M,{capture:!0})}}},[k,ee,se]),i.useEffect(()=>{const b=()=>ee(!1);return window.addEventListener("blur",b),window.addEventListener("resize",b),()=>{window.removeEventListener("blur",b),window.removeEventListener("resize",b)}},[ee]);const[we,pe]=$r(b=>{const I=q().filter(V=>!V.disabled),M=I.find(V=>V.ref.current===document.activeElement),O=Vr(I,b,M);O&&setTimeout(()=>O.ref.current.focus())}),p=i.useCallback((b,I,M)=>{const O=!Q.current&&!M;(S.value!==void 0&&S.value===I||O)&&(F(b),O&&(Q.current=!0))},[S.value]),P=i.useCallback(()=>k?.focus(),[k]),_=i.useCallback((b,I,M)=>{const O=!Q.current&&!M;(S.value!==void 0&&S.value===I||O)&&B(b)},[S.value]),N=a==="popper"?lt:Pr,E=N===lt?{side:d,sideOffset:c,align:u,alignOffset:m,arrowPadding:g,collisionBoundary:w,collisionPadding:x,sticky:v,hideWhenDetached:f,avoidCollisions:j}:{};return t.jsx(Sr,{scope:r,content:k,viewport:h,onViewportChange:A,itemRefCallback:p,selectedItem:D,onItemLeave:P,itemTextRefCallback:_,focusSelectedItem:Y,selectedItemText:y,position:a,isPositioned:re,searchRef:we,children:t.jsx(cr,{as:Ba,allowPinchZoom:!0,children:t.jsx(dr,{asChild:!0,trapped:S.open,onMountAutoFocus:b=>{b.preventDefault()},onUnmountAutoFocus:z(o,b=>{S.trigger?.focus({preventScroll:!0}),b.preventDefault()}),children:t.jsx(ur,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:n,onPointerDownOutside:l,onFocusOutside:b=>b.preventDefault(),onDismiss:()=>S.onOpenChange(!1),children:t.jsx(N,{role:"listbox",id:S.contentId,"data-state":S.open?"open":"closed",dir:S.dir,onContextMenu:b=>b.preventDefault(),...R,...E,onPlaced:()=>K(!0),ref:C,style:{display:"flex",flexDirection:"column",outline:"none",...R.style},onKeyDown:z(R.onKeyDown,b=>{const I=b.ctrlKey||b.altKey||b.metaKey;if(b.key==="Tab"&&b.preventDefault(),!I&&b.key.length===1&&pe(b.key),["ArrowUp","ArrowDown","Home","End"].includes(b.key)){let O=q().filter(V=>!V.disabled).map(V=>V.ref.current);if(["ArrowUp","End"].includes(b.key)&&(O=O.slice().reverse()),["ArrowUp","ArrowDown"].includes(b.key)){const V=b.target,W=O.indexOf(V);O=O.slice(W+1)}setTimeout(()=>H(O)),b.preventDefault()}})})})})})})});Cr.displayName=Oa;var La="SelectItemAlignedPosition",Pr=i.forwardRef((s,e)=>{const{__scopeSelect:r,onPlaced:a,...o}=s,n=de(ve,r),l=ue(ve,r),[d,c]=i.useState(null),[u,m]=i.useState(null),g=te(e,C=>m(C)),w=Ve(r),x=i.useRef(!1),v=i.useRef(!0),{viewport:f,selectedItem:j,selectedItemText:R,focusSelectedItem:S}=l,k=i.useCallback(()=>{if(n.trigger&&n.valueNode&&d&&u&&f&&j&&R){const C=n.trigger.getBoundingClientRect(),D=u.getBoundingClientRect(),F=n.valueNode.getBoundingClientRect(),y=R.getBoundingClientRect();if(n.dir!=="rtl"){const V=y.left-D.left,W=F.left-V,fe=C.left-W,he=C.width+fe,He=Math.max(he,D.width),We=window.innerWidth-ae,Ke=kt(W,[ae,Math.max(ae,We-He)]);d.style.minWidth=he+"px",d.style.left=Ke+"px"}else{const V=D.right-y.right,W=window.innerWidth-F.right-V,fe=window.innerWidth-C.right-W,he=C.width+fe,He=Math.max(he,D.width),We=window.innerWidth-ae,Ke=kt(W,[ae,Math.max(ae,We-He)]);d.style.minWidth=he+"px",d.style.right=Ke+"px"}const B=w(),q=window.innerHeight-ae*2,re=f.scrollHeight,K=window.getComputedStyle(u),Q=parseInt(K.borderTopWidth,10),H=parseInt(K.paddingTop,10),Y=parseInt(K.borderBottomWidth,10),ee=parseInt(K.paddingBottom,10),se=Q+H+re+ee+Y,we=Math.min(j.offsetHeight*5,se),pe=window.getComputedStyle(f),p=parseInt(pe.paddingTop,10),P=parseInt(pe.paddingBottom,10),_=C.top+C.height/2-ae,N=q-_,E=j.offsetHeight/2,b=j.offsetTop+E,I=Q+H+b,M=se-I;if(I<=_){const V=B.length>0&&j===B[B.length-1].ref.current;d.style.bottom="0px";const W=u.clientHeight-f.offsetTop-f.offsetHeight,fe=Math.max(N,E+(V?P:0)+W+Y),he=I+fe;d.style.height=he+"px"}else{const V=B.length>0&&j===B[0].ref.current;d.style.top="0px";const fe=Math.max(_,Q+f.offsetTop+(V?p:0)+E)+M;d.style.height=fe+"px",f.scrollTop=I-_+f.offsetTop}d.style.margin=`${ae}px 0`,d.style.minHeight=we+"px",d.style.maxHeight=q+"px",a?.(),requestAnimationFrame(()=>x.current=!0)}},[w,n.trigger,n.valueNode,d,u,f,j,R,n.dir,a]);ie(()=>k(),[k]);const[T,h]=i.useState();ie(()=>{u&&h(window.getComputedStyle(u).zIndex)},[u]);const A=i.useCallback(C=>{C&&v.current===!0&&(k(),S?.(),v.current=!1)},[k,S]);return t.jsx($a,{scope:r,contentWrapper:d,shouldExpandOnScrollRef:x,onScrollButtonChange:A,children:t.jsx("div",{ref:c,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:T},children:t.jsx(L.div,{...o,ref:g,style:{boxSizing:"border-box",maxHeight:"100%",...o.style}})})})});Pr.displayName=La;var Fa="SelectPopperPosition",lt=i.forwardRef((s,e)=>{const{__scopeSelect:r,align:a="start",collisionPadding:o=ae,...n}=s,l=ze(r);return t.jsx(er,{...l,...n,ref:e,align:a,collisionPadding:o,style:{boxSizing:"border-box",...n.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});lt.displayName=Fa;var[$a,vt]=Ce(ve,{}),it="SelectViewport",kr=i.forwardRef((s,e)=>{const{__scopeSelect:r,nonce:a,...o}=s,n=ue(it,r),l=vt(it,r),d=te(e,n.onViewportChange),c=i.useRef(0);return t.jsxs(t.Fragment,{children:[t.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:a}),t.jsx($e.Slot,{scope:r,children:t.jsx(L.div,{"data-radix-select-viewport":"",role:"presentation",...o,ref:d,style:{position:"relative",flex:1,overflow:"hidden auto",...o.style},onScroll:z(o.onScroll,u=>{const m=u.currentTarget,{contentWrapper:g,shouldExpandOnScrollRef:w}=l;if(w?.current&&g){const x=Math.abs(c.current-m.scrollTop);if(x>0){const v=window.innerHeight-ae*2,f=parseFloat(g.style.minHeight),j=parseFloat(g.style.height),R=Math.max(f,j);if(R<v){const S=R+x,k=Math.min(v,S),T=S-k;g.style.height=k+"px",g.style.bottom==="0px"&&(m.scrollTop=T>0?T:0,g.style.justifyContent="flex-end")}}}c.current=m.scrollTop})})})]})});kr.displayName=it;var _r="SelectGroup",[Va,za]=Ce(_r),Ua=i.forwardRef((s,e)=>{const{__scopeSelect:r,...a}=s,o=le();return t.jsx(Va,{scope:r,id:o,children:t.jsx(L.div,{role:"group","aria-labelledby":o,...a,ref:e})})});Ua.displayName=_r;var Rr="SelectLabel",qa=i.forwardRef((s,e)=>{const{__scopeSelect:r,...a}=s,o=za(Rr,r);return t.jsx(L.div,{id:o.id,...a,ref:e})});qa.displayName=Rr;var Le="SelectItem",[Ha,Tr]=Ce(Le),Er=i.forwardRef((s,e)=>{const{__scopeSelect:r,value:a,disabled:o=!1,textValue:n,...l}=s,d=de(Le,r),c=ue(Le,r),u=d.value===a,[m,g]=i.useState(n??""),[w,x]=i.useState(!1),v=te(e,S=>c.itemRefCallback?.(S,a,o)),f=le(),j=i.useRef("touch"),R=()=>{o||(d.onValueChange(a),d.onOpenChange(!1))};if(a==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return t.jsx(Ha,{scope:r,value:a,disabled:o,textId:f,isSelected:u,onItemTextChange:i.useCallback(S=>{g(k=>k||(S?.textContent??"").trim())},[]),children:t.jsx($e.ItemSlot,{scope:r,value:a,disabled:o,textValue:m,children:t.jsx(L.div,{role:"option","aria-labelledby":f,"data-highlighted":w?"":void 0,"aria-selected":u&&w,"data-state":u?"checked":"unchecked","aria-disabled":o||void 0,"data-disabled":o?"":void 0,tabIndex:o?void 0:-1,...l,ref:v,onFocus:z(l.onFocus,()=>x(!0)),onBlur:z(l.onBlur,()=>x(!1)),onClick:z(l.onClick,()=>{j.current!=="mouse"&&R()}),onPointerUp:z(l.onPointerUp,()=>{j.current==="mouse"&&R()}),onPointerDown:z(l.onPointerDown,S=>{j.current=S.pointerType}),onPointerMove:z(l.onPointerMove,S=>{j.current=S.pointerType,o?c.onItemLeave?.():j.current==="mouse"&&S.currentTarget.focus({preventScroll:!0})}),onPointerLeave:z(l.onPointerLeave,S=>{S.currentTarget===document.activeElement&&c.onItemLeave?.()}),onKeyDown:z(l.onKeyDown,S=>{c.searchRef?.current!==""&&S.key===" "||(Ra.includes(S.key)&&R(),S.key===" "&&S.preventDefault())})})})})});Er.displayName=Le;var _e="SelectItemText",Ir=i.forwardRef((s,e)=>{const{__scopeSelect:r,className:a,style:o,...n}=s,l=de(_e,r),d=ue(_e,r),c=Tr(_e,r),u=Aa(_e,r),[m,g]=i.useState(null),w=te(e,R=>g(R),c.onItemTextChange,R=>d.itemTextRefCallback?.(R,c.value,c.disabled)),x=m?.textContent,v=i.useMemo(()=>t.jsx("option",{value:c.value,disabled:c.disabled,children:x},c.value),[c.disabled,c.value,x]),{onNativeOptionAdd:f,onNativeOptionRemove:j}=u;return ie(()=>(f(v),()=>j(v)),[f,j,v]),t.jsxs(t.Fragment,{children:[t.jsx(L.span,{id:c.textId,...n,ref:w}),c.isSelected&&l.valueNode&&!l.valueNodeHasChildren?rr.createPortal(n.children,l.valueNode):null]})});Ir.displayName=_e;var Ar="SelectItemIndicator",Mr=i.forwardRef((s,e)=>{const{__scopeSelect:r,...a}=s;return Tr(Ar,r).isSelected?t.jsx(L.span,{"aria-hidden":!0,...a,ref:e}):null});Mr.displayName=Ar;var ct="SelectScrollUpButton",Dr=i.forwardRef((s,e)=>{const r=ue(ct,s.__scopeSelect),a=vt(ct,s.__scopeSelect),[o,n]=i.useState(!1),l=te(e,a.onScrollButtonChange);return ie(()=>{if(r.viewport&&r.isPositioned){let d=function(){const u=c.scrollTop>0;n(u)};const c=r.viewport;return d(),c.addEventListener("scroll",d),()=>c.removeEventListener("scroll",d)}},[r.viewport,r.isPositioned]),o?t.jsx(Br,{...s,ref:l,onAutoScroll:()=>{const{viewport:d,selectedItem:c}=r;d&&c&&(d.scrollTop=d.scrollTop-c.offsetHeight)}}):null});Dr.displayName=ct;var dt="SelectScrollDownButton",Or=i.forwardRef((s,e)=>{const r=ue(dt,s.__scopeSelect),a=vt(dt,s.__scopeSelect),[o,n]=i.useState(!1),l=te(e,a.onScrollButtonChange);return ie(()=>{if(r.viewport&&r.isPositioned){let d=function(){const u=c.scrollHeight-c.clientHeight,m=Math.ceil(c.scrollTop)<u;n(m)};const c=r.viewport;return d(),c.addEventListener("scroll",d),()=>c.removeEventListener("scroll",d)}},[r.viewport,r.isPositioned]),o?t.jsx(Br,{...s,ref:l,onAutoScroll:()=>{const{viewport:d,selectedItem:c}=r;d&&c&&(d.scrollTop=d.scrollTop+c.offsetHeight)}}):null});Or.displayName=dt;var Br=i.forwardRef((s,e)=>{const{__scopeSelect:r,onAutoScroll:a,...o}=s,n=ue("SelectScrollButton",r),l=i.useRef(null),d=Ve(r),c=i.useCallback(()=>{l.current!==null&&(window.clearInterval(l.current),l.current=null)},[]);return i.useEffect(()=>()=>c(),[c]),ie(()=>{d().find(m=>m.ref.current===document.activeElement)?.ref.current?.scrollIntoView({block:"nearest"})},[d]),t.jsx(L.div,{"aria-hidden":!0,...o,ref:e,style:{flexShrink:0,...o.style},onPointerDown:z(o.onPointerDown,()=>{l.current===null&&(l.current=window.setInterval(a,50))}),onPointerMove:z(o.onPointerMove,()=>{n.onItemLeave?.(),l.current===null&&(l.current=window.setInterval(a,50))}),onPointerLeave:z(o.onPointerLeave,()=>{c()})})}),Wa="SelectSeparator",Ka=i.forwardRef((s,e)=>{const{__scopeSelect:r,...a}=s;return t.jsx(L.div,{"aria-hidden":!0,...a,ref:e})});Ka.displayName=Wa;var ut="SelectArrow",Qa=i.forwardRef((s,e)=>{const{__scopeSelect:r,...a}=s,o=ze(r),n=de(ut,r),l=ue(ut,r);return n.open&&l.position==="popper"?t.jsx(tr,{...o,...a,ref:e}):null});Qa.displayName=ut;var Ga="SelectBubbleInput",Lr=i.forwardRef(({__scopeSelect:s,value:e,...r},a)=>{const o=i.useRef(null),n=te(a,o),l=hs(e);return i.useEffect(()=>{const d=o.current;if(!d)return;const c=window.HTMLSelectElement.prototype,m=Object.getOwnPropertyDescriptor(c,"value").set;if(l!==e&&m){const g=new Event("change",{bubbles:!0});m.call(d,e),d.dispatchEvent(g)}},[l,e]),t.jsx(L.select,{...r,style:{...hr,...r.style},ref:n,defaultValue:e})});Lr.displayName=Ga;function Fr(s){return s===""||s===void 0}function $r(s){const e=Ps(s),r=i.useRef(""),a=i.useRef(0),o=i.useCallback(l=>{const d=r.current+l;e(d),(function c(u){r.current=u,window.clearTimeout(a.current),u!==""&&(a.current=window.setTimeout(()=>c(""),1e3))})(d)},[e]),n=i.useCallback(()=>{r.current="",window.clearTimeout(a.current)},[]);return i.useEffect(()=>()=>window.clearTimeout(a.current),[]),[r,o,n]}function Vr(s,e,r){const o=e.length>1&&Array.from(e).every(u=>u===e[0])?e[0]:e,n=r?s.indexOf(r):-1;let l=Ya(s,Math.max(n,0));o.length===1&&(l=l.filter(u=>u!==r));const c=l.find(u=>u.textValue.toLowerCase().startsWith(o.toLowerCase()));return c!==r?c:void 0}function Ya(s,e){return s.map((r,a)=>s[(e+a)%s.length])}var Xa=gr,Za=vr,Ja=wr,eo=yr,to=jr,ro=Nr,so=kr,ao=Er,oo=Ir,no=Mr,lo=Dr,io=Or;function co(s){const e=$.c(4);let r;e[0]!==s?({...r}=s,e[0]=s,e[1]=r):r=e[1];let a;return e[2]!==r?(a=t.jsx(Xa,{"data-slot":"select",...r}),e[2]=r,e[3]=a):a=e[3],a}function uo(s){const e=$.c(4);let r;e[0]!==s?({...r}=s,e[0]=s,e[1]=r):r=e[1];let a;return e[2]!==r?(a=t.jsx(Ja,{"data-slot":"select-value",...r}),e[2]=r,e[3]=a):a=e[3],a}function mo(s){const e=$.c(13);let r,a,o,n;e[0]!==s?({className:a,size:n,children:r,...o}=s,e[0]=s,e[1]=r,e[2]=a,e[3]=o,e[4]=n):(r=e[1],a=e[2],o=e[3],n=e[4]);const l=n===void 0?"default":n;let d;e[5]!==a?(d=U("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",a),e[5]=a,e[6]=d):d=e[6];let c;e[7]===Symbol.for("react.memo_cache_sentinel")?(c=t.jsx(eo,{asChild:!0,children:t.jsx(mr,{className:"size-4 opacity-50"})}),e[7]=c):c=e[7];let u;return e[8]!==r||e[9]!==o||e[10]!==l||e[11]!==d?(u=t.jsxs(Za,{"data-slot":"select-trigger","data-size":l,className:d,...o,children:[r,c]}),e[8]=r,e[9]=o,e[10]=l,e[11]=d,e[12]=u):u=e[12],u}function po(s){const e=$.c(20);let r,a,o,n;e[0]!==s?({className:a,children:r,position:n,...o}=s,e[0]=s,e[1]=r,e[2]=a,e[3]=o,e[4]=n):(r=e[1],a=e[2],o=e[3],n=e[4]);const l=n===void 0?"popper":n,d=l==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1";let c;e[5]!==a||e[6]!==d?(c=U("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md",d,a),e[5]=a,e[6]=d,e[7]=c):c=e[7];let u;e[8]===Symbol.for("react.memo_cache_sentinel")?(u=t.jsx(fo,{}),e[8]=u):u=e[8];const m=l==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1";let g;e[9]!==m?(g=U("p-1",m),e[9]=m,e[10]=g):g=e[10];let w;e[11]!==r||e[12]!==g?(w=t.jsx(so,{className:g,children:r}),e[11]=r,e[12]=g,e[13]=w):w=e[13];let x;e[14]===Symbol.for("react.memo_cache_sentinel")?(x=t.jsx(ho,{}),e[14]=x):x=e[14];let v;return e[15]!==l||e[16]!==o||e[17]!==c||e[18]!==w?(v=t.jsx(to,{children:t.jsxs(ro,{"data-slot":"select-content",className:c,position:l,...o,children:[u,w,x]})}),e[15]=l,e[16]=o,e[17]=c,e[18]=w,e[19]=v):v=e[19],v}function Ye(s){const e=$.c(13);let r,a,o;e[0]!==s?({className:a,children:r,...o}=s,e[0]=s,e[1]=r,e[2]=a,e[3]=o):(r=e[1],a=e[2],o=e[3]);let n;e[4]!==a?(n=U("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",a),e[4]=a,e[5]=n):n=e[5];let l;e[6]===Symbol.for("react.memo_cache_sentinel")?(l=t.jsx("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:t.jsx(no,{children:t.jsx(pr,{className:"size-4"})})}),e[6]=l):l=e[6];let d;e[7]!==r?(d=t.jsx(oo,{children:r}),e[7]=r,e[8]=d):d=e[8];let c;return e[9]!==o||e[10]!==n||e[11]!==d?(c=t.jsxs(ao,{"data-slot":"select-item",className:n,...o,children:[l,d]}),e[9]=o,e[10]=n,e[11]=d,e[12]=c):c=e[12],c}function fo(s){const e=$.c(9);let r,a;e[0]!==s?({className:r,...a}=s,e[0]=s,e[1]=r,e[2]=a):(r=e[1],a=e[2]);let o;e[3]!==r?(o=U("flex cursor-default items-center justify-center py-1",r),e[3]=r,e[4]=o):o=e[4];let n;e[5]===Symbol.for("react.memo_cache_sentinel")?(n=t.jsx(Es,{className:"size-4"}),e[5]=n):n=e[5];let l;return e[6]!==a||e[7]!==o?(l=t.jsx(lo,{"data-slot":"select-scroll-up-button",className:o,...a,children:n}),e[6]=a,e[7]=o,e[8]=l):l=e[8],l}function ho(s){const e=$.c(9);let r,a;e[0]!==s?({className:r,...a}=s,e[0]=s,e[1]=r,e[2]=a):(r=e[1],a=e[2]);let o;e[3]!==r?(o=U("flex cursor-default items-center justify-center py-1",r),e[3]=r,e[4]=o):o=e[4];let n;e[5]===Symbol.for("react.memo_cache_sentinel")?(n=t.jsx(mr,{className:"size-4"}),e[5]=n):n=e[5];let l;return e[6]!==a||e[7]!==o?(l=t.jsx(io,{"data-slot":"select-scroll-down-button",className:o,...a,children:n}),e[6]=a,e[7]=o,e[8]=l):l=e[8],l}var Ue="Popover",[zr]=sr(Ue,[Fe]),Ee=Fe(),[go,me]=zr(Ue),Ur=s=>{const{__scopePopover:e,children:r,open:a,defaultOpen:o,onOpenChange:n,modal:l=!1}=s,d=Ee(e),c=i.useRef(null),[u,m]=i.useState(!1),[g,w]=nt({prop:a,defaultProp:o??!1,onChange:n,caller:Ue});return t.jsx(Jt,{...d,children:t.jsx(go,{scope:e,contentId:le(),triggerRef:c,open:g,onOpenChange:w,onOpenToggle:i.useCallback(()=>w(x=>!x),[w]),hasCustomAnchor:u,onCustomAnchorAdd:i.useCallback(()=>m(!0),[]),onCustomAnchorRemove:i.useCallback(()=>m(!1),[]),modal:l,children:r})})};Ur.displayName=Ue;var qr="PopoverAnchor",xo=i.forwardRef((s,e)=>{const{__scopePopover:r,...a}=s,o=me(qr,r),n=Ee(r),{onCustomAnchorAdd:l,onCustomAnchorRemove:d}=o;return i.useEffect(()=>(l(),()=>d()),[l,d]),t.jsx(gt,{...n,...a,ref:e})});xo.displayName=qr;var Hr="PopoverTrigger",Wr=i.forwardRef((s,e)=>{const{__scopePopover:r,...a}=s,o=me(Hr,r),n=Ee(r),l=te(e,o.triggerRef),d=t.jsx(L.button,{type:"button","aria-haspopup":"dialog","aria-expanded":o.open,"aria-controls":o.contentId,"data-state":Xr(o.open),...a,ref:l,onClick:z(s.onClick,o.onOpenToggle)});return o.hasCustomAnchor?d:t.jsx(gt,{asChild:!0,...n,children:d})});Wr.displayName=Hr;var bt="PopoverPortal",[vo,bo]=zr(bt,{forceMount:void 0}),Kr=s=>{const{__scopePopover:e,forceMount:r,children:a,container:o}=s,n=me(bt,e);return t.jsx(vo,{scope:e,forceMount:r,children:t.jsx(ar,{present:r||n.open,children:t.jsx(nr,{asChild:!0,container:o,children:a})})})};Kr.displayName=bt;var Se="PopoverContent",Qr=i.forwardRef((s,e)=>{const r=bo(Se,s.__scopePopover),{forceMount:a=r.forceMount,...o}=s,n=me(Se,s.__scopePopover);return t.jsx(ar,{present:a||n.open,children:n.modal?t.jsx(yo,{...o,ref:e}):t.jsx(jo,{...o,ref:e})})});Qr.displayName=Se;var wo=or("PopoverContent.RemoveScroll"),yo=i.forwardRef((s,e)=>{const r=me(Se,s.__scopePopover),a=i.useRef(null),o=te(e,a),n=i.useRef(!1);return i.useEffect(()=>{const l=a.current;if(l)return lr(l)},[]),t.jsx(cr,{as:wo,allowPinchZoom:!0,children:t.jsx(Gr,{...s,ref:o,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:z(s.onCloseAutoFocus,l=>{l.preventDefault(),n.current||r.triggerRef.current?.focus()}),onPointerDownOutside:z(s.onPointerDownOutside,l=>{const d=l.detail.originalEvent,c=d.button===0&&d.ctrlKey===!0,u=d.button===2||c;n.current=u},{checkForDefaultPrevented:!1}),onFocusOutside:z(s.onFocusOutside,l=>l.preventDefault(),{checkForDefaultPrevented:!1})})})}),jo=i.forwardRef((s,e)=>{const r=me(Se,s.__scopePopover),a=i.useRef(!1),o=i.useRef(!1);return t.jsx(Gr,{...s,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:n=>{s.onCloseAutoFocus?.(n),n.defaultPrevented||(a.current||r.triggerRef.current?.focus(),n.preventDefault()),a.current=!1,o.current=!1},onInteractOutside:n=>{s.onInteractOutside?.(n),n.defaultPrevented||(a.current=!0,n.detail.originalEvent.type==="pointerdown"&&(o.current=!0));const l=n.target;r.triggerRef.current?.contains(l)&&n.preventDefault(),n.detail.originalEvent.type==="focusin"&&o.current&&n.preventDefault()}})}),Gr=i.forwardRef((s,e)=>{const{__scopePopover:r,trapFocus:a,onOpenAutoFocus:o,onCloseAutoFocus:n,disableOutsidePointerEvents:l,onEscapeKeyDown:d,onPointerDownOutside:c,onFocusOutside:u,onInteractOutside:m,...g}=s,w=me(Se,r),x=Ee(r);return ir(),t.jsx(dr,{asChild:!0,loop:!0,trapped:a,onMountAutoFocus:o,onUnmountAutoFocus:n,children:t.jsx(ur,{asChild:!0,disableOutsidePointerEvents:l,onInteractOutside:m,onEscapeKeyDown:d,onPointerDownOutside:c,onFocusOutside:u,onDismiss:()=>w.onOpenChange(!1),children:t.jsx(er,{"data-state":Xr(w.open),role:"dialog",id:w.contentId,...x,...g,ref:e,style:{...g.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),Yr="PopoverClose",No=i.forwardRef((s,e)=>{const{__scopePopover:r,...a}=s,o=me(Yr,r);return t.jsx(L.button,{type:"button",...a,ref:e,onClick:z(s.onClick,()=>o.onOpenChange(!1))})});No.displayName=Yr;var So="PopoverArrow",Co=i.forwardRef((s,e)=>{const{__scopePopover:r,...a}=s,o=Ee(r);return t.jsx(tr,{...o,...a,ref:e})});Co.displayName=So;function Xr(s){return s?"open":"closed"}var Po=Ur,ko=Wr,_o=Kr,Ro=Qr;function To(s){const e=$.c(4);let r;e[0]!==s?({...r}=s,e[0]=s,e[1]=r):r=e[1];let a;return e[2]!==r?(a=t.jsx(Po,{"data-slot":"popover",...r}),e[2]=r,e[3]=a):a=e[3],a}function Eo(s){const e=$.c(4);let r;e[0]!==s?({...r}=s,e[0]=s,e[1]=r):r=e[1];let a;return e[2]!==r?(a=t.jsx(ko,{"data-slot":"popover-trigger",...r}),e[2]=r,e[3]=a):a=e[3],a}function Io(s){const e=$.c(12);let r,a,o,n;e[0]!==s?({className:r,align:o,sideOffset:n,...a}=s,e[0]=s,e[1]=r,e[2]=a,e[3]=o,e[4]=n):(r=e[1],a=e[2],o=e[3],n=e[4]);const l=o===void 0?"center":o,d=n===void 0?4:n;let c;e[5]!==r?(c=U("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-72 origin-(--radix-popover-content-transform-origin) rounded-md border p-4 shadow-md outline-hidden",r),e[5]=r,e[6]=c):c=e[6];let u;return e[7]!==l||e[8]!==a||e[9]!==d||e[10]!==c?(u=t.jsx(_o,{children:t.jsx(Ro,{"data-slot":"popover-content",align:l,sideOffset:d,className:c,...a})}),e[7]=l,e[8]=a,e[9]=d,e[10]=c,e[11]=u):u=e[11],u}var _t=1,Ao=.9,Mo=.8,Do=.17,Xe=.1,Ze=.999,Oo=.9999,Bo=.99,Lo=/[\\\/_+.#"@\[\(\{&]/,Fo=/[\\\/_+.#"@\[\(\{&]/g,$o=/[\s-]/,Zr=/[\s-]/g;function mt(s,e,r,a,o,n,l){if(n===e.length)return o===s.length?_t:Bo;var d=`${o},${n}`;if(l[d]!==void 0)return l[d];for(var c=a.charAt(n),u=r.indexOf(c,o),m=0,g,w,x,v;u>=0;)g=mt(s,e,r,a,u+1,n+1,l),g>m&&(u===o?g*=_t:Lo.test(s.charAt(u-1))?(g*=Mo,x=s.slice(o,u-1).match(Fo),x&&o>0&&(g*=Math.pow(Ze,x.length))):$o.test(s.charAt(u-1))?(g*=Ao,v=s.slice(o,u-1).match(Zr),v&&o>0&&(g*=Math.pow(Ze,v.length))):(g*=Do,o>0&&(g*=Math.pow(Ze,u-o))),s.charAt(u)!==e.charAt(n)&&(g*=Oo)),(g<Xe&&r.charAt(u-1)===a.charAt(n+1)||a.charAt(n+1)===a.charAt(n)&&r.charAt(u-1)!==a.charAt(n))&&(w=mt(s,e,r,a,u+1,n+2,l),w*Xe>g&&(g=w*Xe)),g>m&&(m=g),u=r.indexOf(c,u+1);return l[d]=m,m}function Rt(s){return s.toLowerCase().replace(Zr," ")}function Vo(s,e,r){return s=r&&r.length>0?`${s+" "+r.join(" ")}`:s,mt(s,e,Rt(s),Rt(e),0,0,{})}var ke='[cmdk-group=""]',Je='[cmdk-group-items=""]',zo='[cmdk-group-heading=""]',Jr='[cmdk-item=""]',Tt=`${Jr}:not([aria-disabled="true"])`,pt="cmdk-item-select",je="data-value",Uo=(s,e,r)=>Vo(s,e,r),es=i.createContext(void 0),Ie=()=>i.useContext(es),ts=i.createContext(void 0),wt=()=>i.useContext(ts),rs=i.createContext(void 0),ss=i.forwardRef((s,e)=>{let r=Ne(()=>{var p,P;return{search:"",value:(P=(p=s.value)!=null?p:s.defaultValue)!=null?P:"",selectedItemId:void 0,filtered:{count:0,items:new Map,groups:new Set}}}),a=Ne(()=>new Set),o=Ne(()=>new Map),n=Ne(()=>new Map),l=Ne(()=>new Set),d=as(s),{label:c,children:u,value:m,onValueChange:g,filter:w,shouldFilter:x,loop:v,disablePointerSelection:f=!1,vimBindings:j=!0,...R}=s,S=le(),k=le(),T=le(),h=i.useRef(null),A=en();be(()=>{if(m!==void 0){let p=m.trim();r.current.value=p,C.emit()}},[m]),be(()=>{A(6,re)},[]);let C=i.useMemo(()=>({subscribe:p=>(l.current.add(p),()=>l.current.delete(p)),snapshot:()=>r.current,setState:(p,P,_)=>{var N,E,b,I;if(!Object.is(r.current[p],P)){if(r.current[p]=P,p==="search")q(),y(),A(1,B);else if(p==="value"){if(document.activeElement.hasAttribute("cmdk-input")||document.activeElement.hasAttribute("cmdk-root")){let M=document.getElementById(T);M?M.focus():(N=document.getElementById(S))==null||N.focus()}if(A(7,()=>{var M;r.current.selectedItemId=(M=K())==null?void 0:M.id,C.emit()}),_||A(5,re),((E=d.current)==null?void 0:E.value)!==void 0){let M=P??"";(I=(b=d.current).onValueChange)==null||I.call(b,M);return}}C.emit()}},emit:()=>{l.current.forEach(p=>p())}}),[]),D=i.useMemo(()=>({value:(p,P,_)=>{var N;P!==((N=n.current.get(p))==null?void 0:N.value)&&(n.current.set(p,{value:P,keywords:_}),r.current.filtered.items.set(p,F(P,_)),A(2,()=>{y(),C.emit()}))},item:(p,P)=>(a.current.add(p),P&&(o.current.has(P)?o.current.get(P).add(p):o.current.set(P,new Set([p]))),A(3,()=>{q(),y(),r.current.value||B(),C.emit()}),()=>{n.current.delete(p),a.current.delete(p),r.current.filtered.items.delete(p);let _=K();A(4,()=>{q(),_?.getAttribute("id")===p&&B(),C.emit()})}),group:p=>(o.current.has(p)||o.current.set(p,new Set),()=>{n.current.delete(p),o.current.delete(p)}),filter:()=>d.current.shouldFilter,label:c||s["aria-label"],getDisablePointerSelection:()=>d.current.disablePointerSelection,listId:S,inputId:T,labelId:k,listInnerRef:h}),[]);function F(p,P){var _,N;let E=(N=(_=d.current)==null?void 0:_.filter)!=null?N:Uo;return p?E(p,r.current.search,P):0}function y(){if(!r.current.search||d.current.shouldFilter===!1)return;let p=r.current.filtered.items,P=[];r.current.filtered.groups.forEach(N=>{let E=o.current.get(N),b=0;E.forEach(I=>{let M=p.get(I);b=Math.max(M,b)}),P.push([N,b])});let _=h.current;Q().sort((N,E)=>{var b,I;let M=N.getAttribute("id"),O=E.getAttribute("id");return((b=p.get(O))!=null?b:0)-((I=p.get(M))!=null?I:0)}).forEach(N=>{let E=N.closest(Je);E?E.appendChild(N.parentElement===E?N:N.closest(`${Je} > *`)):_.appendChild(N.parentElement===_?N:N.closest(`${Je} > *`))}),P.sort((N,E)=>E[1]-N[1]).forEach(N=>{var E;let b=(E=h.current)==null?void 0:E.querySelector(`${ke}[${je}="${encodeURIComponent(N[0])}"]`);b?.parentElement.appendChild(b)})}function B(){let p=Q().find(_=>_.getAttribute("aria-disabled")!=="true"),P=p?.getAttribute(je);C.setState("value",P||void 0)}function q(){var p,P,_,N;if(!r.current.search||d.current.shouldFilter===!1){r.current.filtered.count=a.current.size;return}r.current.filtered.groups=new Set;let E=0;for(let b of a.current){let I=(P=(p=n.current.get(b))==null?void 0:p.value)!=null?P:"",M=(N=(_=n.current.get(b))==null?void 0:_.keywords)!=null?N:[],O=F(I,M);r.current.filtered.items.set(b,O),O>0&&E++}for(let[b,I]of o.current)for(let M of I)if(r.current.filtered.items.get(M)>0){r.current.filtered.groups.add(b);break}r.current.filtered.count=E}function re(){var p,P,_;let N=K();N&&(((p=N.parentElement)==null?void 0:p.firstChild)===N&&((_=(P=N.closest(ke))==null?void 0:P.querySelector(zo))==null||_.scrollIntoView({block:"nearest"})),N.scrollIntoView({block:"nearest"}))}function K(){var p;return(p=h.current)==null?void 0:p.querySelector(`${Jr}[aria-selected="true"]`)}function Q(){var p;return Array.from(((p=h.current)==null?void 0:p.querySelectorAll(Tt))||[])}function H(p){let P=Q()[p];P&&C.setState("value",P.getAttribute(je))}function Y(p){var P;let _=K(),N=Q(),E=N.findIndex(I=>I===_),b=N[E+p];(P=d.current)!=null&&P.loop&&(b=E+p<0?N[N.length-1]:E+p===N.length?N[0]:N[E+p]),b&&C.setState("value",b.getAttribute(je))}function ee(p){let P=K(),_=P?.closest(ke),N;for(;_&&!N;)_=p>0?Zo(_,ke):Jo(_,ke),N=_?.querySelector(Tt);N?C.setState("value",N.getAttribute(je)):Y(p)}let se=()=>H(Q().length-1),we=p=>{p.preventDefault(),p.metaKey?se():p.altKey?ee(1):Y(1)},pe=p=>{p.preventDefault(),p.metaKey?H(0):p.altKey?ee(-1):Y(-1)};return i.createElement(L.div,{ref:e,tabIndex:-1,...R,"cmdk-root":"",onKeyDown:p=>{var P;(P=R.onKeyDown)==null||P.call(R,p);let _=p.nativeEvent.isComposing||p.keyCode===229;if(!(p.defaultPrevented||_))switch(p.key){case"n":case"j":{j&&p.ctrlKey&&we(p);break}case"ArrowDown":{we(p);break}case"p":case"k":{j&&p.ctrlKey&&pe(p);break}case"ArrowUp":{pe(p);break}case"Home":{p.preventDefault(),H(0);break}case"End":{p.preventDefault(),se();break}case"Enter":{p.preventDefault();let N=K();if(N){let E=new Event(pt);N.dispatchEvent(E)}}}}},i.createElement("label",{"cmdk-label":"",htmlFor:D.inputId,id:D.labelId,style:rn},c),qe(s,p=>i.createElement(ts.Provider,{value:C},i.createElement(es.Provider,{value:D},p))))}),qo=i.forwardRef((s,e)=>{var r,a;let o=le(),n=i.useRef(null),l=i.useContext(rs),d=Ie(),c=as(s),u=(a=(r=c.current)==null?void 0:r.forceMount)!=null?a:l?.forceMount;be(()=>{if(!u)return d.item(o,l?.id)},[u]);let m=os(o,n,[s.value,s.children,n],s.keywords),g=wt(),w=ce(A=>A.value&&A.value===m.current),x=ce(A=>u||d.filter()===!1?!0:A.search?A.filtered.items.get(o)>0:!0);i.useEffect(()=>{let A=n.current;if(!(!A||s.disabled))return A.addEventListener(pt,v),()=>A.removeEventListener(pt,v)},[x,s.onSelect,s.disabled]);function v(){var A,C;f(),(C=(A=c.current).onSelect)==null||C.call(A,m.current)}function f(){g.setState("value",m.current,!0)}if(!x)return null;let{disabled:j,value:R,onSelect:S,forceMount:k,keywords:T,...h}=s;return i.createElement(L.div,{ref:Te(n,e),...h,id:o,"cmdk-item":"",role:"option","aria-disabled":!!j,"aria-selected":!!w,"data-disabled":!!j,"data-selected":!!w,onPointerMove:j||d.getDisablePointerSelection()?void 0:f,onClick:j?void 0:v},s.children)}),Ho=i.forwardRef((s,e)=>{let{heading:r,children:a,forceMount:o,...n}=s,l=le(),d=i.useRef(null),c=i.useRef(null),u=le(),m=Ie(),g=ce(x=>o||m.filter()===!1?!0:x.search?x.filtered.groups.has(l):!0);be(()=>m.group(l),[]),os(l,d,[s.value,s.heading,c]);let w=i.useMemo(()=>({id:l,forceMount:o}),[o]);return i.createElement(L.div,{ref:Te(d,e),...n,"cmdk-group":"",role:"presentation",hidden:g?void 0:!0},r&&i.createElement("div",{ref:c,"cmdk-group-heading":"","aria-hidden":!0,id:u},r),qe(s,x=>i.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":r?u:void 0},i.createElement(rs.Provider,{value:w},x))))}),Wo=i.forwardRef((s,e)=>{let{alwaysRender:r,...a}=s,o=i.useRef(null),n=ce(l=>!l.search);return!r&&!n?null:i.createElement(L.div,{ref:Te(o,e),...a,"cmdk-separator":"",role:"separator"})}),Ko=i.forwardRef((s,e)=>{let{onValueChange:r,...a}=s,o=s.value!=null,n=wt(),l=ce(u=>u.search),d=ce(u=>u.selectedItemId),c=Ie();return i.useEffect(()=>{s.value!=null&&n.setState("search",s.value)},[s.value]),i.createElement(L.input,{ref:e,...a,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":c.listId,"aria-labelledby":c.labelId,"aria-activedescendant":d,id:c.inputId,type:"text",value:o?s.value:l,onChange:u=>{o||n.setState("search",u.target.value),r?.(u.target.value)}})}),Qo=i.forwardRef((s,e)=>{let{children:r,label:a="Suggestions",...o}=s,n=i.useRef(null),l=i.useRef(null),d=ce(u=>u.selectedItemId),c=Ie();return i.useEffect(()=>{if(l.current&&n.current){let u=l.current,m=n.current,g,w=new ResizeObserver(()=>{g=requestAnimationFrame(()=>{let x=u.offsetHeight;m.style.setProperty("--cmdk-list-height",x.toFixed(1)+"px")})});return w.observe(u),()=>{cancelAnimationFrame(g),w.unobserve(u)}}},[]),i.createElement(L.div,{ref:Te(n,e),...o,"cmdk-list":"",role:"listbox",tabIndex:-1,"aria-activedescendant":d,"aria-label":a,id:c.listId},qe(s,u=>i.createElement("div",{ref:Te(l,c.listInnerRef),"cmdk-list-sizer":""},u)))}),Go=i.forwardRef((s,e)=>{let{open:r,onOpenChange:a,overlayClassName:o,contentClassName:n,container:l,...d}=s;return i.createElement(ks,{open:r,onOpenChange:a},i.createElement(_s,{container:l},i.createElement(Rs,{"cmdk-overlay":"",className:o}),i.createElement(Ts,{"aria-label":s.label,"cmdk-dialog":"",className:n},i.createElement(ss,{ref:e,...d}))))}),Yo=i.forwardRef((s,e)=>ce(r=>r.filtered.count===0)?i.createElement(L.div,{ref:e,...s,"cmdk-empty":"",role:"presentation"}):null),Xo=i.forwardRef((s,e)=>{let{progress:r,children:a,label:o="Loading...",...n}=s;return i.createElement(L.div,{ref:e,...n,"cmdk-loading":"",role:"progressbar","aria-valuenow":r,"aria-valuemin":0,"aria-valuemax":100,"aria-label":o},qe(s,l=>i.createElement("div",{"aria-hidden":!0},l)))}),Pe=Object.assign(ss,{List:Qo,Item:qo,Input:Ko,Group:Ho,Separator:Wo,Dialog:Go,Empty:Yo,Loading:Xo});function Zo(s,e){let r=s.nextElementSibling;for(;r;){if(r.matches(e))return r;r=r.nextElementSibling}}function Jo(s,e){let r=s.previousElementSibling;for(;r;){if(r.matches(e))return r;r=r.previousElementSibling}}function as(s){let e=i.useRef(s);return be(()=>{e.current=s}),e}var be=typeof window>"u"?i.useEffect:i.useLayoutEffect;function Ne(s){let e=i.useRef();return e.current===void 0&&(e.current=s()),e}function ce(s){let e=wt(),r=()=>s(e.snapshot());return i.useSyncExternalStore(e.subscribe,r,r)}function os(s,e,r,a=[]){let o=i.useRef(),n=Ie();return be(()=>{var l;let d=(()=>{var u;for(let m of r){if(typeof m=="string")return m.trim();if(typeof m=="object"&&"current"in m)return m.current?(u=m.current.textContent)==null?void 0:u.trim():o.current}})(),c=a.map(u=>u.trim());n.value(s,d,c),(l=e.current)==null||l.setAttribute(je,d),o.current=d}),o}var en=()=>{let[s,e]=i.useState(),r=Ne(()=>new Map);return be(()=>{r.current.forEach(a=>a()),r.current=new Map},[s]),(a,o)=>{r.current.set(a,o),e({})}};function tn(s){let e=s.type;return typeof e=="function"?e(s.props):"render"in e?e.render(s.props):s}function qe({asChild:s,children:e},r){return s&&i.isValidElement(e)?i.cloneElement(tn(e),{ref:e.ref},r(e.props.children)):r(e)}var rn={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};function sn(s){const e=$.c(8);let r,a;e[0]!==s?({className:r,...a}=s,e[0]=s,e[1]=r,e[2]=a):(r=e[1],a=e[2]);let o;e[3]!==r?(o=U("bg-popover text-popover-foreground flex h-full w-full flex-col overflow-hidden rounded-md",r),e[3]=r,e[4]=o):o=e[4];let n;return e[5]!==a||e[6]!==o?(n=t.jsx(Pe,{"data-slot":"command",className:o,...a}),e[5]=a,e[6]=o,e[7]=n):n=e[7],n}function an(s){const e=$.c(9);let r,a;e[0]!==s?({className:r,...a}=s,e[0]=s,e[1]=r,e[2]=a):(r=e[1],a=e[2]);let o;e[3]===Symbol.for("react.memo_cache_sentinel")?(o=t.jsx(Ys,{className:"size-4 shrink-0 opacity-50"}),e[3]=o):o=e[3];let n;e[4]!==r?(n=U("placeholder:text-muted-foreground flex h-10 w-full rounded-md bg-transparent py-3 text-sm outline-hidden disabled:cursor-not-allowed disabled:opacity-50",r),e[4]=r,e[5]=n):n=e[5];let l;return e[6]!==a||e[7]!==n?(l=t.jsxs("div",{"data-slot":"command-input-wrapper",className:"flex h-9 items-center gap-2 border-b px-3",children:[o,t.jsx(Pe.Input,{"data-slot":"command-input",className:n,...a})]}),e[6]=a,e[7]=n,e[8]=l):l=e[8],l}function on(s){const e=$.c(8);let r,a;e[0]!==s?({className:r,...a}=s,e[0]=s,e[1]=r,e[2]=a):(r=e[1],a=e[2]);let o;e[3]!==r?(o=U("max-h-[300px] scroll-py-1 overflow-x-hidden overflow-y-auto",r),e[3]=r,e[4]=o):o=e[4];let n;return e[5]!==a||e[6]!==o?(n=t.jsx(Pe.List,{"data-slot":"command-list",className:o,...a}),e[5]=a,e[6]=o,e[7]=n):n=e[7],n}function nn(s){const e=$.c(4);let r;e[0]!==s?({...r}=s,e[0]=s,e[1]=r):r=e[1];let a;return e[2]!==r?(a=t.jsx(Pe.Empty,{"data-slot":"command-empty",className:"py-6 text-center text-sm",...r}),e[2]=r,e[3]=a):a=e[3],a}function ln(s){const e=$.c(8);let r,a;e[0]!==s?({className:r,...a}=s,e[0]=s,e[1]=r,e[2]=a):(r=e[1],a=e[2]);let o;e[3]!==r?(o=U("text-foreground [&_[cmdk-group-heading]]:text-muted-foreground overflow-hidden p-1 [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium",r),e[3]=r,e[4]=o):o=e[4];let n;return e[5]!==a||e[6]!==o?(n=t.jsx(Pe.Group,{"data-slot":"command-group",className:o,...a}),e[5]=a,e[6]=o,e[7]=n):n=e[7],n}function cn(s){const e=$.c(8);let r,a;e[0]!==s?({className:r,...a}=s,e[0]=s,e[1]=r,e[2]=a):(r=e[1],a=e[2]);let o;e[3]!==r?(o=U("data-[selected=true]:bg-accent data-[selected=true]:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled=true]:pointer-events-none data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",r),e[3]=r,e[4]=o):o=e[4];let n;return e[5]!==a||e[6]!==o?(n=t.jsx(Pe.Item,{"data-slot":"command-item",className:o,...a}),e[5]=a,e[6]=o,e[7]=n):n=e[7],n}const ns=[{name:"Golden Retriever",defaultColors:["Golden"]},{name:"Labrador Retriever",defaultColors:["Yellow","Black","Chocolate"]},{name:"German Shepherd",defaultColors:["Black/Tan","Sable","Black"]},{name:"French Bulldog",defaultColors:["Fawn","Brindle","Cream","Pied"]},{name:"Poodle",defaultColors:["White","Black","Apricot","Red"]},{name:"Bulldog",defaultColors:["Fawn","Brindle","White","Piebald"]},{name:"Beagle",defaultColors:["Tri-color","Lemon/White","Red/White"]},{name:"Rottweiler",defaultColors:["Black/Rust"]},{name:"Dachshund",defaultColors:["Red","Black/Tan","Chocolate/Tan","Dapple"]},{name:"Yorkshire Terrier",defaultColors:["Blue/Tan"]}],ls=[{name:"Bicolor / Tuxedo",defaultColors:["Black/White","Gray/White","Seal/White"]},{name:"Calico",defaultColors:["Black/Orange/White","Dilute (Blue/Cream/White)"]},{name:"Pointed",defaultColors:["Seal point","Blue point","Chocolate point","Lilac point","Flame point"]},{name:"Shaded",defaultColors:["Shaded Silver","Shaded Golden"]},{name:"Smoke",defaultColors:["Black Smoke","Blue Smoke"]},{name:"Solid",defaultColors:["Black","White","Blue/Gray","Red/Orange","Cream"]},{name:"Spotted",defaultColors:["Brown Spotted","Silver Spotted"]},{name:"Tabby",defaultColors:["Brown Tabby","Gray/Blue Tabby","Orange Tabby","Silver Tabby","Torbie"]},{name:"Tortoiseshell (Tortie)",defaultColors:["Black/Orange","Chocolate/Cream","Dilute (Blue/Cream)"]}];function dn(s,e){return!s||!e?[]:s==="dog"?ns.find(a=>a.name===e)?.defaultColors??[]:s==="cat"?ls.find(a=>a.name===e)?.defaultColors??[]:[]}const un=ns.map(s=>s.name),mn=ls.map(s=>s.name);function pn({label:s="Photo",value:e,onChange:r,options:a,accept:o="image/*",className:n}){const l=i.useRef(null),[d,c]=i.useState(!1),[u,m]=i.useState(!1),[g,w]=i.useState(null),x=i.useCallback(()=>{l.current?.click()},[]),v=i.useCallback(()=>{r(null),w(null)},[r]),f=i.useCallback(async T=>{if(!T||!T.type.startsWith("image/")){w("Please select a valid image file");return}if(T.size>10*1024*1024){w("File size must be less than 10MB");return}w(null),c(!0);try{const h=await fn(T,a);r(h)}catch(h){w("Failed to optimize image. Please try another file."),console.error("Image optimization error:",h)}finally{c(!1)}},[a,r]),j=i.useCallback(T=>{T.preventDefault(),T.stopPropagation(),m(!0)},[]),R=i.useCallback(T=>{T.preventDefault(),T.stopPropagation(),m(!1)},[]),S=i.useCallback(T=>{T.preventDefault(),T.stopPropagation(),m(!1);const h=T.dataTransfer.files?.[0];h&&f(h)},[f]),k=e?Math.round((1-e.approxKB/e.original.sizeKB)*100):0;return t.jsxs("div",{className:n,children:[t.jsx(X,{className:"mb-2 block font-medium",children:s}),e?t.jsx("div",{className:"border rounded-lg p-4 bg-card",children:t.jsxs("div",{className:"flex items-start gap-4",children:[t.jsxs("div",{className:"relative group",children:[t.jsx("img",{src:e.dataUrl,alt:"preview",className:"h-32 w-32 rounded-lg object-cover border-2 border-border"}),t.jsx("div",{className:"absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity rounded-lg flex items-center justify-center",children:t.jsx(vs,{className:"h-8 w-8 text-white"})})]}),t.jsxs("div",{className:"flex-1 space-y-3",children:[t.jsxs("div",{className:"flex items-start justify-between gap-2",children:[t.jsxs("div",{children:[t.jsx("p",{className:"font-medium text-sm truncate",children:e.original.name}),t.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[e.width," × ",e.height,"px"]})]}),t.jsx(G,{type:"button",variant:"ghost",size:"sm",onClick:v,className:"h-8 w-8 p-0",children:t.jsx(Is,{className:"h-4 w-4"})})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-3 text-xs",children:[t.jsxs("div",{className:"space-y-1",children:[t.jsx("p",{className:"text-muted-foreground",children:"Original"}),t.jsxs("p",{className:"font-medium",children:[e.original.sizeKB.toLocaleString()," KB"]})]}),t.jsxs("div",{className:"space-y-1",children:[t.jsx("p",{className:"text-muted-foreground",children:"Optimized"}),t.jsxs("p",{className:"font-medium text-green-600 dark:text-green-400",children:[e.approxKB.toLocaleString()," KB"]})]})]}),k>0&&t.jsx("div",{className:"bg-green-50 dark:bg-green-950/30 border border-green-200 dark:border-green-900 rounded-md px-3 py-2",children:t.jsxs("p",{className:"text-xs text-green-700 dark:text-green-300 font-medium",children:["↓ ",k,"% smaller · ",e.mimeType]})}),t.jsx(G,{type:"button",variant:"outline",size:"sm",onClick:x,className:"w-full",children:"Replace Image"})]})]})}):t.jsx("div",{onDragOver:j,onDragLeave:R,onDrop:S,onClick:x,className:`
            relative border-2 border-dashed rounded-lg p-8 transition-all cursor-pointer
            hover:border-primary/50 hover:bg-accent/50
            ${u?"border-primary bg-accent scale-[1.02]":"border-border"}
            ${d?"pointer-events-none opacity-60":""}
          `,children:t.jsx("div",{className:"flex flex-col items-center justify-center text-center space-y-3",children:d?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-primary"}),t.jsx("p",{className:"text-sm font-medium",children:"Optimizing image..."})]}):t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"rounded-full bg-primary/10 p-3",children:t.jsx(ra,{className:"h-6 w-6 text-primary"})}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium mb-1",children:"Drop your image here, or click to browse"}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"PNG, JPG, WebP up to 10MB"})]})]})})}),g&&t.jsx("div",{className:"mt-2 text-sm text-red-600 dark:text-red-400 bg-red-50 dark:bg-red-950/30 border border-red-200 dark:border-red-900 rounded-md px-3 py-2",children:g}),t.jsx(ne,{ref:l,type:"file",accept:o,className:"hidden",onChange:T=>{const h=T.target.files?.[0];h&&f(h),T.currentTarget.value=""}})]})}async function fn(s,e){const r=await s.arrayBuffer(),a=new Blob([r]),o=await gn(a),n=e?.maxWidth??1200,l=e?.maxHeight??1200,{width:d,height:c}=hn(o.width,o.height,n,l),u=document.createElement("canvas");u.width=d,u.height=c;const m=u.getContext("2d",{alpha:!0});m.imageSmoothingEnabled=!0,m.imageSmoothingQuality="high",m.drawImage(o,0,0,d,c);const g=e?.preferWebP??!0,w=e?.quality??.82,x=u.toDataURL("image/webp").startsWith("data:image/webp"),v=g&&x?"image/webp":"image/jpeg",f=await xn(u,v,w),j=await vn(f);return{blob:f,dataUrl:j,width:d,height:c,approxKB:Math.round(f.size/1024),mimeType:v,original:{name:s.name,sizeKB:Math.round(s.size/1024),type:s.type}}}function hn(s,e,r,a){const o=Math.min(r/s,a/e,1);return{width:Math.round(s*o),height:Math.round(e*o)}}function gn(s){return new Promise((e,r)=>{const a=URL.createObjectURL(s),o=new Image;o.onload=()=>{URL.revokeObjectURL(a),e(o)},o.onerror=()=>{URL.revokeObjectURL(a),r(new Error("Failed to load image"))},o.src=a})}function xn(s,e,r){return new Promise((a,o)=>{s.toBlob(n=>{n?a(n):o(new Error("Canvas to blob conversion failed"))},e,r)})}function vn(s){return new Promise((e,r)=>{const a=new FileReader;a.onload=()=>e(String(a.result)),a.onerror=()=>r(new Error("Failed to read blob")),a.readAsDataURL(s)})}function bn(s){const[e,r]=i.useState(Qe),[a,o]=i.useState(!0);return i.useEffect(()=>{if(!s){o(!1);return}(async()=>{try{const{data:c,error:u}=await Z.from("pet_themes").select("theme_preset, custom_colors, background_image_url").eq("pet_id",s).maybeSingle();if(u)throw u;r(c?c.theme_preset:Qe)}catch(c){console.error("Failed to load pet theme:",c),r(Qe)}finally{o(!1)}})()},[s]),{themeId:e,isLoading:a,updatePetTheme:async d=>{if(s){r(d);try{const{error:c}=await Z.from("pet_themes").upsert({pet_id:s,theme_preset:d,updated_at:new Date().toISOString()});if(c)throw c}catch(c){console.error("Failed to save pet theme:",c)}}},applyPetTheme:(d=!1)=>{cs(e,d)}}}const wn=St({id:oe().optional(),name:oe().min(1,"Name is required"),species:js(["dog","cat","other"],{message:"Choose a species"}),breed:oe().optional(),color:oe().optional(),weight:ys().min(0,"Weight must be positive").optional(),birthdate:oe().optional(),microchipId:oe().optional(),description:oe().optional(),notes:oe().optional(),vaccinations:St({rabies:Ns().default(!1),rabiesExpires:oe().optional()}).default({rabies:!1,rabiesExpires:""}),photoPreview:oe().optional()});async function Et(s){return await(await fetch(s)).blob()}function It({mode:s,open:e,onOpenChange:r,initialPet:a,onSubmit:o}){const{user:n}=ft(),[l,d]=i.useState(!1),c=bs({resolver:ws(wn),defaultValues:{id:a?.id,name:a?.name??"",species:a?.species,breed:a?.breed??"",color:a?.color??"",weight:a?.weight??void 0,birthdate:a?.birthdate??"",microchipId:a?.microchipId??"",description:a?.description??"",notes:a?.notes??"",vaccinations:{rabies:a?.vaccinations?.rabies??!1,rabiesExpires:a?.vaccinations?.rabiesExpires??""},photoPreview:a?.photoPreview??""},mode:"onSubmit"}),u=c.watch("species"),m=c.watch("breed"),[g,w]=i.useState(!1),{themeId:x,updatePetTheme:v}=bn(a?.id),[f,j]=i.useState(x);i.useEffect(()=>{j(x)},[x]);const R=i.useRef(null),S=i.useMemo(()=>u==="dog"?un:u==="cat"?mn:[],[u]),k=i.useMemo(()=>dn(u??"other",m),[u,m]),T=async h=>{if(!n?.id){alert("You must be signed in.");return}d(!0);const A={rabies:!!h.vaccinations?.rabies,rabiesExpires:h.vaccinations?.rabies&&h.vaccinations.rabiesExpires||void 0},C={owner_id:n.id,name:h.name,species:h.species,breed:h.breed||null,color:h.color||null,weight:typeof h.weight=="number"?h.weight:null,birthdate:h.birthdate||null,microchip_id:h.microchipId||null,description:h.description||null,notes:h.notes||null,vaccinations:A};try{let D;if(s==="add"){D=await va({...C});try{const y=await xt(n.id,D.short_id);await Re(D.id,{qr_url:y})}catch(y){console.warn("QR generation failed (non-blocking):",y?.message)}let F=R.current;if(!F&&h.photoPreview&&(F=await Et(h.photoPreview)),F&&F.size>0){const y=await Pt(n.id,D.id,F);D=await Re(D.id,{photo_url:y})}}else{const F=h.id||a?.id;if(!F)throw new Error("Missing pet id for update.");let y=R.current;!y&&h.photoPreview&&(y=await Et(h.photoPreview));const B={name:C.name,species:C.species,breed:C.breed,color:C.color,weight:C.weight,birthdate:C.birthdate,microchip_id:C.microchip_id,description:C.description,notes:C.notes,vaccinations:C.vaccinations};if(y&&y.size>0){const q=await Pt(n.id,F,y);B.photo_url=q}D=await Re(F,B)}D?.id&&await v(f),o?.(h),r(!1),s==="add"&&c.reset()}catch(D){console.error(D),alert(D?.message??"Failed to save pet")}finally{d(!1)}};return t.jsx(Wt,{open:e,onOpenChange:h=>!l&&r(h),children:t.jsxs(Kt,{className:"sm:max-w-2xl max-h-[90vh] overflow-y-auto bg-white dark:bg-slate-900",children:[t.jsx(Qt,{className:"space-y-3",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"h-10 w-10 bg-primary/10 rounded-xl flex items-center justify-center ring-4 ring-primary/5",children:t.jsx(ge,{className:"h-5 w-5 text-primary"})}),t.jsxs("div",{children:[t.jsx(Gt,{className:"text-2xl",children:s==="add"?"Add New Pet":"Edit Pet"}),t.jsx(Yt,{className:"text-base",children:s==="add"?"Enter your pet's details to create their profile":"Update your pet's information"})]})]})}),t.jsxs("form",{onSubmit:c.handleSubmit(T),className:"space-y-6 mt-4",children:[t.jsxs("section",{className:"space-y-4",children:[t.jsxs("div",{className:"flex items-center gap-2 text-sm font-semibold text-foreground",children:[t.jsx(Ut,{className:"h-4 w-4 text-primary"}),"Basic Information"]}),t.jsxs("div",{className:"space-y-4 pl-6 border-l-2 border-primary/20",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsxs(X,{htmlFor:"name",className:"text-sm font-medium flex items-center gap-2",children:["Name ",t.jsx("span",{className:"text-destructive",children:"*"})]}),t.jsx(ne,{id:"name",...c.register("name"),placeholder:"e.g., Milo, Luna, Max",className:"h-11 transition-all duration-200 focus:ring-2 focus:ring-primary/20"}),c.formState.errors.name&&t.jsxs("p",{className:"text-sm text-destructive flex items-center gap-1.5 animate-in fade-in-50",children:[t.jsx(Oe,{className:"h-3.5 w-3.5"}),c.formState.errors.name.message]})]}),t.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsxs(X,{className:"text-sm font-medium flex items-center gap-2",children:["Species ",t.jsx("span",{className:"text-destructive",children:"*"})]}),t.jsxs(co,{value:u,onValueChange:h=>{c.setValue("species",h,{shouldValidate:!0}),c.setValue("breed",""),c.setValue("color","")},children:[t.jsx(mo,{className:"h-11",children:t.jsx(uo,{placeholder:"Select species"})}),t.jsxs(po,{children:[t.jsx(Ye,{value:"dog",children:"🐕 Dog"}),t.jsx(Ye,{value:"cat",children:"🐱 Cat"}),t.jsx(Ye,{value:"other",children:"🐾 Other"})]})]}),c.formState.errors.species&&t.jsxs("p",{className:"text-sm text-destructive flex items-center gap-1.5",children:[t.jsx(Oe,{className:"h-3.5 w-3.5"}),c.formState.errors.species.message]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs(X,{htmlFor:"birthdate",className:"text-sm font-medium flex items-center gap-2",children:[t.jsx(Ls,{className:"h-3.5 w-3.5"}),"Birthdate"]}),t.jsx(ne,{id:"birthdate",type:"date",...c.register("birthdate"),className:"h-11"})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs(X,{className:"text-sm font-medium flex items-center gap-2",children:[t.jsx(ge,{className:"h-3.5 w-3.5"}),u==="cat"?"Pattern":"Breed",u==="other"&&t.jsx("span",{className:"text-muted-foreground text-xs",children:"(optional)"})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(ne,{placeholder:u==="dog"?"e.g., Golden Retriever":u==="cat"?"e.g., Tabby, Calico":"e.g., Rabbit, Guinea Pig",...c.register("breed"),className:"h-11 flex-1"}),S.length>0&&t.jsxs(To,{open:g,onOpenChange:w,children:[t.jsx(Eo,{asChild:!0,children:t.jsxs(G,{type:"button",variant:"outline",className:"w-36 justify-between h-11",children:["Suggestions ",t.jsx(zs,{className:"h-4 w-4 opacity-60"})]})}),t.jsx(Io,{className:"p-0 w-64",children:t.jsxs(sn,{children:[t.jsx(an,{placeholder:"Search…"}),t.jsxs(on,{children:[t.jsx(nn,{children:"No matches found."}),t.jsx(ln,{children:S.map(h=>t.jsx(cn,{value:h,onSelect:A=>{c.setValue("breed",A),w(!1)},children:h},h))})]})]})})]})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs(X,{htmlFor:"color",className:"text-sm font-medium flex items-center gap-2",children:[t.jsx(Nt,{className:"h-3.5 w-3.5"}),"Color"]}),t.jsx(ne,{id:"color",...c.register("color"),placeholder:"e.g., Brown, White, Mixed",className:"h-11"}),k.length>0&&t.jsx("div",{className:"flex flex-wrap gap-2 pt-1",children:k.map(h=>t.jsx("button",{type:"button",onClick:()=>c.setValue("color",h,{shouldValidate:!0}),className:"rounded-full border border-primary/20 bg-primary/5 px-3 py-1 text-xs font-medium hover:bg-primary/10 transition-colors",children:h},h))})]}),t.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsxs(X,{htmlFor:"weight",className:"text-sm font-medium flex items-center gap-2",children:[t.jsx(aa,{className:"h-3.5 w-3.5"}),"Weight (lbs)"]}),t.jsx(ne,{id:"weight",type:"number",step:"0.1",placeholder:"e.g., 45.5",...c.register("weight",{valueAsNumber:!0}),className:"h-11"}),c.formState.errors.weight&&t.jsxs("p",{className:"text-sm text-destructive flex items-center gap-1.5",children:[t.jsx(Oe,{className:"h-3.5 w-3.5"}),c.formState.errors.weight.message]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs(X,{htmlFor:"microchipId",className:"text-sm font-medium flex items-center gap-2",children:[t.jsx(As,{className:"h-3.5 w-3.5"}),"Microchip ID"]}),t.jsx(ne,{id:"microchipId",...c.register("microchipId"),placeholder:"e.g., 981000012345678",className:"h-11"})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(X,{htmlFor:"description",className:"text-sm font-medium",children:"Physical Description"}),t.jsx(ne,{id:"description",...c.register("description"),placeholder:"e.g., White paws, brown spot on left ear",className:"h-11"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(X,{htmlFor:"notes",className:"text-sm font-medium",children:"Additional Notes"}),t.jsx(fs,{id:"notes",...c.register("notes"),placeholder:"Allergies, medications, behavioral notes, vet contact info...",className:"min-h-[80px] resize-none"})]})]})]}),t.jsx(Ge,{}),t.jsxs("section",{className:"space-y-4",children:[t.jsxs("div",{className:"flex items-center gap-2 text-sm font-semibold text-foreground",children:[t.jsx(ea,{className:"h-4 w-4 text-primary"}),"Vaccinations"]}),t.jsxs("div",{className:"space-y-3 pl-6 border-l-2 border-primary/20",children:[t.jsx(qt,{className:"border-blue-200 bg-blue-50 dark:border-blue-900 dark:bg-blue-950",children:t.jsx(Ht,{className:"text-xs text-blue-800 dark:text-blue-200",children:"Keep track of your pet's vaccination records for their health and safety"})}),t.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-3 bg-secondary/30 rounded-lg p-4",children:[t.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[t.jsx("input",{id:"rabies",type:"checkbox",className:"h-4 w-4 rounded border-primary text-primary focus:ring-primary",checked:!!c.watch("vaccinations.rabies"),onChange:h=>c.setValue("vaccinations.rabies",h.target.checked)}),t.jsx(X,{htmlFor:"rabies",className:"text-sm font-medium cursor-pointer",children:"Rabies Vaccination"})]}),t.jsxs("div",{className:"flex items-center gap-2 sm:w-48",children:[t.jsx(X,{htmlFor:"rabiesExpires",className:"text-xs text-muted-foreground whitespace-nowrap",children:"Expires:"}),t.jsx(ne,{id:"rabiesExpires",type:"date",disabled:!c.watch("vaccinations.rabies"),...c.register("vaccinations.rabiesExpires"),className:"h-9"})]})]})]})]}),t.jsx(Ge,{}),t.jsxs("section",{className:"space-y-4",children:[t.jsxs("div",{className:"flex items-center gap-2 text-sm font-semibold text-foreground",children:[t.jsx(Nt,{className:"h-4 w-4 text-primary"}),"Page Theme"]}),t.jsxs("div",{className:"pl-6 border-l-2 border-primary/20",children:[t.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Choose a color theme for your pet's public page"}),t.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-3",children:Object.values(ds).map(h=>t.jsxs("button",{type:"button",onClick:()=>j(h.id),className:U("relative p-3 rounded-lg border-2 transition-all hover:scale-105",f===h.id?"border-primary shadow-md":"border-border hover:border-primary/50"),children:[t.jsx("div",{className:U("h-16 rounded-md mb-2 bg-gradient-to-br",h.previewGradient)}),t.jsx("p",{className:"text-xs font-medium text-center",children:h.name}),f===h.id&&t.jsx("div",{className:"absolute top-2 right-2 h-5 w-5 bg-primary rounded-full flex items-center justify-center",children:t.jsx(pr,{className:"h-3 w-3 text-primary-foreground"})})]},h.id))})]})]}),t.jsx(Ge,{}),t.jsxs("section",{className:"space-y-4",children:[t.jsxs("div",{className:"flex items-center gap-2 text-sm font-semibold text-foreground",children:[t.jsx($s,{className:"h-4 w-4 text-primary"}),"Pet Photo"]}),t.jsx("div",{className:"pl-6 border-l-2 border-primary/20",children:t.jsx(pn,{label:"",value:c.watch("photoPreview")?{blob:new Blob,dataUrl:c.watch("photoPreview"),width:0,height:0,approxKB:0,mimeType:"image/*",original:{name:"",sizeKB:0,type:""}}:null,onChange:h=>{R.current=h?.blob??null,c.setValue("photoPreview",h?.dataUrl??"")},options:{maxWidth:1200,maxHeight:1200,quality:.82,preferWebP:!0}})})]}),t.jsxs(Xt,{className:"gap-2 sm:gap-0 pt-4",children:[t.jsx(G,{type:"button",variant:"outline",onClick:()=>r(!1),disabled:l,className:"transition-all hover:scale-105",children:"Cancel"}),t.jsx(G,{type:"submit",disabled:l,className:"transition-all hover:scale-105",children:l?t.jsxs("span",{className:"flex items-center gap-2",children:[t.jsxs("svg",{className:"animate-spin h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),s==="add"?"Creating...":"Updating..."]}):t.jsxs("span",{className:"flex items-center gap-2",children:[t.jsx(ge,{className:"h-4 w-4"}),s==="add"?"Create Pet Profile":"Save Changes"]})})]})]})]})})}function Zn(){const{user:s}=ft(),e=ht(),r=s?.id??null,{backfillAllQR:a,isBackfilling:o}=Ca(r),{data:n,isLoading:l,isError:d}=At({queryKey:["pets",r],queryFn:async()=>r?ba(r):[],enabled:!!r,staleTime:3e4}),[c,u]=i.useState(!1),[m,g]=i.useState(null),[w,x]=i.useState(null),[v,f]=i.useState(null),[j,R]=i.useState(null),[S,k]=i.useState(!1),T=y=>{const q=`${window.location.origin}/p/${y.short_id}`;window.open(q,"_blank")},h=async()=>{await e.invalidateQueries({queryKey:["pets",r]}),g(null),u(!1)},A=async()=>{await e.invalidateQueries({queryKey:["pets",r]}),x(null)},C=us({mutationFn:async({id:y,missing:B})=>Re(y,{missing:B,missing_since:B?new Date().toISOString():null}),onSuccess:async()=>{await e.invalidateQueries({queryKey:["pets",r]})}}),D=async(y,B)=>{if(B)R(y);else try{k(!0),await C.mutateAsync({id:y.id,missing:!1})}catch(q){alert(q?.message??"Failed to update")}finally{k(!1)}},F=async()=>{if(j)try{k(!0),await C.mutateAsync({id:j.id,missing:!0})}catch(y){alert(y?.message??"Failed to update")}finally{k(!1),R(null)}};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex flex-col gap-2",children:[t.jsxs("h1",{className:"text-3xl font-bold tracking-tight flex items-center gap-3",children:[t.jsx("div",{className:"h-10 w-10 bg-primary/10 rounded-xl flex items-center justify-center ring-4 ring-primary/5",children:t.jsx(ge,{className:"h-5 w-5 text-primary"})}),"Dashboard"]}),t.jsx("p",{className:"text-muted-foreground",children:"Manage your pets, QR codes, and track activity"})]}),t.jsxs(ms,{defaultValue:"pets",className:"space-y-4",children:[t.jsxs(ps,{className:"grid w-full max-w-md grid-cols-2",children:[t.jsxs(yt,{value:"pets",className:"gap-2",children:[t.jsx(ge,{className:"h-4 w-4"}),"My Pets"]}),t.jsxs(yt,{value:"activity",className:"gap-2",children:[t.jsx(Os,{className:"h-4 w-4"}),"Recent Activity"]})]}),t.jsxs(jt,{value:"pets",className:"space-y-4",children:[t.jsxs(De,{className:"shadow-lg border-primary/10",children:[t.jsx(rt,{className:"space-y-4",children:t.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-4",children:[t.jsxs("div",{className:"space-y-1.5",children:[t.jsxs(tt,{className:"text-2xl flex items-center gap-2",children:[t.jsx(Ut,{className:"h-5 w-5 text-primary"}),"Registered Pets"]}),t.jsx(st,{className:"text-base",children:"Manage profiles, photos, QR tags, and missing status"})]}),t.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[t.jsxs(G,{variant:"outline",onClick:a,disabled:!r||o,className:"gap-2 transition-all hover:scale-105",children:[t.jsx(Be,{className:`h-4 w-4 ${o?"animate-spin":""}`}),o?"Working…":"Backfill QR"]}),t.jsxs(G,{onClick:()=>u(!0),disabled:!r,className:"gap-2 transition-all hover:scale-105",children:[t.jsx(Ct,{className:"h-4 w-4"}),"Add Pet"]})]})]})}),t.jsx(et,{children:l?t.jsx("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:Array.from({length:6}).map((y,B)=>t.jsxs(De,{className:"p-4 space-y-3",children:[t.jsx(ye,{className:"h-5 w-40"}),t.jsx(ye,{className:"h-4 w-24"}),t.jsx(ye,{className:"h-32 w-full rounded-md"}),t.jsxs("div",{className:"flex gap-2 pt-2",children:[t.jsx(ye,{className:"h-9 w-16"}),t.jsx(ye,{className:"h-9 w-16"}),t.jsx(ye,{className:"h-9 w-16"})]})]},B))}):d?t.jsxs(qt,{variant:"destructive",children:[t.jsx(Oe,{className:"h-4 w-4"}),t.jsx(Ht,{children:"Failed to load pets. Please try again."})]}):n&&n.length>0?t.jsx("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:n.map(y=>t.jsxs(De,{className:"overflow-hidden transition-all duration-200 hover:shadow-lg hover:scale-[1.02] border-primary/10",children:[t.jsxs(rt,{className:"pb-3",children:[t.jsxs("div",{className:"flex items-start justify-between gap-2",children:[t.jsxs(tt,{className:"text-lg truncate flex items-center gap-2",children:[t.jsx(ge,{className:"h-4 w-4 text-primary flex-shrink-0"}),y.name]}),t.jsxs("div",{className:"flex flex-col gap-1.5 items-end",children:[y.missing&&t.jsxs(at,{variant:"destructive",className:"gap-1 animate-pulse",children:[t.jsx(ot,{className:"h-3 w-3"}),"Missing"]}),t.jsx(at,{variant:"secondary",className:"capitalize text-xs",children:y.species})]})]}),t.jsx(st,{className:"line-clamp-2 text-sm",children:y.breed||y.description||"No description"})]}),y.photo_url&&t.jsx("div",{className:"px-4 pb-3",children:t.jsx("img",{src:y.photo_url,alt:`${y.name} photo`,className:"w-full h-40 rounded-lg object-cover ring-1 ring-primary/10",loading:"lazy"})}),t.jsxs(et,{className:"space-y-3 pt-3 border-t",children:[t.jsxs("div",{className:"flex flex-wrap gap-2",children:[t.jsxs(G,{size:"sm",onClick:()=>g(y),className:"gap-1.5 flex-1 transition-all hover:scale-105",children:[t.jsx(Zs,{className:"h-3.5 w-3.5"}),"Edit"]}),t.jsxs(G,{size:"sm",variant:"outline",onClick:()=>T(y),className:"gap-1.5 flex-1 transition-all hover:scale-105",children:[t.jsx(Ms,{className:"h-3.5 w-3.5"}),"View"]}),t.jsxs(G,{size:"sm",variant:y.qr_url?"outline":"secondary",onClick:()=>f(y),className:"gap-1.5 flex-1 transition-all hover:scale-105",title:y.qr_url?"View QR":"Generate QR",children:[t.jsx(Zt,{className:"h-3.5 w-3.5"}),y.qr_url?"QR":"Create"]})]}),t.jsxs("div",{className:"flex items-center justify-between pt-2 border-t",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(X,{htmlFor:`missing-${y.id}`,className:"text-sm font-medium cursor-pointer",children:"Mark Missing"}),t.jsx(gs,{id:`missing-${y.id}`,checked:!!y.missing,disabled:S||C.isPending,onCheckedChange:B=>D(y,B)})]}),t.jsxs(G,{size:"sm",variant:"ghost",onClick:()=>x(y),className:"gap-1.5 text-destructive hover:text-destructive hover:bg-destructive/10",children:[t.jsx(zt,{className:"h-3.5 w-3.5"}),"Delete"]})]})]})]},y.id))}):t.jsxs("div",{className:"text-center py-12 space-y-4",children:[t.jsx("div",{className:"flex justify-center",children:t.jsx("div",{className:"h-20 w-20 bg-primary/10 rounded-full flex items-center justify-center",children:t.jsx(ge,{className:"h-10 w-10 text-primary/60"})})}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("p",{className:"text-lg font-medium text-foreground",children:"No pets yet"}),t.jsxs("p",{className:"text-sm text-muted-foreground",children:["Click ",t.jsx("span",{className:"font-medium text-foreground",children:"Add Pet"})," to create your first pet profile"]})]}),t.jsxs(G,{onClick:()=>u(!0),className:"gap-2 mt-4",children:[t.jsx(Ct,{className:"h-4 w-4"}),"Add Your First Pet"]})]})})]}),t.jsx(It,{mode:"add",open:c,onOpenChange:u,onSubmit:h}),m&&t.jsx(It,{mode:"edit",open:!!m,onOpenChange:y=>!y&&g(null),initialPet:{id:m.id,name:m.name,species:m.species,breed:m.breed??void 0,color:m.color??void 0,weight:m.weight??void 0,birthdate:m.birthdate??void 0,microchipId:m.microchip_id??void 0,description:m.description??void 0,notes:m.notes??void 0,vaccinations:m.vaccinations?{rabies:m.vaccinations.rabies??!1,rabiesExpires:m.vaccinations.rabiesExpires??void 0}:void 0,photoPreview:m.photo_url??void 0},onSubmit:h}),r&&t.jsx(Na,{pet:v,open:!!v,onOpenChange:y=>!y&&f(null),ownerId:r}),t.jsx(Sa,{pet:w,open:!!w,onOpenChange:y=>!y&&x(null),onDeleted:A}),t.jsx(Mt,{open:!!j,onOpenChange:y=>!y&&R(null),children:t.jsxs(Dt,{children:[t.jsxs(Ot,{children:[t.jsxs(Bt,{className:"flex items-center gap-2",children:[t.jsx(ot,{className:"h-5 w-5 text-orange-500"}),"Mark ",j?.name," as missing?"]}),t.jsx(Lt,{children:"This helps highlight their profile and can trigger your outreach flow. You can turn this off later."})]}),t.jsxs(Ft,{children:[t.jsx($t,{disabled:S,children:"Cancel"}),t.jsx(Vt,{disabled:S,onClick:F,className:"gap-2",children:S?t.jsxs(t.Fragment,{children:[t.jsx(Be,{className:"h-4 w-4 animate-spin"}),"Saving…"]}):"Yes, mark missing"})]})]})})]}),t.jsx(jt,{value:"activity",className:"mt-4",children:t.jsx(ia,{days:30})})]})]})}export{Zn as default};
