const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./index-DU0PUxJ_.js","./index-B9FlwhzK.css"])))=>i.map(i=>d[i]);
import{u as F,a as R,j as s,_ as U}from"./index-DU0PUxJ_.js";import{u as j,a as g,o as _,s as c,l as I}from"./zod-CUPyinTs.js";import{u as V}from"./useProfile-D2TAP4mf.js";import{C as k,a as B,b as M,c as O,d as T,e as H}from"./card-CkPsRPVM.js";import{B as t}from"./button-zycxiWQ6.js";import{L as i,I as n}from"./label-7zp_V1fL.js";import{S as v}from"./separator-Cda8THf-.js";import{A as w,a as f}from"./alert-Br4aN_sX.js";import"./useQuery-BWCBevts.js";import"./index-DZPIF1VM.js";const J=_({display_name:c().min(1,"Please enter your name").max(80),avatar_url:c().url("Must be a valid URL").or(I("")).optional()}),q=_({new_password:c().min(8,"At least 8 characters")});function as(){const{user:l,signOut:y}=F(),{data:a,isLoading:S,update:e}=V(),{register:m,handleSubmit:b,reset:d,formState:{errors:r,isSubmitting:p}}=j({resolver:g(J),defaultValues:{display_name:"",avatar_url:""}});R.useEffect(()=>{a&&d({display_name:a.display_name??"",avatar_url:a.avatar_url??""})},[a,d]);const{register:N,handleSubmit:P,reset:C,formState:{errors:u,isSubmitting:x}}=j({resolver:g(q),defaultValues:{new_password:""}}),A=async o=>{await e.mutateAsync(o)},E=async o=>{const{error:h}=await(await U(async()=>{const{supabase:D}=await import("./index-DU0PUxJ_.js").then(L=>L.D);return{supabase:D}},__vite__mapDeps([0,1]),import.meta.url)).supabase.auth.updateUser({password:o.new_password});if(h)throw h;C({new_password:""})};return l?s.jsx("div",{className:"mx-auto max-w-2xl space-y-6",children:s.jsxs(k,{children:[s.jsxs(B,{children:[s.jsx(M,{children:"Account"}),s.jsx(O,{children:"Manage your profile and sign-in details."})]}),s.jsxs(T,{className:"space-y-6",children:[s.jsxs("div",{className:"grid gap-2",children:[s.jsx(i,{children:"Email"}),s.jsx(n,{value:l.email??"",disabled:!0})]}),s.jsx(v,{}),s.jsxs("form",{onSubmit:b(A),className:"grid gap-4",children:[s.jsxs("div",{className:"grid gap-2",children:[s.jsx(i,{htmlFor:"display_name",children:"Display name"}),s.jsx(n,{id:"display_name",placeholder:"Jane Doe",...m("display_name")}),r.display_name&&s.jsx("p",{className:"text-sm text-destructive",children:r.display_name.message})]}),s.jsxs("div",{className:"grid gap-2",children:[s.jsx(i,{htmlFor:"avatar_url",children:"Avatar URL (optional)"}),s.jsx(n,{id:"avatar_url",placeholder:"https://…",...m("avatar_url")}),r.avatar_url&&s.jsx("p",{className:"text-sm text-destructive",children:r.avatar_url.message})]}),e.isError&&s.jsx(w,{variant:"destructive",children:s.jsx(f,{children:String(e.error?.message??"Save failed")})}),e.isSuccess&&s.jsx(w,{children:s.jsx(f,{children:"Profile updated."})}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(t,{type:"submit",disabled:p||S,children:p?"Saving…":"Save changes"}),s.jsx(t,{type:"button",variant:"outline",onClick:()=>d(),children:"Reset"})]})]}),s.jsx(v,{}),s.jsxs("form",{onSubmit:P(E),className:"grid gap-3",children:[s.jsxs("div",{className:"grid gap-2",children:[s.jsx(i,{htmlFor:"new_password",children:"New password"}),s.jsx(n,{id:"new_password",type:"password",placeholder:"••••••••",...N("new_password")}),u.new_password&&s.jsx("p",{className:"text-sm text-destructive",children:u.new_password.message})]}),s.jsx("div",{className:"flex items-center gap-2",children:s.jsx(t,{type:"submit",disabled:x,children:x?"Updating…":"Update password"})})]})]}),s.jsxs(H,{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"text-sm text-muted-foreground",children:["Signed in as ",s.jsx("span",{className:"text-foreground",children:l.email})]}),s.jsx(t,{variant:"ghost",onClick:()=>y(),children:"Sign out"})]})]})}):null}export{as as default};
