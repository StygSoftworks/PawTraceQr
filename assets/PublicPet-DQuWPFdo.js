import{r as z,s as B,c as R,j as e,f as te,L as re,D as Y,b as O}from"./index-CveSHR4s.js";import{u as Z}from"./useQuery-CttsVz0J.js";import{C as F,c as W,b as Q,d as ae,a as K}from"./card-DUbWSefE.js";import{B as T}from"./badge-ZSezyRVn.js";import{B as E}from"./button-C1-kpeoZ.js";import{S}from"./skeleton-Be3C3sjI.js";import{f as le,b as ie,c as ne,a as oe,D as ce}from"./dialog-CbFadpac.js";import{A as H,a as q}from"./alert-C4gaMrOg.js";import{E as me}from"./eye-BlR0LmoE.js";import{F as de,T as he,M as pe,P as D,G as V,I as xe}from"./twitter-DPBqxANA.js";import{c as ee}from"./createLucideIcon-cgnMhNqX.js";import{a as ue,H as fe}from"./Header-CTRQxr4C.js";import{T as U}from"./index-yxler18g.js";import{P as A}from"./paw-print-D4nB2_VR.js";import{H as ge,M as je}from"./map-pin-CzCTMbxx.js";import{I as be}from"./info-Nq6a-_WF.js";import{M as X}from"./mail-SdfHw0IZ.js";import"./index-D0PfoIns.js";import"./index-DeFTGeu5.js";import"./index-KwCZusiW.js";import"./separator-DQKKBwsK.js";import"./x-CYBNq7a3.js";import"./useProfile-hp4Qfwfr.js";import"./useMutation-B67EKEEt.js";import"./Logo-mY4GmNZa.js";import"./log-in-CaEvTY_I.js";import"./user-plus-klA90fht.js";import"./chevron-down-nkFtFTkh.js";import"./credit-card-Ccy1YsC4.js";import"./index-B5EiWyJA.js";/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ne=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],we=ee("clock",Ne);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ve=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],ye=ee("external-link",ve);function _e({shortId:s,askGeo:t=!0}){return z.useEffect(()=>{if(!s)return;let n=!1;return(async()=>{try{let i={};if(t&&"geolocation"in navigator)try{const a=await new Promise((o,l)=>navigator.geolocation.getCurrentPosition(o,l,{timeout:3e3}));i={lat:a.coords.latitude,lng:a.coords.longitude}}catch{}if(n)return;await B.rpc("log_scan",{p_short_id:s,p_referrer:document.referrer||null,p_ua:navigator.userAgent,p_city:null,p_region:null,p_country:null,p_lat:i.lat??null,p_lng:i.lng??null})}catch(i){console.warn("log_scan failed:",i)}})(),()=>{n=!0}},[s,t]),null}function ke(s){const t=R.c(17),{petId:n,days:g,label:i}=s,a=g===void 0?30:g,o=i===void 0?"Scans":i;let l,r;t[0]!==a||t[1]!==n?(l=["pet_scan_count",n,a],r=()=>le(n,a),t[0]=a,t[1]=n,t[2]=l,t[3]=r):(l=t[2],r=t[3]);const h=!!n;let d;t[4]!==l||t[5]!==r||t[6]!==h?(d={queryKey:l,queryFn:r,staleTime:3e4,enabled:h},t[4]=l,t[5]=r,t[6]=h,t[7]=d):d=t[7];const{data:p,isLoading:x,isError:f}=Z(d);if(!n)return null;let c;t[8]===Symbol.for("react.memo_cache_sentinel")?(c=e.jsx("div",{className:"h-10 w-10 bg-primary/10 rounded-lg flex items-center justify-center",children:e.jsx(me,{className:"h-5 w-5 text-primary"})}),t[8]=c):c=t[8];let m;t[9]!==a||t[10]!==o?(m=e.jsxs("p",{className:"text-sm font-medium",children:[o," (Last ",a," days)"]}),t[9]=a,t[10]=o,t[11]=m):m=t[11];const j=x?"Loading...":f?"—":`${p} view${p===1?"":"s"}`;let u;t[12]!==j?(u=e.jsx("p",{className:"text-sm text-muted-foreground",children:j}),t[12]=j,t[13]=u):u=t[13];let b;return t[14]!==u||t[15]!==m?(b=e.jsxs("div",{className:"flex items-center gap-3",children:[c,e.jsxs("div",{children:[m,u]})]}),t[14]=u,t[15]=m,t[16]=b):b=t[16],b}const I=s=>s.trim().replace(/^@/,""),C=s=>s.startsWith("http://")||s.startsWith("https://")?s:`https://${s}`;function $e(s){const t=R.c(20),{instagram:n,facebook:g,twitter:i,telegram:a,whatsapp:o,website:l}=s;let r;t[0]===Symbol.for("react.memo_cache_sentinel")?(r=e.jsx(xe,{className:"h-4 w-4"}),t[0]=r):r=t[0];let h,d,p,x,f;if(t[1]!==g||t[2]!==n||t[3]!==a||t[4]!==i||t[5]!==l||t[6]!==o){f=Symbol.for("react.early_return_sentinel");e:{const u=[{platform:"Instagram",value:n,icon:r,color:"hover:bg-pink-50 hover:border-pink-200 dark:hover:bg-pink-950 dark:hover:border-pink-900",getUrl:Ie},{platform:"Facebook",value:g,icon:e.jsx(de,{className:"h-4 w-4"}),color:"hover:bg-blue-50 hover:border-blue-200 dark:hover:bg-blue-950 dark:hover:border-blue-900",getUrl:De},{platform:"Twitter/X",value:i,icon:e.jsx(he,{className:"h-4 w-4"}),color:"hover:bg-sky-50 hover:border-sky-200 dark:hover:bg-sky-950 dark:hover:border-sky-900",getUrl:Ee},{platform:"Telegram",value:a,icon:e.jsx(pe,{className:"h-4 w-4"}),color:"hover:bg-cyan-50 hover:border-cyan-200 dark:hover:bg-cyan-950 dark:hover:border-cyan-900",getUrl:Te},{platform:"WhatsApp",value:o,icon:e.jsx(D,{className:"h-4 w-4"}),color:"hover:bg-green-50 hover:border-green-200 dark:hover:bg-green-950 dark:hover:border-green-900",getUrl:Pe},{platform:"Website",value:l,icon:e.jsx(V,{className:"h-4 w-4"}),color:"hover:bg-slate-50 hover:border-slate-200 dark:hover:bg-slate-950 dark:hover:border-slate-800",getUrl:Me}].filter(Ce);if(u.length===0){f=null;break e}p="space-y-3",t[12]===Symbol.for("react.memo_cache_sentinel")?(x=e.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium text-muted-foreground",children:[e.jsx(V,{className:"h-4 w-4"}),"Connect via Social Media"]}),t[12]=x):x=t[12],h="grid grid-cols-2 sm:grid-cols-3 gap-2",d=u.map(Se)}t[1]=g,t[2]=n,t[3]=a,t[4]=i,t[5]=l,t[6]=o,t[7]=h,t[8]=d,t[9]=p,t[10]=x,t[11]=f}else h=t[7],d=t[8],p=t[9],x=t[10],f=t[11];if(f!==Symbol.for("react.early_return_sentinel"))return f;let c;t[13]!==h||t[14]!==d?(c=e.jsx("div",{className:h,children:d}),t[13]=h,t[14]=d,t[15]=c):c=t[15];let m;return t[16]!==p||t[17]!==x||t[18]!==c?(m=e.jsxs("div",{className:p,children:[x,c]}),t[16]=p,t[17]=x,t[18]=c,t[19]=m):m=t[19],m}function Se(s){return e.jsx(E,{variant:"outline",size:"sm",asChild:!0,className:`gap-2 transition-colors ${s.color}`,children:e.jsxs("a",{href:s.getUrl(s.value),target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-between w-full",children:[e.jsxs("span",{className:"flex items-center gap-2",children:[s.icon,s.platform]}),e.jsx(ye,{className:"h-3 w-3 opacity-50"})]})},s.platform)}function Ce(s){return s.value}function Me(s){return C(s)}function Pe(s){return`https://wa.me/${s.replace(/\D/g,"")}`}function Te(s){const t=I(s);return s.includes("t.me")?C(s):`https://t.me/${t}`}function Ee(s){const t=I(s);return s.includes("twitter.com")||s.includes("x.com")?C(s):`https://x.com/${t}`}function De(s){return s.includes("facebook.com")||s.includes("fb.com")?C(s):`https://facebook.com/${I(s)}`}function Ie(s){const t=I(s);return s.includes("instagram.com")?C(s):`https://instagram.com/${t}`}function J(s){if(!s)return"";const t=new Date(s).getTime(),n=Date.now();if(isNaN(t)||n<=t)return"just now";const g=n-t,i=Math.floor(g/(1e3*60)),a=Math.floor(i/60),o=Math.floor(a/24);if(o>0){const l=a%24;return`${o} day${o>1?"s":""}${l?`, ${l} hour${l>1?"s":""}`:""}`}if(a>0){const l=i%60;return`${a} hour${a>1?"s":""}${l?`, ${l} min`:""}`}return`${i} min`}function hs(){const s=R.c(39),{id:t}=te(),[n,g]=z.useState(!1);let i;s[0]!==t?(i=["public-pet",t],s[0]=t,s[1]=i):i=s[1];const a=!!t;let o;s[2]!==t?(o=async()=>{const{data:$,error:G}=await B.from("public_pets").select("*").eq("short_id",t).maybeSingle();if(console.log("Fetched pet data:",$),G)throw G;if(!$)return null;const{data:se}=await B.from("pet_themes").select("theme_preset").eq("pet_id",$.id).maybeSingle();return{...$,theme_preset:se?.theme_preset}},s[2]=t,s[3]=o):o=s[3];let l;s[4]!==i||s[5]!==a||s[6]!==o?(l={queryKey:i,enabled:a,queryFn:o,staleTime:6e4},s[4]=i,s[5]=a,s[6]=o,s[7]=l):l=s[7];const{data:r,isLoading:h,isError:d}=Z(l);let p;s[8]!==r?.theme_preset?(p=()=>{const $=r?.theme_preset||Y;return O($,!1),Le},s[8]=r?.theme_preset,s[9]=p):p=s[9];const x=r?.theme_preset;let f;s[10]!==x?(f=[x],s[10]=x,s[11]=f):f=s[11],z.useEffect(p,f);const c=r?.owner_email||r?.owner_phone,m=r?.owner_instagram||r?.owner_facebook||r?.owner_twitter||r?.owner_telegram||r?.owner_whatsapp||r?.owner_website;let j;s[12]!==t?(j=e.jsx(_e,{shortId:t,askGeo:!0}),s[12]=t,s[13]=j):j=s[13];let u,b;s[14]===Symbol.for("react.memo_cache_sentinel")?(u=e.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[e.jsx("div",{className:"absolute -top-40 -right-40 w-80 h-80 bg-brand-rose/25 rounded-full blur-3xl"}),e.jsx("div",{className:"absolute -bottom-40 -left-40 w-80 h-80 bg-brand-lavender/25 rounded-full blur-3xl"}),e.jsx("div",{className:"absolute top-1/3 right-1/3 w-96 h-96 bg-brand-peach/15 rounded-full blur-3xl"})]}),b=e.jsx(fe,{}),s[14]=u,s[15]=b):(u=s[14],b=s[15]);let N;s[16]!==r||s[17]!==c||s[18]!==m||s[19]!==d||s[20]!==h?(N=e.jsx("main",{className:"relative mx-auto max-w-5xl px-4 sm:px-6 py-8 md:py-12",children:h?e.jsx(F,{className:"overflow-hidden shadow-xl",children:e.jsxs("div",{className:"grid gap-6 p-6 lg:grid-cols-[400px,1fr]",children:[e.jsx(S,{className:"h-96 w-full rounded-lg"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(S,{className:"h-8 w-48"}),e.jsx(S,{className:"h-6 w-64"}),e.jsx(S,{className:"h-4 w-full"}),e.jsx(S,{className:"h-4 w-full"}),e.jsx(S,{className:"h-24 w-full"})]})]})}):d||!r?e.jsxs(F,{className:"shadow-xl",children:[e.jsx(W,{className:"space-y-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-12 w-12 bg-destructive/10 rounded-xl flex items-center justify-center",children:e.jsx(U,{className:"h-6 w-6 text-destructive"})}),e.jsxs("div",{children:[e.jsx(Q,{className:"text-2xl",children:"Pet Not Found"}),e.jsx(ae,{className:"text-base",children:"This QR code may be invalid or the pet profile is no longer available"})]})]})}),e.jsx(K,{children:e.jsx(E,{asChild:!0,className:"gap-2",children:e.jsxs(re,{to:"/",children:[e.jsx(ue,{className:"h-4 w-4"}),"Go to Homepage"]})})})]}):e.jsxs("div",{className:"space-y-6",children:[r.missing&&e.jsxs(H,{variant:"destructive",className:"animate-in fade-in-50 slide-in-from-top-2 duration-300",children:[e.jsx(U,{className:"h-5 w-5"}),e.jsxs(q,{className:"text-base font-medium",children:[e.jsx("span",{className:"block mb-1",children:"🚨 This pet is currently MISSING!"}),r.missing_since&&e.jsxs("span",{className:"text-sm opacity-90",children:["Missing for ",J(r.missing_since)]})]})]}),e.jsxs(F,{className:"overflow-hidden shadow-xl border-primary/10",children:[e.jsx(W,{className:"space-y-4 bg-gradient-to-r from-orange-50/80 to-amber-50/80 dark:bg-slate-900/50",children:e.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-start sm:justify-between",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-10 w-10 bg-primary/10 rounded-xl flex items-center justify-center ring-4 ring-primary/5",children:e.jsx(A,{className:"h-5 w-5 text-primary"})}),e.jsx(Q,{className:"text-3xl tracking-tight",children:r.name})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(T,{variant:"secondary",className:"capitalize text-sm px-3 py-1",children:[r.species==="dog"?"🐕":r.species==="cat"?"🐱":"🐾"," ",r.species]}),r.breed&&e.jsx(T,{variant:"outline",className:"text-sm px-3 py-1",children:r.breed}),r.color&&e.jsx(T,{variant:"outline",className:"text-sm px-3 py-1",children:r.color})]})]}),e.jsx(T,{variant:r.missing?"destructive":"default",className:`text-sm px-4 py-2 gap-2 ${r.missing?"animate-pulse":""}`,children:r.missing?e.jsxs(e.Fragment,{children:[e.jsx(U,{className:"h-4 w-4"}),"Missing"]}):e.jsxs(e.Fragment,{children:[e.jsx(ge,{className:"h-4 w-4"}),"Safe at Home"]})})]})}),e.jsxs(K,{className:"grid gap-8 p-6 lg:grid-cols-[1fr,400px]",children:[e.jsxs("div",{className:"space-y-6 order-2 lg:order-1",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-lg font-semibold",children:[e.jsx(be,{className:"h-5 w-5 text-primary"}),"About ",r.name]}),e.jsx("p",{className:"text-muted-foreground leading-relaxed",children:r.description||"No additional description provided."})]}),(c||m)&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-lg font-semibold",children:[e.jsx(D,{className:"h-5 w-5 text-primary"}),"Contact Owner"]}),e.jsx(H,{className:"border-blue-200 bg-blue-50 dark:border-blue-900 dark:bg-blue-950",children:e.jsx(q,{className:"text-blue-800 dark:text-blue-200",children:"If you've found this pet, please contact the owner using the information below"})}),e.jsxs("div",{className:"space-y-3 pl-4 border-l-2 border-primary/20",children:[r.owner_phone&&e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-10 w-10 bg-primary/10 rounded-lg flex items-center justify-center",children:e.jsx(D,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Phone"}),e.jsx("a",{href:`tel:${r.owner_phone}`,className:"text-primary hover:underline font-medium",children:r.owner_phone})]})]}),r.owner_email&&e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-10 w-10 bg-primary/10 rounded-lg flex items-center justify-center",children:e.jsx(X,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Email"}),e.jsx("a",{href:`mailto:${r.owner_email}`,className:"text-primary hover:underline font-medium",children:r.owner_email})]})]}),r.missing&&e.jsxs("div",{className:"flex items-center gap-3 pt-2",children:[e.jsx("div",{className:"h-10 w-10 bg-orange-100 dark:bg-orange-950 rounded-lg flex items-center justify-center",children:e.jsx(we,{className:"h-5 w-5 text-orange-600 dark:text-orange-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Last Seen"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:r.missing_since?J(r.missing_since)+" ago":"Recently"})]})]}),e.jsx(ke,{petId:r.id,days:30,label:"QR Code Scans"})]}),c&&e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 pt-2",children:[r.owner_phone&&e.jsx(E,{asChild:!0,className:"flex-1 gap-2",variant:"success",children:e.jsxs("a",{href:`tel:${r.owner_phone}`,children:[e.jsx(D,{className:"h-4 w-4"}),"Call Owner"]})}),r.owner_email&&e.jsx(E,{asChild:!0,variant:"outline",className:"flex-1 gap-2",children:e.jsxs("a",{href:`mailto:${r.owner_email}`,children:[e.jsx(X,{className:"h-4 w-4"}),"Send Email"]})})]}),m&&e.jsx("div",{className:"pt-4",children:e.jsx($e,{instagram:r.owner_instagram,facebook:r.owner_facebook,twitter:r.owner_twitter,telegram:r.owner_telegram,whatsapp:r.owner_whatsapp,website:r.owner_website})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-lg font-semibold",children:[e.jsx(je,{className:"h-5 w-5 text-primary"}),"Found This Pet?"]}),e.jsx(H,{children:e.jsx(q,{className:"space-y-2",children:e.jsx("p",{className:"text-sm",children:"Please share your location with the owner when you contact them. This helps reunite pets faster!"})})})]})]}),e.jsx("div",{className:"space-y-4 order-1 lg:order-2",children:r.photo_url?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:()=>g(!0),className:"group relative w-full overflow-hidden rounded-xl border-2 border-primary/10 ring-4 ring-primary/5 transition-all hover:scale-[1.02] hover:shadow-lg cursor-pointer",children:[e.jsx("img",{src:r.photo_url,alt:`${r.name}`,className:"w-full h-auto max-h-[600px] object-contain bg-white"}),e.jsx("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/10 transition-colors flex items-center justify-center",children:e.jsx("span",{className:"text-white opacity-0 group-hover:opacity-100 transition-opacity bg-black/70 px-4 py-2 rounded-lg text-sm",children:"Click to enlarge"})})]}),e.jsx("p",{className:"text-xs text-center text-muted-foreground",children:"Click image to view full size"})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center h-96 rounded-xl border-2 border-dashed border-primary/20 bg-slate-50 dark:bg-slate-900",children:[e.jsx(A,{className:"h-16 w-16 text-primary/30 mb-3"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"No photo provided"})]})})]})]})]})}),s[16]=r,s[17]=c,s[18]=m,s[19]=d,s[20]=h,s[21]=N):N=s[21];let M;s[22]===Symbol.for("react.memo_cache_sentinel")?(M=e.jsx(A,{className:"h-5 w-5"}),s[22]=M):M=s[22];const L=r?.name;let w;s[23]!==L?(w=e.jsx(ie,{className:"p-6 pb-0",children:e.jsxs(ne,{className:"flex items-center gap-2",children:[M,L,"'s Photo"]})}),s[23]=L,s[24]=w):w=s[24];let v;s[25]!==r?(v=r?.photo_url&&e.jsx("div",{className:"p-6 pt-4 overflow-auto",children:e.jsx("img",{src:r.photo_url,alt:`${r.name} full size`,className:"w-full h-auto rounded-lg"})}),s[25]=r,s[26]=v):v=s[26];let y;s[27]!==w||s[28]!==v?(y=e.jsxs(oe,{className:"max-w-4xl max-h-[90vh] p-0 bg-white dark:bg-slate-900",children:[w,v]}),s[27]=w,s[28]=v,s[29]=y):y=s[29];let _;s[30]!==n||s[31]!==y?(_=e.jsx(ce,{open:n,onOpenChange:g,children:y}),s[30]=n,s[31]=y,s[32]=_):_=s[32];let k;s[33]!==N||s[34]!==_?(k=e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-orange-50 via-pink-50 to-purple-50 dark:from-slate-950 dark:via-purple-950/20 dark:to-slate-900",children:[u,b,N,_]}),s[33]=N,s[34]=_,s[35]=k):k=s[35];let P;return s[36]!==k||s[37]!==j?(P=e.jsxs(e.Fragment,{children:[j,k]}),s[36]=k,s[37]=j,s[38]=P):P=s[38],P}function Le(){const s=localStorage.getItem("theme_preset"),t=localStorage.getItem("dark_mode")==="true";s?O(s,t):O(Y,t)}export{hs as default};
