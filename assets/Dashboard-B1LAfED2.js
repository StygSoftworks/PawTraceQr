const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./browser-ztBQBsFW.js","./index-CveSHR4s.js","./index-anPdwH-E.css"])))=>i.map(i=>d[i]);
import{c as F,j as r,u as ft,_ as is,s as X,a as ht,r as c,D as Ge,b as cs,T as ds}from"./index-CveSHR4s.js";import{u as At}from"./useQuery-CttsVz0J.js";import{u as us}from"./useMutation-B67EKEEt.js";import{a as et,b as tt,c as rt,d as st,C as De}from"./card-DUbWSefE.js";import{B as at}from"./badge-ZSezyRVn.js";import{T as ps,a as ms,b as yt,c as jt}from"./tabs-DbUQUT2u.js";import{B as G,u as ee,c as Mt,a as Te}from"./button-C1-kpeoZ.js";import{S as ye}from"./skeleton-Be3C3sjI.js";import{A as Dt,a as Ot,b as Bt,c as Lt,d as Ft,e as $t,f as Vt,g as Ut,T as zt,h as fs}from"./textarea-U31AxJpI.js";import{u as hs,S as qt,P as Nt,a as gs}from"./switch-Dl8_zw-4.js";import{L as Z,I as ne}from"./input-D0GSPZmS.js";import{A as Ht,a as Wt}from"./alert-C4gaMrOg.js";import{l as xs,D as Kt,a as Qt,b as Gt,c as Yt,d as Zt,e as Xt}from"./dialog-CbFadpac.js";import{c as te,a as U}from"./createLucideIcon-cgnMhNqX.js";import{Q as Jt}from"./qr-code-a8bp17FB.js";import{T as ot,c as $e,R as er,A as gt,C as tr,a as rr}from"./index-yxler18g.js";import{u as vs,a as ws,o as St,s as oe,n as bs,_ as ys,b as js}from"./zod-B09zC67m.js";import{P as B,r as sr}from"./index-KwCZusiW.js";import{u as Ns,a as nt,c as ar,b as le,d as Ss,e as V,f as ie,g as Cs,P as or}from"./index-DeFTGeu5.js";import{P as nr,h as lr,u as ir,R as cr,F as dr,D as ur,a as _s,b as Ps,O as Rs,C as ks}from"./index-D0PfoIns.js";import{C as pr}from"./chevron-down-nkFtFTkh.js";import{C as mr}from"./check-DLrX2naY.js";import{C as Ts}from"./chevron-up-DT6WxGwC.js";import{S as Oe}from"./separator-DQKKBwsK.js";import{P as ge}from"./paw-print-D4nB2_VR.js";import{C as Be}from"./circle-alert-D0JU9qgc.js";import{F as Es}from"./file-text-BGFVzLLe.js";import{E as Is}from"./eye-BlR0LmoE.js";import"./index-B5EiWyJA.js";/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const As=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],Ms=te("activity",As);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ds=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],Os=te("calendar",Ds);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bs=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],Ls=te("camera",Bs);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fs=[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]],$s=te("chevrons-up-down",Fs);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vs=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],Us=te("copy",Vs);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zs=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],qs=te("download",zs);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hs=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Ct=te("plus",Hs);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ws=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],Le=te("refresh-cw",Ws);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ks=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],Qs=te("search",Ks);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gs=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],Ys=te("square-pen",Gs);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zs=[["path",{d:"m18 2 4 4",key:"22kx64"}],["path",{d:"m17 7 3-3",key:"1w1zoj"}],["path",{d:"M19 9 8.7 19.3c-1 1-2.5 1-3.4 0l-.6-.6c-1-1-1-2.5 0-3.4L15 5",key:"1exhtz"}],["path",{d:"m9 11 4 4",key:"rovt3i"}],["path",{d:"m5 19-3 3",key:"59f2uf"}],["path",{d:"m14 4 6 6",key:"yqp9t2"}]],Xs=te("syringe",Zs);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Js=[["circle",{cx:"12",cy:"5",r:"3",key:"rqqgnr"}],["path",{d:"M6.5 8a2 2 0 0 0-1.905 1.46L2.1 18.5A2 2 0 0 0 4 21h16a2 2 0 0 0 1.925-2.54L19.4 9.5A2 2 0 0 0 17.48 8Z",key:"56o5sh"}]],ea=te("weight",Js);function ta(s){const e=F.c(8);let t,a;e[0]!==s?({className:t,...a}=s,e[0]=s,e[1]=t,e[2]=a):(t=e[1],a=e[2]);let o;e[3]!==t?(o=U("w-full caption-bottom text-sm",t),e[3]=t,e[4]=o):o=e[4];let n;return e[5]!==a||e[6]!==o?(n=r.jsx("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:r.jsx("table",{"data-slot":"table",className:o,...a})}),e[5]=a,e[6]=o,e[7]=n):n=e[7],n}function ra(s){const e=F.c(8);let t,a;e[0]!==s?({className:t,...a}=s,e[0]=s,e[1]=t,e[2]=a):(t=e[1],a=e[2]);let o;e[3]!==t?(o=U("[&_tr]:border-b",t),e[3]=t,e[4]=o):o=e[4];let n;return e[5]!==a||e[6]!==o?(n=r.jsx("thead",{"data-slot":"table-header",className:o,...a}),e[5]=a,e[6]=o,e[7]=n):n=e[7],n}function sa(s){const e=F.c(8);let t,a;e[0]!==s?({className:t,...a}=s,e[0]=s,e[1]=t,e[2]=a):(t=e[1],a=e[2]);let o;e[3]!==t?(o=U("[&_tr:last-child]:border-0",t),e[3]=t,e[4]=o):o=e[4];let n;return e[5]!==a||e[6]!==o?(n=r.jsx("tbody",{"data-slot":"table-body",className:o,...a}),e[5]=a,e[6]=o,e[7]=n):n=e[7],n}function fr(s){const e=F.c(8);let t,a;e[0]!==s?({className:t,...a}=s,e[0]=s,e[1]=t,e[2]=a):(t=e[1],a=e[2]);let o;e[3]!==t?(o=U("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",t),e[3]=t,e[4]=o):o=e[4];let n;return e[5]!==a||e[6]!==o?(n=r.jsx("tr",{"data-slot":"table-row",className:o,...a}),e[5]=a,e[6]=o,e[7]=n):n=e[7],n}function Ae(s){const e=F.c(8);let t,a;e[0]!==s?({className:t,...a}=s,e[0]=s,e[1]=t,e[2]=a):(t=e[1],a=e[2]);let o;e[3]!==t?(o=U("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),e[3]=t,e[4]=o):o=e[4];let n;return e[5]!==a||e[6]!==o?(n=r.jsx("th",{"data-slot":"table-head",className:o,...a}),e[5]=a,e[6]=o,e[7]=n):n=e[7],n}function Me(s){const e=F.c(8);let t,a;e[0]!==s?({className:t,...a}=s,e[0]=s,e[1]=t,e[2]=a):(t=e[1],a=e[2]);let o;e[3]!==t?(o=U("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),e[3]=t,e[4]=o):o=e[4];let n;return e[5]!==a||e[6]!==o?(n=r.jsx("td",{"data-slot":"table-cell",className:o,...a}),e[5]=a,e[6]=o,e[7]=n):n=e[7],n}function aa(s){const e=F.c(18),{days:t}=s,a=t===void 0?14:t,{user:o}=ft(),n=o?.id??null;let l,d;e[0]!==a||e[1]!==n?(l=["scan_events",n,a],d=()=>n?xs(n,a):Promise.resolve([]),e[0]=a,e[1]=n,e[2]=l,e[3]=d):(l=e[2],d=e[3]);const i=!!n;let u;e[4]!==l||e[5]!==d||e[6]!==i?(u={queryKey:l,queryFn:d,enabled:i,staleTime:3e4},e[4]=l,e[5]=d,e[6]=i,e[7]=u):u=e[7];const{data:p,isLoading:f,isError:y}=At(u);let v;e[8]===Symbol.for("react.memo_cache_sentinel")?(v=r.jsx(tt,{children:"QR Scan Events"}),e[8]=v):v=e[8];let w;e[9]!==a?(w=r.jsxs(rt,{children:[v,r.jsxs(st,{children:["Last ",a," days"]})]}),e[9]=a,e[10]=w):w=e[10];let h;e[11]!==p||e[12]!==y||e[13]!==f?(h=r.jsx(et,{children:f?r.jsx("div",{className:"text-sm text-muted-foreground",children:"Loading…"}):y?r.jsx("div",{className:"text-sm text-destructive",children:"Failed to load scans."}):p?.length?r.jsxs(ta,{children:[r.jsx(ra,{children:r.jsxs(fr,{children:[r.jsx(Ae,{children:"When"}),r.jsx(Ae,{children:"Pet"}),r.jsx(Ae,{children:"Location"}),r.jsx(Ae,{children:"Referrer"})]})}),r.jsx(sa,{children:p.map(oa)})]}):r.jsx("div",{className:"text-sm text-muted-foreground",children:"No scans yet."})}),e[11]=p,e[12]=y,e[13]=f,e[14]=h):h=e[14];let j;return e[15]!==w||e[16]!==h?(j=r.jsxs(De,{children:[w,h]}),e[15]=w,e[16]=h,e[17]=j):j=e[17],j}function oa(s){return r.jsxs(fr,{children:[r.jsx(Me,{className:"whitespace-nowrap",children:new Date(s.scanned_at).toLocaleString()}),r.jsx(Me,{className:"font-medium",children:s.pet_name}),r.jsx(Me,{className:"text-muted-foreground",children:s.city||s.region||s.country?[s.city,s.region,s.country].filter(Boolean).join(", "):r.jsx(at,{variant:"outline",children:"unknown"})}),r.jsx(Me,{className:"truncate max-w-[240px] text-muted-foreground",children:s.referrer||"—"})]},s.id)}async function na(s){return await(await is(async()=>{const{default:t}=await import("./browser-ztBQBsFW.js").then(a=>a.b);return{default:t}},__vite__mapDeps([0,1,2]),import.meta.url)).default.toDataURL(s,{errorCorrectionLevel:"M",margin:1,scale:8,color:{dark:"#000000",light:"#ffffff"}})}async function la(s){return await(await fetch(s)).blob()}async function ia(s,e,t){const a=`${s}/${e}.png`,{error:o}=await X.storage.from("pet-qr").upload(a,t,{contentType:"image/png",upsert:!0});if(o)throw o;const{data:n}=X.storage.from("pet-qr").getPublicUrl(a);return n.publicUrl}async function xt(s,e){const t=`https://www.pawtraceqr.com/p/${e}`,a=await na(t),o=await la(a);return await ia(s,e,o)}let ca=s=>crypto.getRandomValues(new Uint8Array(s)),da=(s,e,t)=>{let a=(2<<Math.log2(s.length-1))-1,o=-~(1.6*a*e/s.length);return(n=e)=>{let l="";for(;;){let d=t(o),i=o|0;for(;i--;)if(l+=s[d[i]&a]||"",l.length>=n)return l}}},ua=(s,e=21)=>da(s,e|0,ca);const pa="0123456789abcdefghijklmnopqrstuvwxyz";function ma(s=4){return ua(pa,s)()}async function fa(s){let e=3;for(let t=0;t<7;t++){const a=ma(e),{data:o,error:n}=await X.from("pets").insert({...s,short_id:a}).select("*").single();if(!n)return o;if(n.code==="23505"&&n.message.includes("pets_short_id_key")){e++;continue}throw n}throw new Error("Could not generate a unique short id for pet.")}async function ke(s,e){const{error:t}=await X.from("pets").update(e).eq("id",s);if(t)throw t;const{data:a,error:o}=await X.from("pets").select("*").eq("id",s).maybeSingle();return o?(console.warn("updatePet: select after update blocked by RLS:",o?.message),{id:s,...e}):a??{id:s,...e}}async function ha(s){const{data:e,error:t}=await X.from("pets").select("*").eq("owner_id",s).order("created_at",{ascending:!1});if(t)throw t;return e??[]}async function _t(s,e,t){if(!t||t.size===0)throw new Error("Empty image blob");const a=t.type||"image/webp",o=a==="image/jpeg"||a==="image/jpg"?"jpg":a==="image/png"?"png":a==="image/avif"?"avif":"webp",n=Date.now(),l=`${s}/${e}-${n}.${o}`,{error:d}=await X.storage.from("pet-photos").upload(l,t,{contentType:a,upsert:!1});if(d)throw console.error("storage.upload error:",d),d;const{data:i}=X.storage.from("pet-photos").getPublicUrl(l);return i.publicUrl}async function ga(s){const{error:e}=await X.from("pets").delete().eq("id",s);if(e)throw e}async function xa(s){if(!s)return;const e=s.indexOf("/pet-photos/");if(e===-1)return;const t=s.substring(e+12);if(!t)return;const{error:a}=await X.storage.from("pet-photos").remove([t]);a&&console.warn("storage.remove warning:",a.message)}async function va(s){const{data:e,error:t}=await X.from("pets").select("id, qr_url").eq("owner_id",s);if(t)throw t;for(const a of e??[])if(!a.qr_url){const o=await xt(s,a.id),{error:n}=await X.from("pets").update({qr_url:o}).eq("id",a.id);if(n)throw n}}function wa({pet:s,open:e,onOpenChange:t,ownerId:a}){const o=ht(),[n,l]=c.useState(!1),[d,i]=c.useState(s?.qr_url??null),u=async()=>{if(!(!s||d)){l(!0);try{const w=await xt(a,s.short_id);await ke(s.id,{qr_url:w}),i(w),await o.invalidateQueries({queryKey:["pets",a]})}catch(w){alert(w?.message??"Failed to generate QR code")}finally{l(!1)}}},p=w=>{w&&s&&!s.qr_url&&!d&&u(),t(w)},f=async w=>{if(w)try{await navigator.clipboard.writeText(w),alert("Copied to clipboard")}catch{alert("Failed to copy")}},y=w=>{if(!w||!s)return;const h=document.createElement("a");h.href=w,h.download=`${s.name}-qr.png`,h.target="_blank",h.rel="noopener noreferrer",h.click()},v=d||s?.qr_url;return r.jsx(Kt,{open:e,onOpenChange:p,children:r.jsxs(Qt,{className:"sm:max-w-md bg-white dark:bg-[#1E1F24] border-2",children:[r.jsx(Gt,{className:"space-y-3",children:r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"h-10 w-10 bg-[#3B3A7A] rounded-xl flex items-center justify-center shadow-md",children:r.jsx(Jt,{className:"h-5 w-5 text-white"})}),r.jsxs("div",{children:[r.jsxs(Yt,{className:"text-xl text-foreground",children:["QR Code ",s?`– ${s.name}`:""]}),r.jsx(Zt,{className:"text-muted-foreground",children:"Scan to open the public pet page"})]})]})}),r.jsx("div",{className:"flex flex-col items-center gap-4 py-4",children:n?r.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground py-8",children:[r.jsx(Le,{className:"h-4 w-4 animate-spin"}),"Generating QR code…"]}):v?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"p-8 bg-white rounded-md border-4 border-[#3B3A7A] shadow-lg",children:r.jsx("img",{src:v,alt:"QR code",className:"h-64 w-64 object-contain",style:{backgroundColor:"#ffffff"}})}),r.jsxs("div",{className:"w-full space-y-2",children:[r.jsx(Z,{className:"text-sm font-semibold text-foreground",children:"QR Code URL"}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(ne,{readOnly:!0,value:v,className:"text-xs bg-background text-foreground border-2"}),r.jsx(G,{type:"button",variant:"outline",size:"icon",onClick:()=>f(v),className:"flex-shrink-0",title:"Copy URL",children:r.jsx(Us,{className:"h-4 w-4"})})]}),r.jsxs(G,{type:"button",onClick:()=>y(v),className:"w-full gap-2 bg-[#3B3A7A] hover:bg-[#3B3A7A]/90 text-white",children:[r.jsx(qs,{className:"h-4 w-4"}),"Download QR Code"]})]})]}):r.jsx("div",{className:"text-sm text-muted-foreground py-8",children:"No QR code available"})}),r.jsx(Xt,{children:r.jsx(G,{type:"button",variant:"outline",onClick:()=>t(!1),className:"border-2",children:"Close"})})]})})}function ba({pet:s,open:e,onOpenChange:t,onDeleted:a}){const[o,n]=c.useState(!1),l=async()=>{if(s){n(!0);try{s.photo_url&&await xa(s.photo_url),await ga(s.id),a(),t(!1)}catch(d){alert(d?.message??"Failed to delete pet")}finally{n(!1)}}};return s?r.jsx(Dt,{open:e,onOpenChange:t,children:r.jsxs(Ot,{children:[r.jsxs(Bt,{children:[r.jsxs(Lt,{className:"flex items-center gap-2",children:[r.jsx(ot,{className:"h-5 w-5 text-destructive"}),"Delete ",s.name,"?"]}),r.jsxs(Ft,{children:["This will permanently remove the pet profile",s.photo_url?" and its photo":"",". This action cannot be undone."]})]}),r.jsxs($t,{children:[r.jsx(Vt,{disabled:o,children:"Cancel"}),r.jsx(Ut,{disabled:o,onClick:l,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90 gap-2",children:o?r.jsxs(r.Fragment,{children:[r.jsx(Le,{className:"h-4 w-4 animate-spin"}),"Deleting…"]}):r.jsxs(r.Fragment,{children:[r.jsx(zt,{className:"h-4 w-4"}),"Delete"]})})]})]})}):null}function ya(s){const e=ht(),[t,a]=c.useState(!1);return{backfillAllQR:async()=>{if(s){a(!0);try{await va(s),await e.invalidateQueries({queryKey:["pets",s]}),alert("QR backfill completed successfully")}catch(n){alert(n?.message??"Backfill failed")}finally{a(!1)}}},isBackfilling:t}}function Pt(s,[e,t]){return Math.min(t,Math.max(e,s))}var hr=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),ja="VisuallyHidden",Na=c.forwardRef((s,e)=>r.jsx(B.span,{...s,ref:e,style:{...hr,...s.style}}));Na.displayName=ja;var Sa=[" ","Enter","ArrowUp","ArrowDown"],Ca=[" ","Enter"],xe="Select",[Ve,Ue,_a]=Ss(xe),[Ce]=ar(xe,[_a,$e]),ze=$e(),[Pa,de]=Ce(xe),[Ra,ka]=Ce(xe),gr=s=>{const{__scopeSelect:e,children:t,open:a,defaultOpen:o,onOpenChange:n,value:l,defaultValue:d,onValueChange:i,dir:u,name:p,autoComplete:f,disabled:y,required:v,form:w}=s,h=ze(e),[j,k]=c.useState(null),[S,P]=c.useState(null),[W,g]=c.useState(!1),I=Ns(u),[C,M]=nt({prop:a,defaultProp:o??!1,onChange:n,caller:xe}),[L,b]=nt({prop:l,defaultProp:d,onChange:i,caller:xe}),O=c.useRef(null),z=j?w||!!j.closest("form"):!0,[re,K]=c.useState(new Set),Q=Array.from(re).map(q=>q.props.value).join(";");return r.jsx(er,{...h,children:r.jsxs(Pa,{required:v,scope:e,trigger:j,onTriggerChange:k,valueNode:S,onValueNodeChange:P,valueNodeHasChildren:W,onValueNodeHasChildrenChange:g,contentId:le(),value:L,onValueChange:b,open:C,onOpenChange:M,dir:I,triggerPointerDownPosRef:O,disabled:y,children:[r.jsx(Ve.Provider,{scope:e,children:r.jsx(Ra,{scope:s.__scopeSelect,onNativeOptionAdd:c.useCallback(q=>{K(Y=>new Set(Y).add(q))},[]),onNativeOptionRemove:c.useCallback(q=>{K(Y=>{const J=new Set(Y);return J.delete(q),J})},[]),children:t})}),z?r.jsxs(Lr,{"aria-hidden":!0,required:v,tabIndex:-1,name:p,autoComplete:f,value:L,onChange:q=>b(q.target.value),disabled:y,form:w,children:[L===void 0?r.jsx("option",{value:""}):null,Array.from(re)]},Q):null]})})};gr.displayName=xe;var xr="SelectTrigger",vr=c.forwardRef((s,e)=>{const{__scopeSelect:t,disabled:a=!1,...o}=s,n=ze(t),l=de(xr,t),d=l.disabled||a,i=ee(e,l.onTriggerChange),u=Ue(t),p=c.useRef("touch"),[f,y,v]=$r(h=>{const j=u().filter(P=>!P.disabled),k=j.find(P=>P.value===l.value),S=Vr(j,h,k);S!==void 0&&l.onValueChange(S.value)}),w=h=>{d||(l.onOpenChange(!0),v()),h&&(l.triggerPointerDownPosRef.current={x:Math.round(h.pageX),y:Math.round(h.pageY)})};return r.jsx(gt,{asChild:!0,...n,children:r.jsx(B.button,{type:"button",role:"combobox","aria-controls":l.contentId,"aria-expanded":l.open,"aria-required":l.required,"aria-autocomplete":"none",dir:l.dir,"data-state":l.open?"open":"closed",disabled:d,"data-disabled":d?"":void 0,"data-placeholder":Fr(l.value)?"":void 0,...o,ref:i,onClick:V(o.onClick,h=>{h.currentTarget.focus(),p.current!=="mouse"&&w(h)}),onPointerDown:V(o.onPointerDown,h=>{p.current=h.pointerType;const j=h.target;j.hasPointerCapture(h.pointerId)&&j.releasePointerCapture(h.pointerId),h.button===0&&h.ctrlKey===!1&&h.pointerType==="mouse"&&(w(h),h.preventDefault())}),onKeyDown:V(o.onKeyDown,h=>{const j=f.current!=="";!(h.ctrlKey||h.altKey||h.metaKey)&&h.key.length===1&&y(h.key),!(j&&h.key===" ")&&Sa.includes(h.key)&&(w(),h.preventDefault())})})})});vr.displayName=xr;var wr="SelectValue",br=c.forwardRef((s,e)=>{const{__scopeSelect:t,className:a,style:o,children:n,placeholder:l="",...d}=s,i=de(wr,t),{onValueNodeHasChildrenChange:u}=i,p=n!==void 0,f=ee(e,i.onValueNodeChange);return ie(()=>{u(p)},[u,p]),r.jsx(B.span,{...d,ref:f,style:{pointerEvents:"none"},children:Fr(i.value)?r.jsx(r.Fragment,{children:l}):n})});br.displayName=wr;var Ta="SelectIcon",yr=c.forwardRef((s,e)=>{const{__scopeSelect:t,children:a,...o}=s;return r.jsx(B.span,{"aria-hidden":!0,...o,ref:e,children:a||"▼"})});yr.displayName=Ta;var Ea="SelectPortal",jr=s=>r.jsx(nr,{asChild:!0,...s});jr.displayName=Ea;var ve="SelectContent",Nr=c.forwardRef((s,e)=>{const t=de(ve,s.__scopeSelect),[a,o]=c.useState();if(ie(()=>{o(new DocumentFragment)},[]),!t.open){const n=a;return n?sr.createPortal(r.jsx(Sr,{scope:s.__scopeSelect,children:r.jsx(Ve.Slot,{scope:s.__scopeSelect,children:r.jsx("div",{children:s.children})})}),n):null}return r.jsx(Cr,{...s,ref:e})});Nr.displayName=ve;var ae=10,[Sr,ue]=Ce(ve),Ia="SelectContentImpl",Aa=Mt("SelectContent.RemoveScroll"),Cr=c.forwardRef((s,e)=>{const{__scopeSelect:t,position:a="item-aligned",onCloseAutoFocus:o,onEscapeKeyDown:n,onPointerDownOutside:l,side:d,sideOffset:i,align:u,alignOffset:p,arrowPadding:f,collisionBoundary:y,collisionPadding:v,sticky:w,hideWhenDetached:h,avoidCollisions:j,...k}=s,S=de(ve,t),[P,W]=c.useState(null),[g,I]=c.useState(null),C=ee(e,x=>W(x)),[M,L]=c.useState(null),[b,O]=c.useState(null),z=Ue(t),[re,K]=c.useState(!1),Q=c.useRef(!1);c.useEffect(()=>{if(P)return lr(P)},[P]),ir();const q=c.useCallback(x=>{const[E,...A]=z().map(H=>H.ref.current),[D]=A.slice(-1),$=document.activeElement;for(const H of x)if(H===$||(H?.scrollIntoView({block:"nearest"}),H===E&&g&&(g.scrollTop=0),H===D&&g&&(g.scrollTop=g.scrollHeight),H?.focus(),document.activeElement!==$))return},[z,g]),Y=c.useCallback(()=>q([M,P]),[q,M,P]);c.useEffect(()=>{re&&Y()},[re,Y]);const{onOpenChange:J,triggerPointerDownPosRef:se}=S;c.useEffect(()=>{if(P){let x={x:0,y:0};const E=D=>{x={x:Math.abs(Math.round(D.pageX)-(se.current?.x??0)),y:Math.abs(Math.round(D.pageY)-(se.current?.y??0))}},A=D=>{x.x<=10&&x.y<=10?D.preventDefault():P.contains(D.target)||J(!1),document.removeEventListener("pointermove",E),se.current=null};return se.current!==null&&(document.addEventListener("pointermove",E),document.addEventListener("pointerup",A,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",E),document.removeEventListener("pointerup",A,{capture:!0})}}},[P,J,se]),c.useEffect(()=>{const x=()=>J(!1);return window.addEventListener("blur",x),window.addEventListener("resize",x),()=>{window.removeEventListener("blur",x),window.removeEventListener("resize",x)}},[J]);const[be,me]=$r(x=>{const E=z().filter($=>!$.disabled),A=E.find($=>$.ref.current===document.activeElement),D=Vr(E,x,A);D&&setTimeout(()=>D.ref.current.focus())}),m=c.useCallback((x,E,A)=>{const D=!Q.current&&!A;(S.value!==void 0&&S.value===E||D)&&(L(x),D&&(Q.current=!0))},[S.value]),_=c.useCallback(()=>P?.focus(),[P]),R=c.useCallback((x,E,A)=>{const D=!Q.current&&!A;(S.value!==void 0&&S.value===E||D)&&O(x)},[S.value]),N=a==="popper"?lt:_r,T=N===lt?{side:d,sideOffset:i,align:u,alignOffset:p,arrowPadding:f,collisionBoundary:y,collisionPadding:v,sticky:w,hideWhenDetached:h,avoidCollisions:j}:{};return r.jsx(Sr,{scope:t,content:P,viewport:g,onViewportChange:I,itemRefCallback:m,selectedItem:M,onItemLeave:_,itemTextRefCallback:R,focusSelectedItem:Y,selectedItemText:b,position:a,isPositioned:re,searchRef:be,children:r.jsx(cr,{as:Aa,allowPinchZoom:!0,children:r.jsx(dr,{asChild:!0,trapped:S.open,onMountAutoFocus:x=>{x.preventDefault()},onUnmountAutoFocus:V(o,x=>{S.trigger?.focus({preventScroll:!0}),x.preventDefault()}),children:r.jsx(ur,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:n,onPointerDownOutside:l,onFocusOutside:x=>x.preventDefault(),onDismiss:()=>S.onOpenChange(!1),children:r.jsx(N,{role:"listbox",id:S.contentId,"data-state":S.open?"open":"closed",dir:S.dir,onContextMenu:x=>x.preventDefault(),...k,...T,onPlaced:()=>K(!0),ref:C,style:{display:"flex",flexDirection:"column",outline:"none",...k.style},onKeyDown:V(k.onKeyDown,x=>{const E=x.ctrlKey||x.altKey||x.metaKey;if(x.key==="Tab"&&x.preventDefault(),!E&&x.key.length===1&&me(x.key),["ArrowUp","ArrowDown","Home","End"].includes(x.key)){let D=z().filter($=>!$.disabled).map($=>$.ref.current);if(["ArrowUp","End"].includes(x.key)&&(D=D.slice().reverse()),["ArrowUp","ArrowDown"].includes(x.key)){const $=x.target,H=D.indexOf($);D=D.slice(H+1)}setTimeout(()=>q(D)),x.preventDefault()}})})})})})})});Cr.displayName=Ia;var Ma="SelectItemAlignedPosition",_r=c.forwardRef((s,e)=>{const{__scopeSelect:t,onPlaced:a,...o}=s,n=de(ve,t),l=ue(ve,t),[d,i]=c.useState(null),[u,p]=c.useState(null),f=ee(e,C=>p(C)),y=Ue(t),v=c.useRef(!1),w=c.useRef(!0),{viewport:h,selectedItem:j,selectedItemText:k,focusSelectedItem:S}=l,P=c.useCallback(()=>{if(n.trigger&&n.valueNode&&d&&u&&h&&j&&k){const C=n.trigger.getBoundingClientRect(),M=u.getBoundingClientRect(),L=n.valueNode.getBoundingClientRect(),b=k.getBoundingClientRect();if(n.dir!=="rtl"){const $=b.left-M.left,H=L.left-$,fe=C.left-H,he=C.width+fe,We=Math.max(he,M.width),Ke=window.innerWidth-ae,Qe=Pt(H,[ae,Math.max(ae,Ke-We)]);d.style.minWidth=he+"px",d.style.left=Qe+"px"}else{const $=M.right-b.right,H=window.innerWidth-L.right-$,fe=window.innerWidth-C.right-H,he=C.width+fe,We=Math.max(he,M.width),Ke=window.innerWidth-ae,Qe=Pt(H,[ae,Math.max(ae,Ke-We)]);d.style.minWidth=he+"px",d.style.right=Qe+"px"}const O=y(),z=window.innerHeight-ae*2,re=h.scrollHeight,K=window.getComputedStyle(u),Q=parseInt(K.borderTopWidth,10),q=parseInt(K.paddingTop,10),Y=parseInt(K.borderBottomWidth,10),J=parseInt(K.paddingBottom,10),se=Q+q+re+J+Y,be=Math.min(j.offsetHeight*5,se),me=window.getComputedStyle(h),m=parseInt(me.paddingTop,10),_=parseInt(me.paddingBottom,10),R=C.top+C.height/2-ae,N=z-R,T=j.offsetHeight/2,x=j.offsetTop+T,E=Q+q+x,A=se-E;if(E<=R){const $=O.length>0&&j===O[O.length-1].ref.current;d.style.bottom="0px";const H=u.clientHeight-h.offsetTop-h.offsetHeight,fe=Math.max(N,T+($?_:0)+H+Y),he=E+fe;d.style.height=he+"px"}else{const $=O.length>0&&j===O[0].ref.current;d.style.top="0px";const fe=Math.max(R,Q+h.offsetTop+($?m:0)+T)+A;d.style.height=fe+"px",h.scrollTop=E-R+h.offsetTop}d.style.margin=`${ae}px 0`,d.style.minHeight=be+"px",d.style.maxHeight=z+"px",a?.(),requestAnimationFrame(()=>v.current=!0)}},[y,n.trigger,n.valueNode,d,u,h,j,k,n.dir,a]);ie(()=>P(),[P]);const[W,g]=c.useState();ie(()=>{u&&g(window.getComputedStyle(u).zIndex)},[u]);const I=c.useCallback(C=>{C&&w.current===!0&&(P(),S?.(),w.current=!1)},[P,S]);return r.jsx(Oa,{scope:t,contentWrapper:d,shouldExpandOnScrollRef:v,onScrollButtonChange:I,children:r.jsx("div",{ref:i,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:W},children:r.jsx(B.div,{...o,ref:f,style:{boxSizing:"border-box",maxHeight:"100%",...o.style}})})})});_r.displayName=Ma;var Da="SelectPopperPosition",lt=c.forwardRef((s,e)=>{const{__scopeSelect:t,align:a="start",collisionPadding:o=ae,...n}=s,l=ze(t);return r.jsx(tr,{...l,...n,ref:e,align:a,collisionPadding:o,style:{boxSizing:"border-box",...n.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});lt.displayName=Da;var[Oa,vt]=Ce(ve,{}),it="SelectViewport",Pr=c.forwardRef((s,e)=>{const{__scopeSelect:t,nonce:a,...o}=s,n=ue(it,t),l=vt(it,t),d=ee(e,n.onViewportChange),i=c.useRef(0);return r.jsxs(r.Fragment,{children:[r.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:a}),r.jsx(Ve.Slot,{scope:t,children:r.jsx(B.div,{"data-radix-select-viewport":"",role:"presentation",...o,ref:d,style:{position:"relative",flex:1,overflow:"hidden auto",...o.style},onScroll:V(o.onScroll,u=>{const p=u.currentTarget,{contentWrapper:f,shouldExpandOnScrollRef:y}=l;if(y?.current&&f){const v=Math.abs(i.current-p.scrollTop);if(v>0){const w=window.innerHeight-ae*2,h=parseFloat(f.style.minHeight),j=parseFloat(f.style.height),k=Math.max(h,j);if(k<w){const S=k+v,P=Math.min(w,S),W=S-P;f.style.height=P+"px",f.style.bottom==="0px"&&(p.scrollTop=W>0?W:0,f.style.justifyContent="flex-end")}}}i.current=p.scrollTop})})})]})});Pr.displayName=it;var Rr="SelectGroup",[Ba,La]=Ce(Rr),Fa=c.forwardRef((s,e)=>{const{__scopeSelect:t,...a}=s,o=le();return r.jsx(Ba,{scope:t,id:o,children:r.jsx(B.div,{role:"group","aria-labelledby":o,...a,ref:e})})});Fa.displayName=Rr;var kr="SelectLabel",$a=c.forwardRef((s,e)=>{const{__scopeSelect:t,...a}=s,o=La(kr,t);return r.jsx(B.div,{id:o.id,...a,ref:e})});$a.displayName=kr;var Fe="SelectItem",[Va,Tr]=Ce(Fe),Er=c.forwardRef((s,e)=>{const{__scopeSelect:t,value:a,disabled:o=!1,textValue:n,...l}=s,d=de(Fe,t),i=ue(Fe,t),u=d.value===a,[p,f]=c.useState(n??""),[y,v]=c.useState(!1),w=ee(e,S=>i.itemRefCallback?.(S,a,o)),h=le(),j=c.useRef("touch"),k=()=>{o||(d.onValueChange(a),d.onOpenChange(!1))};if(a==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return r.jsx(Va,{scope:t,value:a,disabled:o,textId:h,isSelected:u,onItemTextChange:c.useCallback(S=>{f(P=>P||(S?.textContent??"").trim())},[]),children:r.jsx(Ve.ItemSlot,{scope:t,value:a,disabled:o,textValue:p,children:r.jsx(B.div,{role:"option","aria-labelledby":h,"data-highlighted":y?"":void 0,"aria-selected":u&&y,"data-state":u?"checked":"unchecked","aria-disabled":o||void 0,"data-disabled":o?"":void 0,tabIndex:o?void 0:-1,...l,ref:w,onFocus:V(l.onFocus,()=>v(!0)),onBlur:V(l.onBlur,()=>v(!1)),onClick:V(l.onClick,()=>{j.current!=="mouse"&&k()}),onPointerUp:V(l.onPointerUp,()=>{j.current==="mouse"&&k()}),onPointerDown:V(l.onPointerDown,S=>{j.current=S.pointerType}),onPointerMove:V(l.onPointerMove,S=>{j.current=S.pointerType,o?i.onItemLeave?.():j.current==="mouse"&&S.currentTarget.focus({preventScroll:!0})}),onPointerLeave:V(l.onPointerLeave,S=>{S.currentTarget===document.activeElement&&i.onItemLeave?.()}),onKeyDown:V(l.onKeyDown,S=>{i.searchRef?.current!==""&&S.key===" "||(Ca.includes(S.key)&&k(),S.key===" "&&S.preventDefault())})})})})});Er.displayName=Fe;var Re="SelectItemText",Ir=c.forwardRef((s,e)=>{const{__scopeSelect:t,className:a,style:o,...n}=s,l=de(Re,t),d=ue(Re,t),i=Tr(Re,t),u=ka(Re,t),[p,f]=c.useState(null),y=ee(e,k=>f(k),i.onItemTextChange,k=>d.itemTextRefCallback?.(k,i.value,i.disabled)),v=p?.textContent,w=c.useMemo(()=>r.jsx("option",{value:i.value,disabled:i.disabled,children:v},i.value),[i.disabled,i.value,v]),{onNativeOptionAdd:h,onNativeOptionRemove:j}=u;return ie(()=>(h(w),()=>j(w)),[h,j,w]),r.jsxs(r.Fragment,{children:[r.jsx(B.span,{id:i.textId,...n,ref:y}),i.isSelected&&l.valueNode&&!l.valueNodeHasChildren?sr.createPortal(n.children,l.valueNode):null]})});Ir.displayName=Re;var Ar="SelectItemIndicator",Mr=c.forwardRef((s,e)=>{const{__scopeSelect:t,...a}=s;return Tr(Ar,t).isSelected?r.jsx(B.span,{"aria-hidden":!0,...a,ref:e}):null});Mr.displayName=Ar;var ct="SelectScrollUpButton",Dr=c.forwardRef((s,e)=>{const t=ue(ct,s.__scopeSelect),a=vt(ct,s.__scopeSelect),[o,n]=c.useState(!1),l=ee(e,a.onScrollButtonChange);return ie(()=>{if(t.viewport&&t.isPositioned){let d=function(){const u=i.scrollTop>0;n(u)};const i=t.viewport;return d(),i.addEventListener("scroll",d),()=>i.removeEventListener("scroll",d)}},[t.viewport,t.isPositioned]),o?r.jsx(Br,{...s,ref:l,onAutoScroll:()=>{const{viewport:d,selectedItem:i}=t;d&&i&&(d.scrollTop=d.scrollTop-i.offsetHeight)}}):null});Dr.displayName=ct;var dt="SelectScrollDownButton",Or=c.forwardRef((s,e)=>{const t=ue(dt,s.__scopeSelect),a=vt(dt,s.__scopeSelect),[o,n]=c.useState(!1),l=ee(e,a.onScrollButtonChange);return ie(()=>{if(t.viewport&&t.isPositioned){let d=function(){const u=i.scrollHeight-i.clientHeight,p=Math.ceil(i.scrollTop)<u;n(p)};const i=t.viewport;return d(),i.addEventListener("scroll",d),()=>i.removeEventListener("scroll",d)}},[t.viewport,t.isPositioned]),o?r.jsx(Br,{...s,ref:l,onAutoScroll:()=>{const{viewport:d,selectedItem:i}=t;d&&i&&(d.scrollTop=d.scrollTop+i.offsetHeight)}}):null});Or.displayName=dt;var Br=c.forwardRef((s,e)=>{const{__scopeSelect:t,onAutoScroll:a,...o}=s,n=ue("SelectScrollButton",t),l=c.useRef(null),d=Ue(t),i=c.useCallback(()=>{l.current!==null&&(window.clearInterval(l.current),l.current=null)},[]);return c.useEffect(()=>()=>i(),[i]),ie(()=>{d().find(p=>p.ref.current===document.activeElement)?.ref.current?.scrollIntoView({block:"nearest"})},[d]),r.jsx(B.div,{"aria-hidden":!0,...o,ref:e,style:{flexShrink:0,...o.style},onPointerDown:V(o.onPointerDown,()=>{l.current===null&&(l.current=window.setInterval(a,50))}),onPointerMove:V(o.onPointerMove,()=>{n.onItemLeave?.(),l.current===null&&(l.current=window.setInterval(a,50))}),onPointerLeave:V(o.onPointerLeave,()=>{i()})})}),Ua="SelectSeparator",za=c.forwardRef((s,e)=>{const{__scopeSelect:t,...a}=s;return r.jsx(B.div,{"aria-hidden":!0,...a,ref:e})});za.displayName=Ua;var ut="SelectArrow",qa=c.forwardRef((s,e)=>{const{__scopeSelect:t,...a}=s,o=ze(t),n=de(ut,t),l=ue(ut,t);return n.open&&l.position==="popper"?r.jsx(rr,{...o,...a,ref:e}):null});qa.displayName=ut;var Ha="SelectBubbleInput",Lr=c.forwardRef(({__scopeSelect:s,value:e,...t},a)=>{const o=c.useRef(null),n=ee(a,o),l=hs(e);return c.useEffect(()=>{const d=o.current;if(!d)return;const i=window.HTMLSelectElement.prototype,p=Object.getOwnPropertyDescriptor(i,"value").set;if(l!==e&&p){const f=new Event("change",{bubbles:!0});p.call(d,e),d.dispatchEvent(f)}},[l,e]),r.jsx(B.select,{...t,style:{...hr,...t.style},ref:n,defaultValue:e})});Lr.displayName=Ha;function Fr(s){return s===""||s===void 0}function $r(s){const e=Cs(s),t=c.useRef(""),a=c.useRef(0),o=c.useCallback(l=>{const d=t.current+l;e(d),(function i(u){t.current=u,window.clearTimeout(a.current),u!==""&&(a.current=window.setTimeout(()=>i(""),1e3))})(d)},[e]),n=c.useCallback(()=>{t.current="",window.clearTimeout(a.current)},[]);return c.useEffect(()=>()=>window.clearTimeout(a.current),[]),[t,o,n]}function Vr(s,e,t){const o=e.length>1&&Array.from(e).every(u=>u===e[0])?e[0]:e,n=t?s.indexOf(t):-1;let l=Wa(s,Math.max(n,0));o.length===1&&(l=l.filter(u=>u!==t));const i=l.find(u=>u.textValue.toLowerCase().startsWith(o.toLowerCase()));return i!==t?i:void 0}function Wa(s,e){return s.map((t,a)=>s[(e+a)%s.length])}var Ka=gr,Qa=vr,Ga=br,Ya=yr,Za=jr,Xa=Nr,Ja=Pr,eo=Er,to=Ir,ro=Mr,so=Dr,ao=Or;function oo(s){const e=F.c(4);let t;e[0]!==s?({...t}=s,e[0]=s,e[1]=t):t=e[1];let a;return e[2]!==t?(a=r.jsx(Ka,{"data-slot":"select",...t}),e[2]=t,e[3]=a):a=e[3],a}function no(s){const e=F.c(4);let t;e[0]!==s?({...t}=s,e[0]=s,e[1]=t):t=e[1];let a;return e[2]!==t?(a=r.jsx(Ga,{"data-slot":"select-value",...t}),e[2]=t,e[3]=a):a=e[3],a}function lo(s){const e=F.c(13);let t,a,o,n;e[0]!==s?({className:a,size:n,children:t,...o}=s,e[0]=s,e[1]=t,e[2]=a,e[3]=o,e[4]=n):(t=e[1],a=e[2],o=e[3],n=e[4]);const l=n===void 0?"default":n;let d;e[5]!==a?(d=U("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",a),e[5]=a,e[6]=d):d=e[6];let i;e[7]===Symbol.for("react.memo_cache_sentinel")?(i=r.jsx(Ya,{asChild:!0,children:r.jsx(pr,{className:"size-4 opacity-50"})}),e[7]=i):i=e[7];let u;return e[8]!==t||e[9]!==o||e[10]!==l||e[11]!==d?(u=r.jsxs(Qa,{"data-slot":"select-trigger","data-size":l,className:d,...o,children:[t,i]}),e[8]=t,e[9]=o,e[10]=l,e[11]=d,e[12]=u):u=e[12],u}function io(s){const e=F.c(20);let t,a,o,n;e[0]!==s?({className:a,children:t,position:n,...o}=s,e[0]=s,e[1]=t,e[2]=a,e[3]=o,e[4]=n):(t=e[1],a=e[2],o=e[3],n=e[4]);const l=n===void 0?"popper":n,d=l==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1";let i;e[5]!==a||e[6]!==d?(i=U("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md",d,a),e[5]=a,e[6]=d,e[7]=i):i=e[7];let u;e[8]===Symbol.for("react.memo_cache_sentinel")?(u=r.jsx(co,{}),e[8]=u):u=e[8];const p=l==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1";let f;e[9]!==p?(f=U("p-1",p),e[9]=p,e[10]=f):f=e[10];let y;e[11]!==t||e[12]!==f?(y=r.jsx(Ja,{className:f,children:t}),e[11]=t,e[12]=f,e[13]=y):y=e[13];let v;e[14]===Symbol.for("react.memo_cache_sentinel")?(v=r.jsx(uo,{}),e[14]=v):v=e[14];let w;return e[15]!==l||e[16]!==o||e[17]!==i||e[18]!==y?(w=r.jsx(Za,{children:r.jsxs(Xa,{"data-slot":"select-content",className:i,position:l,...o,children:[u,y,v]})}),e[15]=l,e[16]=o,e[17]=i,e[18]=y,e[19]=w):w=e[19],w}function Ye(s){const e=F.c(13);let t,a,o;e[0]!==s?({className:a,children:t,...o}=s,e[0]=s,e[1]=t,e[2]=a,e[3]=o):(t=e[1],a=e[2],o=e[3]);let n;e[4]!==a?(n=U("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",a),e[4]=a,e[5]=n):n=e[5];let l;e[6]===Symbol.for("react.memo_cache_sentinel")?(l=r.jsx("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:r.jsx(ro,{children:r.jsx(mr,{className:"size-4"})})}),e[6]=l):l=e[6];let d;e[7]!==t?(d=r.jsx(to,{children:t}),e[7]=t,e[8]=d):d=e[8];let i;return e[9]!==o||e[10]!==n||e[11]!==d?(i=r.jsxs(eo,{"data-slot":"select-item",className:n,...o,children:[l,d]}),e[9]=o,e[10]=n,e[11]=d,e[12]=i):i=e[12],i}function co(s){const e=F.c(9);let t,a;e[0]!==s?({className:t,...a}=s,e[0]=s,e[1]=t,e[2]=a):(t=e[1],a=e[2]);let o;e[3]!==t?(o=U("flex cursor-default items-center justify-center py-1",t),e[3]=t,e[4]=o):o=e[4];let n;e[5]===Symbol.for("react.memo_cache_sentinel")?(n=r.jsx(Ts,{className:"size-4"}),e[5]=n):n=e[5];let l;return e[6]!==a||e[7]!==o?(l=r.jsx(so,{"data-slot":"select-scroll-up-button",className:o,...a,children:n}),e[6]=a,e[7]=o,e[8]=l):l=e[8],l}function uo(s){const e=F.c(9);let t,a;e[0]!==s?({className:t,...a}=s,e[0]=s,e[1]=t,e[2]=a):(t=e[1],a=e[2]);let o;e[3]!==t?(o=U("flex cursor-default items-center justify-center py-1",t),e[3]=t,e[4]=o):o=e[4];let n;e[5]===Symbol.for("react.memo_cache_sentinel")?(n=r.jsx(pr,{className:"size-4"}),e[5]=n):n=e[5];let l;return e[6]!==a||e[7]!==o?(l=r.jsx(ao,{"data-slot":"select-scroll-down-button",className:o,...a,children:n}),e[6]=a,e[7]=o,e[8]=l):l=e[8],l}var qe="Popover",[Ur]=ar(qe,[$e]),Ee=$e(),[po,pe]=Ur(qe),zr=s=>{const{__scopePopover:e,children:t,open:a,defaultOpen:o,onOpenChange:n,modal:l=!1}=s,d=Ee(e),i=c.useRef(null),[u,p]=c.useState(!1),[f,y]=nt({prop:a,defaultProp:o??!1,onChange:n,caller:qe});return r.jsx(er,{...d,children:r.jsx(po,{scope:e,contentId:le(),triggerRef:i,open:f,onOpenChange:y,onOpenToggle:c.useCallback(()=>y(v=>!v),[y]),hasCustomAnchor:u,onCustomAnchorAdd:c.useCallback(()=>p(!0),[]),onCustomAnchorRemove:c.useCallback(()=>p(!1),[]),modal:l,children:t})})};zr.displayName=qe;var qr="PopoverAnchor",mo=c.forwardRef((s,e)=>{const{__scopePopover:t,...a}=s,o=pe(qr,t),n=Ee(t),{onCustomAnchorAdd:l,onCustomAnchorRemove:d}=o;return c.useEffect(()=>(l(),()=>d()),[l,d]),r.jsx(gt,{...n,...a,ref:e})});mo.displayName=qr;var Hr="PopoverTrigger",Wr=c.forwardRef((s,e)=>{const{__scopePopover:t,...a}=s,o=pe(Hr,t),n=Ee(t),l=ee(e,o.triggerRef),d=r.jsx(B.button,{type:"button","aria-haspopup":"dialog","aria-expanded":o.open,"aria-controls":o.contentId,"data-state":Zr(o.open),...a,ref:l,onClick:V(s.onClick,o.onOpenToggle)});return o.hasCustomAnchor?d:r.jsx(gt,{asChild:!0,...n,children:d})});Wr.displayName=Hr;var wt="PopoverPortal",[fo,ho]=Ur(wt,{forceMount:void 0}),Kr=s=>{const{__scopePopover:e,forceMount:t,children:a,container:o}=s,n=pe(wt,e);return r.jsx(fo,{scope:e,forceMount:t,children:r.jsx(or,{present:t||n.open,children:r.jsx(nr,{asChild:!0,container:o,children:a})})})};Kr.displayName=wt;var Se="PopoverContent",Qr=c.forwardRef((s,e)=>{const t=ho(Se,s.__scopePopover),{forceMount:a=t.forceMount,...o}=s,n=pe(Se,s.__scopePopover);return r.jsx(or,{present:a||n.open,children:n.modal?r.jsx(xo,{...o,ref:e}):r.jsx(vo,{...o,ref:e})})});Qr.displayName=Se;var go=Mt("PopoverContent.RemoveScroll"),xo=c.forwardRef((s,e)=>{const t=pe(Se,s.__scopePopover),a=c.useRef(null),o=ee(e,a),n=c.useRef(!1);return c.useEffect(()=>{const l=a.current;if(l)return lr(l)},[]),r.jsx(cr,{as:go,allowPinchZoom:!0,children:r.jsx(Gr,{...s,ref:o,trapFocus:t.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:V(s.onCloseAutoFocus,l=>{l.preventDefault(),n.current||t.triggerRef.current?.focus()}),onPointerDownOutside:V(s.onPointerDownOutside,l=>{const d=l.detail.originalEvent,i=d.button===0&&d.ctrlKey===!0,u=d.button===2||i;n.current=u},{checkForDefaultPrevented:!1}),onFocusOutside:V(s.onFocusOutside,l=>l.preventDefault(),{checkForDefaultPrevented:!1})})})}),vo=c.forwardRef((s,e)=>{const t=pe(Se,s.__scopePopover),a=c.useRef(!1),o=c.useRef(!1);return r.jsx(Gr,{...s,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:n=>{s.onCloseAutoFocus?.(n),n.defaultPrevented||(a.current||t.triggerRef.current?.focus(),n.preventDefault()),a.current=!1,o.current=!1},onInteractOutside:n=>{s.onInteractOutside?.(n),n.defaultPrevented||(a.current=!0,n.detail.originalEvent.type==="pointerdown"&&(o.current=!0));const l=n.target;t.triggerRef.current?.contains(l)&&n.preventDefault(),n.detail.originalEvent.type==="focusin"&&o.current&&n.preventDefault()}})}),Gr=c.forwardRef((s,e)=>{const{__scopePopover:t,trapFocus:a,onOpenAutoFocus:o,onCloseAutoFocus:n,disableOutsidePointerEvents:l,onEscapeKeyDown:d,onPointerDownOutside:i,onFocusOutside:u,onInteractOutside:p,...f}=s,y=pe(Se,t),v=Ee(t);return ir(),r.jsx(dr,{asChild:!0,loop:!0,trapped:a,onMountAutoFocus:o,onUnmountAutoFocus:n,children:r.jsx(ur,{asChild:!0,disableOutsidePointerEvents:l,onInteractOutside:p,onEscapeKeyDown:d,onPointerDownOutside:i,onFocusOutside:u,onDismiss:()=>y.onOpenChange(!1),children:r.jsx(tr,{"data-state":Zr(y.open),role:"dialog",id:y.contentId,...v,...f,ref:e,style:{...f.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),Yr="PopoverClose",wo=c.forwardRef((s,e)=>{const{__scopePopover:t,...a}=s,o=pe(Yr,t);return r.jsx(B.button,{type:"button",...a,ref:e,onClick:V(s.onClick,()=>o.onOpenChange(!1))})});wo.displayName=Yr;var bo="PopoverArrow",yo=c.forwardRef((s,e)=>{const{__scopePopover:t,...a}=s,o=Ee(t);return r.jsx(rr,{...o,...a,ref:e})});yo.displayName=bo;function Zr(s){return s?"open":"closed"}var jo=zr,No=Wr,So=Kr,Co=Qr;function _o(s){const e=F.c(4);let t;e[0]!==s?({...t}=s,e[0]=s,e[1]=t):t=e[1];let a;return e[2]!==t?(a=r.jsx(jo,{"data-slot":"popover",...t}),e[2]=t,e[3]=a):a=e[3],a}function Po(s){const e=F.c(4);let t;e[0]!==s?({...t}=s,e[0]=s,e[1]=t):t=e[1];let a;return e[2]!==t?(a=r.jsx(No,{"data-slot":"popover-trigger",...t}),e[2]=t,e[3]=a):a=e[3],a}function Ro(s){const e=F.c(12);let t,a,o,n;e[0]!==s?({className:t,align:o,sideOffset:n,...a}=s,e[0]=s,e[1]=t,e[2]=a,e[3]=o,e[4]=n):(t=e[1],a=e[2],o=e[3],n=e[4]);const l=o===void 0?"center":o,d=n===void 0?4:n;let i;e[5]!==t?(i=U("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-72 origin-(--radix-popover-content-transform-origin) rounded-md border p-4 shadow-md outline-hidden",t),e[5]=t,e[6]=i):i=e[6];let u;return e[7]!==l||e[8]!==a||e[9]!==d||e[10]!==i?(u=r.jsx(So,{children:r.jsx(Co,{"data-slot":"popover-content",align:l,sideOffset:d,className:i,...a})}),e[7]=l,e[8]=a,e[9]=d,e[10]=i,e[11]=u):u=e[11],u}var Rt=1,ko=.9,To=.8,Eo=.17,Ze=.1,Xe=.999,Io=.9999,Ao=.99,Mo=/[\\\/_+.#"@\[\(\{&]/,Do=/[\\\/_+.#"@\[\(\{&]/g,Oo=/[\s-]/,Xr=/[\s-]/g;function pt(s,e,t,a,o,n,l){if(n===e.length)return o===s.length?Rt:Ao;var d=`${o},${n}`;if(l[d]!==void 0)return l[d];for(var i=a.charAt(n),u=t.indexOf(i,o),p=0,f,y,v,w;u>=0;)f=pt(s,e,t,a,u+1,n+1,l),f>p&&(u===o?f*=Rt:Mo.test(s.charAt(u-1))?(f*=To,v=s.slice(o,u-1).match(Do),v&&o>0&&(f*=Math.pow(Xe,v.length))):Oo.test(s.charAt(u-1))?(f*=ko,w=s.slice(o,u-1).match(Xr),w&&o>0&&(f*=Math.pow(Xe,w.length))):(f*=Eo,o>0&&(f*=Math.pow(Xe,u-o))),s.charAt(u)!==e.charAt(n)&&(f*=Io)),(f<Ze&&t.charAt(u-1)===a.charAt(n+1)||a.charAt(n+1)===a.charAt(n)&&t.charAt(u-1)!==a.charAt(n))&&(y=pt(s,e,t,a,u+1,n+2,l),y*Ze>f&&(f=y*Ze)),f>p&&(p=f),u=t.indexOf(i,u+1);return l[d]=p,p}function kt(s){return s.toLowerCase().replace(Xr," ")}function Bo(s,e,t){return s=t&&t.length>0?`${s+" "+t.join(" ")}`:s,pt(s,e,kt(s),kt(e),0,0,{})}var Pe='[cmdk-group=""]',Je='[cmdk-group-items=""]',Lo='[cmdk-group-heading=""]',Jr='[cmdk-item=""]',Tt=`${Jr}:not([aria-disabled="true"])`,mt="cmdk-item-select",je="data-value",Fo=(s,e,t)=>Bo(s,e,t),es=c.createContext(void 0),Ie=()=>c.useContext(es),ts=c.createContext(void 0),bt=()=>c.useContext(ts),rs=c.createContext(void 0),ss=c.forwardRef((s,e)=>{let t=Ne(()=>{var m,_;return{search:"",value:(_=(m=s.value)!=null?m:s.defaultValue)!=null?_:"",selectedItemId:void 0,filtered:{count:0,items:new Map,groups:new Set}}}),a=Ne(()=>new Set),o=Ne(()=>new Map),n=Ne(()=>new Map),l=Ne(()=>new Set),d=as(s),{label:i,children:u,value:p,onValueChange:f,filter:y,shouldFilter:v,loop:w,disablePointerSelection:h=!1,vimBindings:j=!0,...k}=s,S=le(),P=le(),W=le(),g=c.useRef(null),I=Yo();we(()=>{if(p!==void 0){let m=p.trim();t.current.value=m,C.emit()}},[p]),we(()=>{I(6,re)},[]);let C=c.useMemo(()=>({subscribe:m=>(l.current.add(m),()=>l.current.delete(m)),snapshot:()=>t.current,setState:(m,_,R)=>{var N,T,x,E;if(!Object.is(t.current[m],_)){if(t.current[m]=_,m==="search")z(),b(),I(1,O);else if(m==="value"){if(document.activeElement.hasAttribute("cmdk-input")||document.activeElement.hasAttribute("cmdk-root")){let A=document.getElementById(W);A?A.focus():(N=document.getElementById(S))==null||N.focus()}if(I(7,()=>{var A;t.current.selectedItemId=(A=K())==null?void 0:A.id,C.emit()}),R||I(5,re),((T=d.current)==null?void 0:T.value)!==void 0){let A=_??"";(E=(x=d.current).onValueChange)==null||E.call(x,A);return}}C.emit()}},emit:()=>{l.current.forEach(m=>m())}}),[]),M=c.useMemo(()=>({value:(m,_,R)=>{var N;_!==((N=n.current.get(m))==null?void 0:N.value)&&(n.current.set(m,{value:_,keywords:R}),t.current.filtered.items.set(m,L(_,R)),I(2,()=>{b(),C.emit()}))},item:(m,_)=>(a.current.add(m),_&&(o.current.has(_)?o.current.get(_).add(m):o.current.set(_,new Set([m]))),I(3,()=>{z(),b(),t.current.value||O(),C.emit()}),()=>{n.current.delete(m),a.current.delete(m),t.current.filtered.items.delete(m);let R=K();I(4,()=>{z(),R?.getAttribute("id")===m&&O(),C.emit()})}),group:m=>(o.current.has(m)||o.current.set(m,new Set),()=>{n.current.delete(m),o.current.delete(m)}),filter:()=>d.current.shouldFilter,label:i||s["aria-label"],getDisablePointerSelection:()=>d.current.disablePointerSelection,listId:S,inputId:W,labelId:P,listInnerRef:g}),[]);function L(m,_){var R,N;let T=(N=(R=d.current)==null?void 0:R.filter)!=null?N:Fo;return m?T(m,t.current.search,_):0}function b(){if(!t.current.search||d.current.shouldFilter===!1)return;let m=t.current.filtered.items,_=[];t.current.filtered.groups.forEach(N=>{let T=o.current.get(N),x=0;T.forEach(E=>{let A=m.get(E);x=Math.max(A,x)}),_.push([N,x])});let R=g.current;Q().sort((N,T)=>{var x,E;let A=N.getAttribute("id"),D=T.getAttribute("id");return((x=m.get(D))!=null?x:0)-((E=m.get(A))!=null?E:0)}).forEach(N=>{let T=N.closest(Je);T?T.appendChild(N.parentElement===T?N:N.closest(`${Je} > *`)):R.appendChild(N.parentElement===R?N:N.closest(`${Je} > *`))}),_.sort((N,T)=>T[1]-N[1]).forEach(N=>{var T;let x=(T=g.current)==null?void 0:T.querySelector(`${Pe}[${je}="${encodeURIComponent(N[0])}"]`);x?.parentElement.appendChild(x)})}function O(){let m=Q().find(R=>R.getAttribute("aria-disabled")!=="true"),_=m?.getAttribute(je);C.setState("value",_||void 0)}function z(){var m,_,R,N;if(!t.current.search||d.current.shouldFilter===!1){t.current.filtered.count=a.current.size;return}t.current.filtered.groups=new Set;let T=0;for(let x of a.current){let E=(_=(m=n.current.get(x))==null?void 0:m.value)!=null?_:"",A=(N=(R=n.current.get(x))==null?void 0:R.keywords)!=null?N:[],D=L(E,A);t.current.filtered.items.set(x,D),D>0&&T++}for(let[x,E]of o.current)for(let A of E)if(t.current.filtered.items.get(A)>0){t.current.filtered.groups.add(x);break}t.current.filtered.count=T}function re(){var m,_,R;let N=K();N&&(((m=N.parentElement)==null?void 0:m.firstChild)===N&&((R=(_=N.closest(Pe))==null?void 0:_.querySelector(Lo))==null||R.scrollIntoView({block:"nearest"})),N.scrollIntoView({block:"nearest"}))}function K(){var m;return(m=g.current)==null?void 0:m.querySelector(`${Jr}[aria-selected="true"]`)}function Q(){var m;return Array.from(((m=g.current)==null?void 0:m.querySelectorAll(Tt))||[])}function q(m){let _=Q()[m];_&&C.setState("value",_.getAttribute(je))}function Y(m){var _;let R=K(),N=Q(),T=N.findIndex(E=>E===R),x=N[T+m];(_=d.current)!=null&&_.loop&&(x=T+m<0?N[N.length-1]:T+m===N.length?N[0]:N[T+m]),x&&C.setState("value",x.getAttribute(je))}function J(m){let _=K(),R=_?.closest(Pe),N;for(;R&&!N;)R=m>0?Qo(R,Pe):Go(R,Pe),N=R?.querySelector(Tt);N?C.setState("value",N.getAttribute(je)):Y(m)}let se=()=>q(Q().length-1),be=m=>{m.preventDefault(),m.metaKey?se():m.altKey?J(1):Y(1)},me=m=>{m.preventDefault(),m.metaKey?q(0):m.altKey?J(-1):Y(-1)};return c.createElement(B.div,{ref:e,tabIndex:-1,...k,"cmdk-root":"",onKeyDown:m=>{var _;(_=k.onKeyDown)==null||_.call(k,m);let R=m.nativeEvent.isComposing||m.keyCode===229;if(!(m.defaultPrevented||R))switch(m.key){case"n":case"j":{j&&m.ctrlKey&&be(m);break}case"ArrowDown":{be(m);break}case"p":case"k":{j&&m.ctrlKey&&me(m);break}case"ArrowUp":{me(m);break}case"Home":{m.preventDefault(),q(0);break}case"End":{m.preventDefault(),se();break}case"Enter":{m.preventDefault();let N=K();if(N){let T=new Event(mt);N.dispatchEvent(T)}}}}},c.createElement("label",{"cmdk-label":"",htmlFor:M.inputId,id:M.labelId,style:Xo},i),He(s,m=>c.createElement(ts.Provider,{value:C},c.createElement(es.Provider,{value:M},m))))}),$o=c.forwardRef((s,e)=>{var t,a;let o=le(),n=c.useRef(null),l=c.useContext(rs),d=Ie(),i=as(s),u=(a=(t=i.current)==null?void 0:t.forceMount)!=null?a:l?.forceMount;we(()=>{if(!u)return d.item(o,l?.id)},[u]);let p=os(o,n,[s.value,s.children,n],s.keywords),f=bt(),y=ce(I=>I.value&&I.value===p.current),v=ce(I=>u||d.filter()===!1?!0:I.search?I.filtered.items.get(o)>0:!0);c.useEffect(()=>{let I=n.current;if(!(!I||s.disabled))return I.addEventListener(mt,w),()=>I.removeEventListener(mt,w)},[v,s.onSelect,s.disabled]);function w(){var I,C;h(),(C=(I=i.current).onSelect)==null||C.call(I,p.current)}function h(){f.setState("value",p.current,!0)}if(!v)return null;let{disabled:j,value:k,onSelect:S,forceMount:P,keywords:W,...g}=s;return c.createElement(B.div,{ref:Te(n,e),...g,id:o,"cmdk-item":"",role:"option","aria-disabled":!!j,"aria-selected":!!y,"data-disabled":!!j,"data-selected":!!y,onPointerMove:j||d.getDisablePointerSelection()?void 0:h,onClick:j?void 0:w},s.children)}),Vo=c.forwardRef((s,e)=>{let{heading:t,children:a,forceMount:o,...n}=s,l=le(),d=c.useRef(null),i=c.useRef(null),u=le(),p=Ie(),f=ce(v=>o||p.filter()===!1?!0:v.search?v.filtered.groups.has(l):!0);we(()=>p.group(l),[]),os(l,d,[s.value,s.heading,i]);let y=c.useMemo(()=>({id:l,forceMount:o}),[o]);return c.createElement(B.div,{ref:Te(d,e),...n,"cmdk-group":"",role:"presentation",hidden:f?void 0:!0},t&&c.createElement("div",{ref:i,"cmdk-group-heading":"","aria-hidden":!0,id:u},t),He(s,v=>c.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":t?u:void 0},c.createElement(rs.Provider,{value:y},v))))}),Uo=c.forwardRef((s,e)=>{let{alwaysRender:t,...a}=s,o=c.useRef(null),n=ce(l=>!l.search);return!t&&!n?null:c.createElement(B.div,{ref:Te(o,e),...a,"cmdk-separator":"",role:"separator"})}),zo=c.forwardRef((s,e)=>{let{onValueChange:t,...a}=s,o=s.value!=null,n=bt(),l=ce(u=>u.search),d=ce(u=>u.selectedItemId),i=Ie();return c.useEffect(()=>{s.value!=null&&n.setState("search",s.value)},[s.value]),c.createElement(B.input,{ref:e,...a,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":i.listId,"aria-labelledby":i.labelId,"aria-activedescendant":d,id:i.inputId,type:"text",value:o?s.value:l,onChange:u=>{o||n.setState("search",u.target.value),t?.(u.target.value)}})}),qo=c.forwardRef((s,e)=>{let{children:t,label:a="Suggestions",...o}=s,n=c.useRef(null),l=c.useRef(null),d=ce(u=>u.selectedItemId),i=Ie();return c.useEffect(()=>{if(l.current&&n.current){let u=l.current,p=n.current,f,y=new ResizeObserver(()=>{f=requestAnimationFrame(()=>{let v=u.offsetHeight;p.style.setProperty("--cmdk-list-height",v.toFixed(1)+"px")})});return y.observe(u),()=>{cancelAnimationFrame(f),y.unobserve(u)}}},[]),c.createElement(B.div,{ref:Te(n,e),...o,"cmdk-list":"",role:"listbox",tabIndex:-1,"aria-activedescendant":d,"aria-label":a,id:i.listId},He(s,u=>c.createElement("div",{ref:Te(l,i.listInnerRef),"cmdk-list-sizer":""},u)))}),Ho=c.forwardRef((s,e)=>{let{open:t,onOpenChange:a,overlayClassName:o,contentClassName:n,container:l,...d}=s;return c.createElement(_s,{open:t,onOpenChange:a},c.createElement(Ps,{container:l},c.createElement(Rs,{"cmdk-overlay":"",className:o}),c.createElement(ks,{"aria-label":s.label,"cmdk-dialog":"",className:n},c.createElement(ss,{ref:e,...d}))))}),Wo=c.forwardRef((s,e)=>ce(t=>t.filtered.count===0)?c.createElement(B.div,{ref:e,...s,"cmdk-empty":"",role:"presentation"}):null),Ko=c.forwardRef((s,e)=>{let{progress:t,children:a,label:o="Loading...",...n}=s;return c.createElement(B.div,{ref:e,...n,"cmdk-loading":"",role:"progressbar","aria-valuenow":t,"aria-valuemin":0,"aria-valuemax":100,"aria-label":o},He(s,l=>c.createElement("div",{"aria-hidden":!0},l)))}),_e=Object.assign(ss,{List:qo,Item:$o,Input:zo,Group:Vo,Separator:Uo,Dialog:Ho,Empty:Wo,Loading:Ko});function Qo(s,e){let t=s.nextElementSibling;for(;t;){if(t.matches(e))return t;t=t.nextElementSibling}}function Go(s,e){let t=s.previousElementSibling;for(;t;){if(t.matches(e))return t;t=t.previousElementSibling}}function as(s){let e=c.useRef(s);return we(()=>{e.current=s}),e}var we=typeof window>"u"?c.useEffect:c.useLayoutEffect;function Ne(s){let e=c.useRef();return e.current===void 0&&(e.current=s()),e}function ce(s){let e=bt(),t=()=>s(e.snapshot());return c.useSyncExternalStore(e.subscribe,t,t)}function os(s,e,t,a=[]){let o=c.useRef(),n=Ie();return we(()=>{var l;let d=(()=>{var u;for(let p of t){if(typeof p=="string")return p.trim();if(typeof p=="object"&&"current"in p)return p.current?(u=p.current.textContent)==null?void 0:u.trim():o.current}})(),i=a.map(u=>u.trim());n.value(s,d,i),(l=e.current)==null||l.setAttribute(je,d),o.current=d}),o}var Yo=()=>{let[s,e]=c.useState(),t=Ne(()=>new Map);return we(()=>{t.current.forEach(a=>a()),t.current=new Map},[s]),(a,o)=>{t.current.set(a,o),e({})}};function Zo(s){let e=s.type;return typeof e=="function"?e(s.props):"render"in e?e.render(s.props):s}function He({asChild:s,children:e},t){return s&&c.isValidElement(e)?c.cloneElement(Zo(e),{ref:e.ref},t(e.props.children)):t(e)}var Xo={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};function Jo(s){const e=F.c(8);let t,a;e[0]!==s?({className:t,...a}=s,e[0]=s,e[1]=t,e[2]=a):(t=e[1],a=e[2]);let o;e[3]!==t?(o=U("bg-popover text-popover-foreground flex h-full w-full flex-col overflow-hidden rounded-md",t),e[3]=t,e[4]=o):o=e[4];let n;return e[5]!==a||e[6]!==o?(n=r.jsx(_e,{"data-slot":"command",className:o,...a}),e[5]=a,e[6]=o,e[7]=n):n=e[7],n}function en(s){const e=F.c(9);let t,a;e[0]!==s?({className:t,...a}=s,e[0]=s,e[1]=t,e[2]=a):(t=e[1],a=e[2]);let o;e[3]===Symbol.for("react.memo_cache_sentinel")?(o=r.jsx(Qs,{className:"size-4 shrink-0 opacity-50"}),e[3]=o):o=e[3];let n;e[4]!==t?(n=U("placeholder:text-muted-foreground flex h-10 w-full rounded-md bg-transparent py-3 text-sm outline-hidden disabled:cursor-not-allowed disabled:opacity-50",t),e[4]=t,e[5]=n):n=e[5];let l;return e[6]!==a||e[7]!==n?(l=r.jsxs("div",{"data-slot":"command-input-wrapper",className:"flex h-9 items-center gap-2 border-b px-3",children:[o,r.jsx(_e.Input,{"data-slot":"command-input",className:n,...a})]}),e[6]=a,e[7]=n,e[8]=l):l=e[8],l}function tn(s){const e=F.c(8);let t,a;e[0]!==s?({className:t,...a}=s,e[0]=s,e[1]=t,e[2]=a):(t=e[1],a=e[2]);let o;e[3]!==t?(o=U("max-h-[300px] scroll-py-1 overflow-x-hidden overflow-y-auto",t),e[3]=t,e[4]=o):o=e[4];let n;return e[5]!==a||e[6]!==o?(n=r.jsx(_e.List,{"data-slot":"command-list",className:o,...a}),e[5]=a,e[6]=o,e[7]=n):n=e[7],n}function rn(s){const e=F.c(4);let t;e[0]!==s?({...t}=s,e[0]=s,e[1]=t):t=e[1];let a;return e[2]!==t?(a=r.jsx(_e.Empty,{"data-slot":"command-empty",className:"py-6 text-center text-sm",...t}),e[2]=t,e[3]=a):a=e[3],a}function sn(s){const e=F.c(8);let t,a;e[0]!==s?({className:t,...a}=s,e[0]=s,e[1]=t,e[2]=a):(t=e[1],a=e[2]);let o;e[3]!==t?(o=U("text-foreground [&_[cmdk-group-heading]]:text-muted-foreground overflow-hidden p-1 [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium",t),e[3]=t,e[4]=o):o=e[4];let n;return e[5]!==a||e[6]!==o?(n=r.jsx(_e.Group,{"data-slot":"command-group",className:o,...a}),e[5]=a,e[6]=o,e[7]=n):n=e[7],n}function an(s){const e=F.c(8);let t,a;e[0]!==s?({className:t,...a}=s,e[0]=s,e[1]=t,e[2]=a):(t=e[1],a=e[2]);let o;e[3]!==t?(o=U("data-[selected=true]:bg-accent data-[selected=true]:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled=true]:pointer-events-none data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),e[3]=t,e[4]=o):o=e[4];let n;return e[5]!==a||e[6]!==o?(n=r.jsx(_e.Item,{"data-slot":"command-item",className:o,...a}),e[5]=a,e[6]=o,e[7]=n):n=e[7],n}const ns=[{name:"Golden Retriever",defaultColors:["Golden"]},{name:"Labrador Retriever",defaultColors:["Yellow","Black","Chocolate"]},{name:"German Shepherd",defaultColors:["Black/Tan","Sable","Black"]},{name:"French Bulldog",defaultColors:["Fawn","Brindle","Cream","Pied"]},{name:"Poodle",defaultColors:["White","Black","Apricot","Red"]},{name:"Bulldog",defaultColors:["Fawn","Brindle","White","Piebald"]},{name:"Beagle",defaultColors:["Tri-color","Lemon/White","Red/White"]},{name:"Rottweiler",defaultColors:["Black/Rust"]},{name:"Dachshund",defaultColors:["Red","Black/Tan","Chocolate/Tan","Dapple"]},{name:"Yorkshire Terrier",defaultColors:["Blue/Tan"]}],ls=[{name:"Bicolor / Tuxedo",defaultColors:["Black/White","Gray/White","Seal/White"]},{name:"Calico",defaultColors:["Black/Orange/White","Dilute (Blue/Cream/White)"]},{name:"Pointed",defaultColors:["Seal point","Blue point","Chocolate point","Lilac point","Flame point"]},{name:"Shaded",defaultColors:["Shaded Silver","Shaded Golden"]},{name:"Smoke",defaultColors:["Black Smoke","Blue Smoke"]},{name:"Solid",defaultColors:["Black","White","Blue/Gray","Red/Orange","Cream"]},{name:"Spotted",defaultColors:["Brown Spotted","Silver Spotted"]},{name:"Tabby",defaultColors:["Brown Tabby","Gray/Blue Tabby","Orange Tabby","Silver Tabby","Torbie"]},{name:"Tortoiseshell (Tortie)",defaultColors:["Black/Orange","Chocolate/Cream","Dilute (Blue/Cream)"]}];function on(s,e){return!s||!e?[]:s==="dog"?ns.find(a=>a.name===e)?.defaultColors??[]:s==="cat"?ls.find(a=>a.name===e)?.defaultColors??[]:[]}const nn=ns.map(s=>s.name),ln=ls.map(s=>s.name);function cn({label:s="Photo",value:e,onChange:t,options:a,accept:o="image/*",className:n}){const l=c.useRef(null),d=()=>l.current?.click(),i=()=>t(null),u=async p=>{if(!p||!p.type.startsWith("image/"))return;const f=await dn(p,a);t(f)};return r.jsxs("div",{className:n,children:[r.jsx(Z,{className:"mb-2 block",children:s}),r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx(G,{type:"button",variant:"outline",onClick:d,children:e?"Replace Image":"Upload Image"}),e&&r.jsx(G,{type:"button",variant:"ghost",onClick:i,children:"Remove"})]}),r.jsx(ne,{ref:l,type:"file",accept:o,className:"hidden",onChange:p=>{const f=p.target.files?.[0];f&&u(f),p.currentTarget.value=""}}),e&&r.jsxs(r.Fragment,{children:[r.jsx(Oe,{className:"my-3"}),r.jsxs("div",{className:"flex items-start gap-4",children:[r.jsx("img",{src:e.dataUrl,alt:"preview",className:"h-24 w-24 rounded-md object-cover border"}),r.jsxs("div",{className:"text-sm text-muted-foreground space-y-1",children:[r.jsxs("div",{children:[r.jsx("span",{className:"font-medium text-foreground",children:"Optimized:"})," ",e.mimeType]}),r.jsxs("div",{children:["Size: ~",e.approxKB.toLocaleString()," KB"]}),r.jsxs("div",{children:["Dims: ",e.width," × ",e.height]}),r.jsxs("div",{className:"mt-2",children:[r.jsx("span",{className:"font-medium text-foreground",children:"Original:"})," ",e.original.name," — ",e.original.sizeKB.toLocaleString()," KB"]})]})]})]})]})}async function dn(s,e){const t=await s.arrayBuffer(),a=new Blob([t]),o=await pn(a),n=e?.maxWidth??1200,l=e?.maxHeight??1200,{width:d,height:i}=un(o.width,o.height,n,l),u=document.createElement("canvas");u.width=d,u.height=i,u.getContext("2d").drawImage(o,0,0,d,i);const f=e?.preferWebP??!0,y=e?.quality??.82,v=u.toDataURL("image/webp").startsWith("data:image/webp"),w=f&&v?"image/webp":"image/jpeg",h=await mn(u,w,y),j=await fn(h);return{blob:h,dataUrl:j,width:d,height:i,approxKB:Math.round(h.size/1024),mimeType:w,original:{name:s.name,sizeKB:Math.round(s.size/1024),type:s.type}}}function un(s,e,t,a){const o=Math.min(t/s,a/e,1);return{width:Math.round(s*o),height:Math.round(e*o)}}function pn(s){return new Promise((e,t)=>{const a=URL.createObjectURL(s),o=new Image;o.onload=()=>{URL.revokeObjectURL(a),e(o)},o.onerror=t,o.src=a})}function mn(s,e,t){return new Promise(a=>s.toBlob(o=>a(o),e,t))}function fn(s){return new Promise(e=>{const t=new FileReader;t.onload=()=>e(String(t.result)),t.readAsDataURL(s)})}function hn(s){const[e,t]=c.useState(Ge),[a,o]=c.useState(!0);return c.useEffect(()=>{if(!s){o(!1);return}(async()=>{try{const{data:i,error:u}=await X.from("pet_themes").select("theme_preset, custom_colors, background_image_url").eq("pet_id",s).maybeSingle();if(u)throw u;t(i?i.theme_preset:Ge)}catch(i){console.error("Failed to load pet theme:",i),t(Ge)}finally{o(!1)}})()},[s]),{themeId:e,isLoading:a,updatePetTheme:async d=>{if(s){t(d);try{const{error:i}=await X.from("pet_themes").upsert({pet_id:s,theme_preset:d,updated_at:new Date().toISOString()});if(i)throw i}catch(i){console.error("Failed to save pet theme:",i)}}},applyPetTheme:(d=!1)=>{cs(e,d)}}}const gn=St({id:oe().optional(),name:oe().min(1,"Name is required"),species:ys(["dog","cat","other"],{message:"Choose a species"}),breed:oe().optional(),color:oe().optional(),weight:bs().min(0,"Weight must be positive").optional(),birthdate:oe().optional(),microchipId:oe().optional(),description:oe().optional(),notes:oe().optional(),vaccinations:St({rabies:js().default(!1),rabiesExpires:oe().optional()}).default({rabies:!1,rabiesExpires:""}),photoPreview:oe().optional()});async function Et(s){return await(await fetch(s)).blob()}function It({mode:s,open:e,onOpenChange:t,initialPet:a,onSubmit:o}){const{user:n}=ft(),[l,d]=c.useState(!1),i=vs({resolver:ws(gn),defaultValues:{id:a?.id,name:a?.name??"",species:a?.species,breed:a?.breed??"",color:a?.color??"",weight:a?.weight??void 0,birthdate:a?.birthdate??"",microchipId:a?.microchipId??"",description:a?.description??"",notes:a?.notes??"",vaccinations:{rabies:a?.vaccinations?.rabies??!1,rabiesExpires:a?.vaccinations?.rabiesExpires??""},photoPreview:a?.photoPreview??""},mode:"onSubmit"}),u=i.watch("species"),p=i.watch("breed"),[f,y]=c.useState(!1),{themeId:v,updatePetTheme:w}=hn(a?.id),[h,j]=c.useState(v);c.useEffect(()=>{j(v)},[v]);const k=c.useRef(null),S=c.useMemo(()=>u==="dog"?nn:u==="cat"?ln:[],[u]),P=c.useMemo(()=>on(u??"other",p),[u,p]),W=async g=>{if(!n?.id){alert("You must be signed in.");return}d(!0);const I={rabies:!!g.vaccinations?.rabies,rabiesExpires:g.vaccinations?.rabies&&g.vaccinations.rabiesExpires||void 0},C={owner_id:n.id,name:g.name,species:g.species,breed:g.breed||null,color:g.color||null,weight:typeof g.weight=="number"?g.weight:null,birthdate:g.birthdate||null,microchip_id:g.microchipId||null,description:g.description||null,notes:g.notes||null,vaccinations:I};try{let M;if(s==="add"){M=await fa({...C});try{const b=await xt(n.id,M.short_id);await ke(M.id,{qr_url:b})}catch(b){console.warn("QR generation failed (non-blocking):",b?.message)}let L=k.current;if(!L&&g.photoPreview&&(L=await Et(g.photoPreview)),L&&L.size>0){const b=await _t(n.id,M.id,L);M=await ke(M.id,{photo_url:b})}}else{const L=g.id||a?.id;if(!L)throw new Error("Missing pet id for update.");let b=k.current;!b&&g.photoPreview&&(b=await Et(g.photoPreview));const O={name:C.name,species:C.species,breed:C.breed,color:C.color,weight:C.weight,birthdate:C.birthdate,microchip_id:C.microchip_id,description:C.description,notes:C.notes,vaccinations:C.vaccinations};if(b&&b.size>0){const z=await _t(n.id,L,b);O.photo_url=z}M=await ke(L,O)}M?.id&&await w(h),o?.(g),t(!1),s==="add"&&i.reset()}catch(M){console.error(M),alert(M?.message??"Failed to save pet")}finally{d(!1)}};return r.jsx(Kt,{open:e,onOpenChange:g=>!l&&t(g),children:r.jsxs(Qt,{className:"sm:max-w-2xl max-h-[90vh] overflow-y-auto bg-white dark:bg-slate-900",children:[r.jsx(Gt,{className:"space-y-3",children:r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"h-10 w-10 bg-primary/10 rounded-xl flex items-center justify-center ring-4 ring-primary/5",children:r.jsx(ge,{className:"h-5 w-5 text-primary"})}),r.jsxs("div",{children:[r.jsx(Yt,{className:"text-2xl",children:s==="add"?"Add New Pet":"Edit Pet"}),r.jsx(Zt,{className:"text-base",children:s==="add"?"Enter your pet's details to create their profile":"Update your pet's information"})]})]})}),r.jsxs("form",{onSubmit:i.handleSubmit(W),className:"space-y-6 mt-4",children:[r.jsxs("section",{className:"space-y-4",children:[r.jsxs("div",{className:"flex items-center gap-2 text-sm font-semibold text-foreground",children:[r.jsx(qt,{className:"h-4 w-4 text-primary"}),"Basic Information"]}),r.jsxs("div",{className:"space-y-4 pl-6 border-l-2 border-primary/20",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsxs(Z,{htmlFor:"name",className:"text-sm font-medium flex items-center gap-2",children:["Name ",r.jsx("span",{className:"text-destructive",children:"*"})]}),r.jsx(ne,{id:"name",...i.register("name"),placeholder:"e.g., Milo, Luna, Max",className:"h-11 transition-all duration-200 focus:ring-2 focus:ring-primary/20"}),i.formState.errors.name&&r.jsxs("p",{className:"text-sm text-destructive flex items-center gap-1.5 animate-in fade-in-50",children:[r.jsx(Be,{className:"h-3.5 w-3.5"}),i.formState.errors.name.message]})]}),r.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsxs(Z,{className:"text-sm font-medium flex items-center gap-2",children:["Species ",r.jsx("span",{className:"text-destructive",children:"*"})]}),r.jsxs(oo,{value:u,onValueChange:g=>{i.setValue("species",g,{shouldValidate:!0}),i.setValue("breed",""),i.setValue("color","")},children:[r.jsx(lo,{className:"h-11",children:r.jsx(no,{placeholder:"Select species"})}),r.jsxs(io,{children:[r.jsx(Ye,{value:"dog",children:"🐕 Dog"}),r.jsx(Ye,{value:"cat",children:"🐱 Cat"}),r.jsx(Ye,{value:"other",children:"🐾 Other"})]})]}),i.formState.errors.species&&r.jsxs("p",{className:"text-sm text-destructive flex items-center gap-1.5",children:[r.jsx(Be,{className:"h-3.5 w-3.5"}),i.formState.errors.species.message]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs(Z,{htmlFor:"birthdate",className:"text-sm font-medium flex items-center gap-2",children:[r.jsx(Os,{className:"h-3.5 w-3.5"}),"Birthdate"]}),r.jsx(ne,{id:"birthdate",type:"date",...i.register("birthdate"),className:"h-11"})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs(Z,{className:"text-sm font-medium flex items-center gap-2",children:[r.jsx(ge,{className:"h-3.5 w-3.5"}),u==="cat"?"Pattern":"Breed",u==="other"&&r.jsx("span",{className:"text-muted-foreground text-xs",children:"(optional)"})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(ne,{placeholder:u==="dog"?"e.g., Golden Retriever":u==="cat"?"e.g., Tabby, Calico":"e.g., Rabbit, Guinea Pig",...i.register("breed"),className:"h-11 flex-1"}),S.length>0&&r.jsxs(_o,{open:f,onOpenChange:y,children:[r.jsx(Po,{asChild:!0,children:r.jsxs(G,{type:"button",variant:"outline",className:"w-36 justify-between h-11",children:["Suggestions ",r.jsx($s,{className:"h-4 w-4 opacity-60"})]})}),r.jsx(Ro,{className:"p-0 w-64",children:r.jsxs(Jo,{children:[r.jsx(en,{placeholder:"Search…"}),r.jsxs(tn,{children:[r.jsx(rn,{children:"No matches found."}),r.jsx(sn,{children:S.map(g=>r.jsx(an,{value:g,onSelect:I=>{i.setValue("breed",I),y(!1)},children:g},g))})]})]})})]})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs(Z,{htmlFor:"color",className:"text-sm font-medium flex items-center gap-2",children:[r.jsx(Nt,{className:"h-3.5 w-3.5"}),"Color"]}),r.jsx(ne,{id:"color",...i.register("color"),placeholder:"e.g., Brown, White, Mixed",className:"h-11"}),P.length>0&&r.jsx("div",{className:"flex flex-wrap gap-2 pt-1",children:P.map(g=>r.jsx("button",{type:"button",onClick:()=>i.setValue("color",g,{shouldValidate:!0}),className:"rounded-full border border-primary/20 bg-primary/5 px-3 py-1 text-xs font-medium hover:bg-primary/10 transition-colors",children:g},g))})]}),r.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsxs(Z,{htmlFor:"weight",className:"text-sm font-medium flex items-center gap-2",children:[r.jsx(ea,{className:"h-3.5 w-3.5"}),"Weight (lbs)"]}),r.jsx(ne,{id:"weight",type:"number",step:"0.1",placeholder:"e.g., 45.5",...i.register("weight",{valueAsNumber:!0}),className:"h-11"}),i.formState.errors.weight&&r.jsxs("p",{className:"text-sm text-destructive flex items-center gap-1.5",children:[r.jsx(Be,{className:"h-3.5 w-3.5"}),i.formState.errors.weight.message]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs(Z,{htmlFor:"microchipId",className:"text-sm font-medium flex items-center gap-2",children:[r.jsx(Es,{className:"h-3.5 w-3.5"}),"Microchip ID"]}),r.jsx(ne,{id:"microchipId",...i.register("microchipId"),placeholder:"e.g., 981000012345678",className:"h-11"})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Z,{htmlFor:"description",className:"text-sm font-medium",children:"Physical Description"}),r.jsx(ne,{id:"description",...i.register("description"),placeholder:"e.g., White paws, brown spot on left ear",className:"h-11"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Z,{htmlFor:"notes",className:"text-sm font-medium",children:"Additional Notes"}),r.jsx(fs,{id:"notes",...i.register("notes"),placeholder:"Allergies, medications, behavioral notes, vet contact info...",className:"min-h-[80px] resize-none"})]})]})]}),r.jsx(Oe,{}),r.jsxs("section",{className:"space-y-4",children:[r.jsxs("div",{className:"flex items-center gap-2 text-sm font-semibold text-foreground",children:[r.jsx(Xs,{className:"h-4 w-4 text-primary"}),"Vaccinations"]}),r.jsxs("div",{className:"space-y-3 pl-6 border-l-2 border-primary/20",children:[r.jsx(Ht,{className:"border-blue-200 bg-blue-50 dark:border-blue-900 dark:bg-blue-950",children:r.jsx(Wt,{className:"text-xs text-blue-800 dark:text-blue-200",children:"Keep track of your pet's vaccination records for their health and safety"})}),r.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-3 bg-secondary/30 rounded-lg p-4",children:[r.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[r.jsx("input",{id:"rabies",type:"checkbox",className:"h-4 w-4 rounded border-primary text-primary focus:ring-primary",checked:!!i.watch("vaccinations.rabies"),onChange:g=>i.setValue("vaccinations.rabies",g.target.checked)}),r.jsx(Z,{htmlFor:"rabies",className:"text-sm font-medium cursor-pointer",children:"Rabies Vaccination"})]}),r.jsxs("div",{className:"flex items-center gap-2 sm:w-48",children:[r.jsx(Z,{htmlFor:"rabiesExpires",className:"text-xs text-muted-foreground whitespace-nowrap",children:"Expires:"}),r.jsx(ne,{id:"rabiesExpires",type:"date",disabled:!i.watch("vaccinations.rabies"),...i.register("vaccinations.rabiesExpires"),className:"h-9"})]})]})]})]}),r.jsx(Oe,{}),r.jsxs("section",{className:"space-y-4",children:[r.jsxs("div",{className:"flex items-center gap-2 text-sm font-semibold text-foreground",children:[r.jsx(Nt,{className:"h-4 w-4 text-primary"}),"Page Theme"]}),r.jsxs("div",{className:"pl-6 border-l-2 border-primary/20",children:[r.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Choose a color theme for your pet's public page"}),r.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-3",children:Object.values(ds).map(g=>r.jsxs("button",{type:"button",onClick:()=>j(g.id),className:U("relative p-3 rounded-lg border-2 transition-all hover:scale-105",h===g.id?"border-primary shadow-md":"border-border hover:border-primary/50"),children:[r.jsx("div",{className:U("h-16 rounded-md mb-2 bg-gradient-to-br",g.previewGradient)}),r.jsx("p",{className:"text-xs font-medium text-center",children:g.name}),h===g.id&&r.jsx("div",{className:"absolute top-2 right-2 h-5 w-5 bg-primary rounded-full flex items-center justify-center",children:r.jsx(mr,{className:"h-3 w-3 text-primary-foreground"})})]},g.id))})]})]}),r.jsx(Oe,{}),r.jsxs("section",{className:"space-y-4",children:[r.jsxs("div",{className:"flex items-center gap-2 text-sm font-semibold text-foreground",children:[r.jsx(Ls,{className:"h-4 w-4 text-primary"}),"Pet Photo"]}),r.jsx("div",{className:"pl-6 border-l-2 border-primary/20",children:r.jsx(cn,{label:"",value:i.watch("photoPreview")?{blob:new Blob,dataUrl:i.watch("photoPreview"),width:0,height:0,approxKB:0,mimeType:"image/*",original:{name:"",sizeKB:0,type:""}}:null,onChange:g=>{k.current=g?.blob??null,i.setValue("photoPreview",g?.dataUrl??"")},options:{maxWidth:1200,maxHeight:1200,quality:.82,preferWebP:!0}})})]}),r.jsxs(Xt,{className:"gap-2 sm:gap-0 pt-4",children:[r.jsx(G,{type:"button",variant:"outline",onClick:()=>t(!1),disabled:l,className:"transition-all hover:scale-105",children:"Cancel"}),r.jsx(G,{type:"submit",disabled:l,className:"transition-all hover:scale-105",children:l?r.jsxs("span",{className:"flex items-center gap-2",children:[r.jsxs("svg",{className:"animate-spin h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[r.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),r.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),s==="add"?"Creating...":"Updating..."]}):r.jsxs("span",{className:"flex items-center gap-2",children:[r.jsx(ge,{className:"h-4 w-4"}),s==="add"?"Create Pet Profile":"Save Changes"]})})]})]})]})})}function Wn(){const{user:s}=ft(),e=ht(),t=s?.id??null,{backfillAllQR:a,isBackfilling:o}=ya(t),{data:n,isLoading:l,isError:d}=At({queryKey:["pets",t],queryFn:async()=>t?ha(t):[],enabled:!!t,staleTime:3e4}),[i,u]=c.useState(!1),[p,f]=c.useState(null),[y,v]=c.useState(null),[w,h]=c.useState(null),[j,k]=c.useState(null),[S,P]=c.useState(!1),W=b=>{const z=`${window.location.origin}/p/${b.short_id}`;window.open(z,"_blank")},g=async()=>{await e.invalidateQueries({queryKey:["pets",t]}),f(null),u(!1)},I=async()=>{await e.invalidateQueries({queryKey:["pets",t]}),v(null)},C=us({mutationFn:async({id:b,missing:O})=>ke(b,{missing:O,missing_since:O?new Date().toISOString():null}),onSuccess:async()=>{await e.invalidateQueries({queryKey:["pets",t]})}}),M=async(b,O)=>{if(O)k(b);else try{P(!0),await C.mutateAsync({id:b.id,missing:!1})}catch(z){alert(z?.message??"Failed to update")}finally{P(!1)}},L=async()=>{if(j)try{P(!0),await C.mutateAsync({id:j.id,missing:!0})}catch(b){alert(b?.message??"Failed to update")}finally{P(!1),k(null)}};return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex flex-col gap-2",children:[r.jsxs("h1",{className:"text-3xl font-bold tracking-tight flex items-center gap-3",children:[r.jsx("div",{className:"h-10 w-10 bg-primary/10 rounded-xl flex items-center justify-center ring-4 ring-primary/5",children:r.jsx(ge,{className:"h-5 w-5 text-primary"})}),"Dashboard"]}),r.jsx("p",{className:"text-muted-foreground",children:"Manage your pets, QR codes, and track activity"})]}),r.jsxs(ps,{defaultValue:"pets",className:"space-y-4",children:[r.jsxs(ms,{className:"grid w-full max-w-md grid-cols-2",children:[r.jsxs(yt,{value:"pets",className:"gap-2",children:[r.jsx(ge,{className:"h-4 w-4"}),"My Pets"]}),r.jsxs(yt,{value:"activity",className:"gap-2",children:[r.jsx(Ms,{className:"h-4 w-4"}),"Recent Activity"]})]}),r.jsxs(jt,{value:"pets",className:"space-y-4",children:[r.jsxs(De,{className:"shadow-lg border-primary/10",children:[r.jsx(rt,{className:"space-y-4",children:r.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-4",children:[r.jsxs("div",{className:"space-y-1.5",children:[r.jsxs(tt,{className:"text-2xl flex items-center gap-2",children:[r.jsx(qt,{className:"h-5 w-5 text-primary"}),"Registered Pets"]}),r.jsx(st,{className:"text-base",children:"Manage profiles, photos, QR tags, and missing status"})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[r.jsxs(G,{variant:"outline",onClick:a,disabled:!t||o,className:"gap-2 transition-all hover:scale-105",children:[r.jsx(Le,{className:`h-4 w-4 ${o?"animate-spin":""}`}),o?"Working…":"Backfill QR"]}),r.jsxs(G,{onClick:()=>u(!0),disabled:!t,className:"gap-2 transition-all hover:scale-105",children:[r.jsx(Ct,{className:"h-4 w-4"}),"Add Pet"]})]})]})}),r.jsx(et,{children:l?r.jsx("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:Array.from({length:6}).map((b,O)=>r.jsxs(De,{className:"p-4 space-y-3",children:[r.jsx(ye,{className:"h-5 w-40"}),r.jsx(ye,{className:"h-4 w-24"}),r.jsx(ye,{className:"h-32 w-full rounded-md"}),r.jsxs("div",{className:"flex gap-2 pt-2",children:[r.jsx(ye,{className:"h-9 w-16"}),r.jsx(ye,{className:"h-9 w-16"}),r.jsx(ye,{className:"h-9 w-16"})]})]},O))}):d?r.jsxs(Ht,{variant:"destructive",children:[r.jsx(Be,{className:"h-4 w-4"}),r.jsx(Wt,{children:"Failed to load pets. Please try again."})]}):n&&n.length>0?r.jsx("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:n.map(b=>r.jsxs(De,{className:"overflow-hidden transition-all duration-200 hover:shadow-lg hover:scale-[1.02] border-primary/10",children:[r.jsxs(rt,{className:"pb-3",children:[r.jsxs("div",{className:"flex items-start justify-between gap-2",children:[r.jsxs(tt,{className:"text-lg truncate flex items-center gap-2",children:[r.jsx(ge,{className:"h-4 w-4 text-primary flex-shrink-0"}),b.name]}),r.jsxs("div",{className:"flex flex-col gap-1.5 items-end",children:[b.missing&&r.jsxs(at,{variant:"destructive",className:"gap-1 animate-pulse",children:[r.jsx(ot,{className:"h-3 w-3"}),"Missing"]}),r.jsx(at,{variant:"secondary",className:"capitalize text-xs",children:b.species})]})]}),r.jsx(st,{className:"line-clamp-2 text-sm",children:b.breed||b.description||"No description"})]}),b.photo_url&&r.jsx("div",{className:"px-4 pb-3",children:r.jsx("img",{src:b.photo_url,alt:`${b.name} photo`,className:"w-full h-40 rounded-lg object-cover ring-1 ring-primary/10",loading:"lazy"})}),r.jsxs(et,{className:"space-y-3 pt-3 border-t",children:[r.jsxs("div",{className:"flex flex-wrap gap-2",children:[r.jsxs(G,{size:"sm",onClick:()=>f(b),className:"gap-1.5 flex-1 transition-all hover:scale-105",children:[r.jsx(Ys,{className:"h-3.5 w-3.5"}),"Edit"]}),r.jsxs(G,{size:"sm",variant:"outline",onClick:()=>W(b),className:"gap-1.5 flex-1 transition-all hover:scale-105",children:[r.jsx(Is,{className:"h-3.5 w-3.5"}),"View"]}),r.jsxs(G,{size:"sm",variant:b.qr_url?"outline":"secondary",onClick:()=>h(b),className:"gap-1.5 flex-1 transition-all hover:scale-105",title:b.qr_url?"View QR":"Generate QR",children:[r.jsx(Jt,{className:"h-3.5 w-3.5"}),b.qr_url?"QR":"Create"]})]}),r.jsxs("div",{className:"flex items-center justify-between pt-2 border-t",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(Z,{htmlFor:`missing-${b.id}`,className:"text-sm font-medium cursor-pointer",children:"Mark Missing"}),r.jsx(gs,{id:`missing-${b.id}`,checked:!!b.missing,disabled:S||C.isPending,onCheckedChange:O=>M(b,O)})]}),r.jsxs(G,{size:"sm",variant:"ghost",onClick:()=>v(b),className:"gap-1.5 text-destructive hover:text-destructive hover:bg-destructive/10",children:[r.jsx(zt,{className:"h-3.5 w-3.5"}),"Delete"]})]})]})]},b.id))}):r.jsxs("div",{className:"text-center py-12 space-y-4",children:[r.jsx("div",{className:"flex justify-center",children:r.jsx("div",{className:"h-20 w-20 bg-primary/10 rounded-full flex items-center justify-center",children:r.jsx(ge,{className:"h-10 w-10 text-primary/60"})})}),r.jsxs("div",{className:"space-y-2",children:[r.jsx("p",{className:"text-lg font-medium text-foreground",children:"No pets yet"}),r.jsxs("p",{className:"text-sm text-muted-foreground",children:["Click ",r.jsx("span",{className:"font-medium text-foreground",children:"Add Pet"})," to create your first pet profile"]})]}),r.jsxs(G,{onClick:()=>u(!0),className:"gap-2 mt-4",children:[r.jsx(Ct,{className:"h-4 w-4"}),"Add Your First Pet"]})]})})]}),r.jsx(It,{mode:"add",open:i,onOpenChange:u,onSubmit:g}),p&&r.jsx(It,{mode:"edit",open:!!p,onOpenChange:b=>!b&&f(null),initialPet:{id:p.id,name:p.name,species:p.species,breed:p.breed??void 0,color:p.color??void 0,weight:p.weight??void 0,birthdate:p.birthdate??void 0,microchipId:p.microchip_id??void 0,description:p.description??void 0,notes:p.notes??void 0,vaccinations:p.vaccinations?{rabies:p.vaccinations.rabies??!1,rabiesExpires:p.vaccinations.rabiesExpires??void 0}:void 0,photoPreview:p.photo_url??void 0},onSubmit:g}),t&&r.jsx(wa,{pet:w,open:!!w,onOpenChange:b=>!b&&h(null),ownerId:t}),r.jsx(ba,{pet:y,open:!!y,onOpenChange:b=>!b&&v(null),onDeleted:I}),r.jsx(Dt,{open:!!j,onOpenChange:b=>!b&&k(null),children:r.jsxs(Ot,{children:[r.jsxs(Bt,{children:[r.jsxs(Lt,{className:"flex items-center gap-2",children:[r.jsx(ot,{className:"h-5 w-5 text-orange-500"}),"Mark ",j?.name," as missing?"]}),r.jsx(Ft,{children:"This helps highlight their profile and can trigger your outreach flow. You can turn this off later."})]}),r.jsxs($t,{children:[r.jsx(Vt,{disabled:S,children:"Cancel"}),r.jsx(Ut,{disabled:S,onClick:L,className:"gap-2",children:S?r.jsxs(r.Fragment,{children:[r.jsx(Le,{className:"h-4 w-4 animate-spin"}),"Saving…"]}):"Yes, mark missing"})]})]})})]}),r.jsx(jt,{value:"activity",className:"mt-4",children:r.jsx(aa,{days:30})})]})]})}export{Wn as default};
