const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./index-BrQ1kaVe.js","./index-j-p8NdOh.css"])))=>i.map(i=>d[i]);
import{u as L,a as R,j as e,_ as U}from"./index-BrQ1kaVe.js";import{u as j,a as g,o as _,s as l,l as I}from"./zod-8VOkz032.js";import{u as M}from"./useProfile-DutWYsrz.js";import{C as V,c as k,b as B,d as O,a as T,e as H}from"./card-srctd-FK.js";import{B as n}from"./button-D-J66a_0.js";import{L as r,I as t}from"./label-gRaS46qL.js";import{S as v}from"./separator-D7T5VoT1.js";import{A as w,a as f}from"./alert-DBB0UjR5.js";import"./useQuery-Cph-vAgB.js";import"./useMutation-_MRBwrqQ.js";import"./utils-CBfrqCZ4.js";import"./index-CZ-Y2t3-.js";const J=_({display_name:l().min(1,"Please enter your name").max(80),avatar_url:l().url("Must be a valid URL").or(I("")).optional(),phone:l().max(15,"Must be at most 15 characters").optional()}),q=_({new_password:l().min(8,"At least 8 characters")});function re(){const{user:o,signOut:y}=L(),{data:a,isLoading:b,update:i}=M(),{register:d,handleSubmit:S,reset:c,formState:{errors:s,isSubmitting:p}}=j({resolver:g(J),defaultValues:{display_name:"",avatar_url:"",phone:""}});R.useEffect(()=>{a&&c({display_name:a.display_name??"",avatar_url:a.avatar_url??"",phone:a.phone??""})},[a,c]);const{register:N,handleSubmit:P,reset:C,formState:{errors:u,isSubmitting:h}}=j({resolver:g(q),defaultValues:{new_password:""}}),A=async m=>{await i.mutateAsync(m)},E=async m=>{const{error:x}=await(await U(async()=>{const{supabase:D}=await import("./index-BrQ1kaVe.js").then(F=>F.D);return{supabase:D}},__vite__mapDeps([0,1]),import.meta.url)).supabase.auth.updateUser({password:m.new_password});if(x)throw x;C({new_password:""})};return o?e.jsx("div",{className:"mx-auto max-w-2xl space-y-6",children:e.jsxs(V,{children:[e.jsxs(k,{children:[e.jsx(B,{children:"Account"}),e.jsx(O,{children:"Manage your profile and sign-in details."})]}),e.jsxs(T,{className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(r,{children:"Email"}),e.jsx(t,{value:o.email??"",disabled:!0})]}),e.jsx(v,{}),e.jsxs("form",{onSubmit:S(A),className:"grid gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(r,{htmlFor:"display_name",children:"Display name"}),e.jsx(t,{id:"display_name",placeholder:"Jane Doe",...d("display_name")}),s.display_name&&e.jsx("p",{className:"text-sm text-destructive",children:s.display_name.message})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(r,{htmlFor:"avatar_url",children:"Avatar URL (optional)"}),e.jsx(t,{id:"avatar_url",placeholder:"https://…",...d("avatar_url")}),s.avatar_url&&e.jsx("p",{className:"text-sm text-destructive",children:s.avatar_url.message})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(r,{htmlFor:"phone",children:"Phone number (optional)"}),e.jsx(t,{id:"phone",placeholder:"+1 (555) 123-4567",...d("phone")}),s.phone&&e.jsx("p",{className:"text-sm text-destructive",children:s.phone.message})]}),i.isError&&e.jsx(w,{variant:"destructive",children:e.jsx(f,{children:String(i.error?.message??"Save failed")})}),i.isSuccess&&e.jsx(w,{children:e.jsx(f,{children:"Profile updated."})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(n,{type:"submit",disabled:p||b,children:p?"Saving…":"Save changes"}),e.jsx(n,{type:"button",variant:"outline",onClick:()=>c(),children:"Reset"})]})]}),e.jsx(v,{}),e.jsxs("form",{onSubmit:P(E),className:"grid gap-3",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(r,{htmlFor:"new_password",children:"New password"}),e.jsx(t,{id:"new_password",type:"password",placeholder:"••••••••",...N("new_password")}),u.new_password&&e.jsx("p",{className:"text-sm text-destructive",children:u.new_password.message})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(n,{type:"submit",disabled:h,children:h?"Updating…":"Update password"})})]})]}),e.jsxs(H,{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Signed in as ",e.jsx("span",{className:"text-foreground",children:o.email})]}),e.jsx(n,{variant:"ghost",onClick:()=>y(),children:"Sign out"})]})]})}):null}export{re as default};
