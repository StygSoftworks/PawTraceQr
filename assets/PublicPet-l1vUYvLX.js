import{r as B,s as O,c as R,j as e,e as G,L as K}from"./index-i6Cfs9b8.js";import{u as z}from"./useQuery-Ck6fs015.js";import{C as $,c as L,b as A,d as J,a as F}from"./card-unPYtR4G.js";import{B as k}from"./badge-m7swUxc1.js";import{B as C}from"./button-DznmDcQc.js";import{S as w}from"./skeleton-BoZHgm24.js";import{f as U,b as V,c as W,a as X,D as Y}from"./dialog-D2VYGaGF.js";import{A as S,a as P}from"./alert-DoYMIvgh.js";import{E as Z}from"./eye-CHdoF7ZJ.js";import{a as ee,H as se}from"./Header-C3DubVos.js";import{T as M}from"./index-C2WDhPQ5.js";import{P as T}from"./paw-print-CBF8-Vpr.js";import{H as ae,M as te}from"./map-pin-BQby6Diw.js";import{I as re}from"./info-DsgXzl7C.js";import{c as Q}from"./createLucideIcon-SwlWEdXL.js";import{M as I}from"./mail-aLymrlbF.js";import"./index-wAbuRW6N.js";import"./index-BhfT22v6.js";import"./index-xf7y12yH.js";import"./index-BPUJsWnk.js";import"./x-DZShrR8Q.js";import"./useProfile-CsGlyru3.js";import"./useMutation-7PdUdc88.js";import"./Logo-Co8baU9D.js";import"./log-in-P3yzbG8t.js";import"./user-plus-CNTHYpDA.js";import"./credit-card-C9Soc_0X.js";/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],ie=Q("clock",le);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],E=Q("phone",ne);function ce({shortId:s,askGeo:a=!0}){return B.useEffect(()=>{if(!s)return;let n=!1;return(async()=>{try{let i={};if(a&&"geolocation"in navigator)try{const r=await new Promise((c,l)=>navigator.geolocation.getCurrentPosition(c,l,{timeout:3e3}));i={lat:r.coords.latitude,lng:r.coords.longitude}}catch{}if(n)return;await O.rpc("log_scan",{p_short_id:s,p_referrer:document.referrer||null,p_ua:navigator.userAgent,p_city:null,p_region:null,p_country:null,p_lat:i.lat??null,p_lng:i.lng??null})}catch(i){console.warn("log_scan failed:",i)}})(),()=>{n=!0}},[s,a]),null}function oe(s){const a=R.c(17),{petId:n,days:p,label:i}=s,r=p===void 0?30:p,c=i===void 0?"Scans":i;let l,t;a[0]!==r||a[1]!==n?(l=["pet_scan_count",n,r],t=()=>U(n,r),a[0]=r,a[1]=n,a[2]=l,a[3]=t):(l=a[2],t=a[3]);const f=!!n;let u;a[4]!==l||a[5]!==t||a[6]!==f?(u={queryKey:l,queryFn:t,staleTime:3e4,enabled:f},a[4]=l,a[5]=t,a[6]=f,a[7]=u):u=a[7];const{data:h,isLoading:j,isError:N}=z(u);if(!n)return null;let d;a[8]===Symbol.for("react.memo_cache_sentinel")?(d=e.jsx("div",{className:"h-10 w-10 bg-primary/10 rounded-lg flex items-center justify-center",children:e.jsx(Z,{className:"h-5 w-5 text-primary"})}),a[8]=d):d=a[8];let m;a[9]!==r||a[10]!==c?(m=e.jsxs("p",{className:"text-sm font-medium",children:[c," (Last ",r," days)"]}),a[9]=r,a[10]=c,a[11]=m):m=a[11];const g=j?"Loading...":N?"â€”":`${h} view${h===1?"":"s"}`;let o;a[12]!==g?(o=e.jsx("p",{className:"text-sm text-muted-foreground",children:g}),a[12]=g,a[13]=o):o=a[13];let x;return a[14]!==o||a[15]!==m?(x=e.jsxs("div",{className:"flex items-center gap-3",children:[d,e.jsxs("div",{children:[m,o]})]}),a[14]=o,a[15]=m,a[16]=x):x=a[16],x}function q(s){if(!s)return"";const a=new Date(s).getTime(),n=Date.now();if(isNaN(a)||n<=a)return"just now";const p=n-a,i=Math.floor(p/(1e3*60)),r=Math.floor(i/60),c=Math.floor(r/24);if(c>0){const l=r%24;return`${c} day${c>1?"s":""}${l?`, ${l} hour${l>1?"s":""}`:""}`}if(r>0){const l=i%60;return`${r} hour${r>1?"s":""}${l?`, ${l} min`:""}`}return`${i} min`}function Fe(){const s=R.c(33),{id:a}=G(),[n,p]=B.useState(!1);let i;s[0]!==a?(i=["public-pet",a],s[0]=a,s[1]=i):i=s[1];const r=!!a;let c;s[2]!==a?(c=async()=>{const{data:H,error:D}=await O.from("public_pets").select("*").eq("short_id",a).maybeSingle();if(D)throw D;return console.log(H),H},s[2]=a,s[3]=c):c=s[3];let l;s[4]!==i||s[5]!==r||s[6]!==c?(l={queryKey:i,enabled:r,queryFn:c,staleTime:6e4},s[4]=i,s[5]=r,s[6]=c,s[7]=l):l=s[7];const{data:t,isLoading:f,isError:u}=z(l);let h;s[8]!==a?(h=e.jsx(ce,{shortId:a,askGeo:!0}),s[8]=a,s[9]=h):h=s[9];let j,N;s[10]===Symbol.for("react.memo_cache_sentinel")?(j=e.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[e.jsx("div",{className:"absolute -top-40 -right-40 w-80 h-80 bg-brand-rose/25 rounded-full blur-3xl"}),e.jsx("div",{className:"absolute -bottom-40 -left-40 w-80 h-80 bg-brand-lavender/25 rounded-full blur-3xl"}),e.jsx("div",{className:"absolute top-1/3 right-1/3 w-96 h-96 bg-brand-peach/15 rounded-full blur-3xl"})]}),N=e.jsx(se,{}),s[10]=j,s[11]=N):(j=s[10],N=s[11]);let d;s[12]!==t||s[13]!==u||s[14]!==f?(d=e.jsx("main",{className:"relative mx-auto max-w-5xl px-4 sm:px-6 py-8 md:py-12",children:f?e.jsx($,{className:"overflow-hidden shadow-xl",children:e.jsxs("div",{className:"grid gap-6 p-6 lg:grid-cols-[400px,1fr]",children:[e.jsx(w,{className:"h-96 w-full rounded-lg"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(w,{className:"h-8 w-48"}),e.jsx(w,{className:"h-6 w-64"}),e.jsx(w,{className:"h-4 w-full"}),e.jsx(w,{className:"h-4 w-full"}),e.jsx(w,{className:"h-24 w-full"})]})]})}):u||!t?e.jsxs($,{className:"shadow-xl",children:[e.jsx(L,{className:"space-y-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-12 w-12 bg-destructive/10 rounded-xl flex items-center justify-center",children:e.jsx(M,{className:"h-6 w-6 text-destructive"})}),e.jsxs("div",{children:[e.jsx(A,{className:"text-2xl",children:"Pet Not Found"}),e.jsx(J,{className:"text-base",children:"This QR code may be invalid or the pet profile is no longer available"})]})]})}),e.jsx(F,{children:e.jsx(C,{asChild:!0,className:"gap-2",children:e.jsxs(K,{to:"/",children:[e.jsx(ee,{className:"h-4 w-4"}),"Go to Homepage"]})})})]}):e.jsxs("div",{className:"space-y-6",children:[t.missing&&e.jsxs(S,{variant:"destructive",className:"animate-in fade-in-50 slide-in-from-top-2 duration-300",children:[e.jsx(M,{className:"h-5 w-5"}),e.jsxs(P,{className:"text-base font-medium",children:[e.jsx("span",{className:"block mb-1",children:"ðŸš¨ This pet is currently MISSING!"}),t.missing_since&&e.jsxs("span",{className:"text-sm opacity-90",children:["Missing for ",q(t.missing_since)]})]})]}),e.jsxs($,{className:"overflow-hidden shadow-xl border-primary/10",children:[e.jsx(L,{className:"space-y-4 bg-gradient-to-r from-orange-50/80 to-amber-50/80 dark:bg-slate-900/50",children:e.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-start sm:justify-between",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-10 w-10 bg-primary/10 rounded-xl flex items-center justify-center ring-4 ring-primary/5",children:e.jsx(T,{className:"h-5 w-5 text-primary"})}),e.jsx(A,{className:"text-3xl tracking-tight",children:t.name})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(k,{variant:"secondary",className:"capitalize text-sm px-3 py-1",children:[t.species==="dog"?"ðŸ•":t.species==="cat"?"ðŸ±":"ðŸ¾"," ",t.species]}),t.breed&&e.jsx(k,{variant:"outline",className:"text-sm px-3 py-1",children:t.breed}),t.color&&e.jsx(k,{variant:"outline",className:"text-sm px-3 py-1",children:t.color})]})]}),e.jsx(k,{variant:t.missing?"destructive":"default",className:`text-sm px-4 py-2 gap-2 ${t.missing?"animate-pulse":""}`,children:t.missing?e.jsxs(e.Fragment,{children:[e.jsx(M,{className:"h-4 w-4"}),"Missing"]}):e.jsxs(e.Fragment,{children:[e.jsx(ae,{className:"h-4 w-4"}),"Safe at Home"]})})]})}),e.jsxs(F,{className:"grid gap-8 p-6 lg:grid-cols-[1fr,400px]",children:[e.jsxs("div",{className:"space-y-6 order-2 lg:order-1",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-lg font-semibold",children:[e.jsx(re,{className:"h-5 w-5 text-primary"}),"About ",t.name]}),e.jsx("p",{className:"text-muted-foreground leading-relaxed",children:t.description||"No additional description provided."})]}),(t.owner_email||t.owner_phone)&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-lg font-semibold",children:[e.jsx(E,{className:"h-5 w-5 text-primary"}),"Contact Owner"]}),e.jsx(S,{className:"border-blue-200 bg-blue-50 dark:border-blue-900 dark:bg-blue-950",children:e.jsx(P,{className:"text-blue-800 dark:text-blue-200",children:"If you've found this pet, please contact the owner using the information below"})}),e.jsxs("div",{className:"space-y-3 pl-4 border-l-2 border-primary/20",children:[t.owner_phone&&e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-10 w-10 bg-primary/10 rounded-lg flex items-center justify-center",children:e.jsx(E,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Phone"}),e.jsx("a",{href:`tel:${t.owner_phone}`,className:"text-primary hover:underline font-medium",children:t.owner_phone})]})]}),t.owner_email&&e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-10 w-10 bg-primary/10 rounded-lg flex items-center justify-center",children:e.jsx(I,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Email"}),e.jsx("a",{href:`mailto:${t.owner_email}`,className:"text-primary hover:underline font-medium",children:t.owner_email})]})]}),t.missing&&e.jsxs("div",{className:"flex items-center gap-3 pt-2",children:[e.jsx("div",{className:"h-10 w-10 bg-orange-100 dark:bg-orange-950 rounded-lg flex items-center justify-center",children:e.jsx(ie,{className:"h-5 w-5 text-orange-600 dark:text-orange-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Last Seen"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:t.missing_since?q(t.missing_since)+" ago":"Recently"})]})]}),e.jsx(oe,{petId:t.id,days:30,label:"QR Code Scans"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 pt-2",children:[t.owner_phone&&e.jsx(C,{asChild:!0,className:"flex-1 gap-2",variant:"success",children:e.jsxs("a",{href:`tel:${t.owner_phone}`,children:[e.jsx(E,{className:"h-4 w-4"}),"Call Owner"]})}),t.owner_email&&e.jsx(C,{asChild:!0,variant:"outline",className:"flex-1 gap-2",children:e.jsxs("a",{href:`mailto:${t.owner_email}`,children:[e.jsx(I,{className:"h-4 w-4"}),"Send Email"]})})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-lg font-semibold",children:[e.jsx(te,{className:"h-5 w-5 text-primary"}),"Found This Pet?"]}),e.jsx(S,{children:e.jsx(P,{className:"space-y-2",children:e.jsx("p",{className:"text-sm",children:"Please share your location with the owner when you contact them. This helps reunite pets faster!"})})})]})]}),e.jsx("div",{className:"space-y-4 order-1 lg:order-2",children:t.photo_url?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:()=>p(!0),className:"group relative w-full overflow-hidden rounded-xl border-2 border-primary/10 ring-4 ring-primary/5 transition-all hover:scale-[1.02] hover:shadow-lg cursor-pointer",children:[e.jsx("img",{src:t.photo_url,alt:`${t.name}`,className:"w-full h-auto max-h-[600px] object-contain bg-white"}),e.jsx("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/10 transition-colors flex items-center justify-center",children:e.jsx("span",{className:"text-white opacity-0 group-hover:opacity-100 transition-opacity bg-black/70 px-4 py-2 rounded-lg text-sm",children:"Click to enlarge"})})]}),e.jsx("p",{className:"text-xs text-center text-muted-foreground",children:"Click image to view full size"})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center h-96 rounded-xl border-2 border-dashed border-primary/20 bg-slate-50 dark:bg-slate-900",children:[e.jsx(T,{className:"h-16 w-16 text-primary/30 mb-3"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"No photo provided"})]})})]})]})]})}),s[12]=t,s[13]=u,s[14]=f,s[15]=d):d=s[15];let m;s[16]===Symbol.for("react.memo_cache_sentinel")?(m=e.jsx(T,{className:"h-5 w-5"}),s[16]=m):m=s[16];const g=t?.name;let o;s[17]!==g?(o=e.jsx(V,{className:"p-6 pb-0",children:e.jsxs(W,{className:"flex items-center gap-2",children:[m,g,"'s Photo"]})}),s[17]=g,s[18]=o):o=s[18];let x;s[19]!==t?(x=t?.photo_url&&e.jsx("div",{className:"p-6 pt-4 overflow-auto",children:e.jsx("img",{src:t.photo_url,alt:`${t.name} full size`,className:"w-full h-auto rounded-lg"})}),s[19]=t,s[20]=x):x=s[20];let y;s[21]!==o||s[22]!==x?(y=e.jsxs(X,{className:"max-w-4xl max-h-[90vh] p-0 bg-white dark:bg-slate-900",children:[o,x]}),s[21]=o,s[22]=x,s[23]=y):y=s[23];let b;s[24]!==n||s[25]!==y?(b=e.jsx(Y,{open:n,onOpenChange:p,children:y}),s[24]=n,s[25]=y,s[26]=b):b=s[26];let v;s[27]!==b||s[28]!==d?(v=e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-orange-50 via-pink-50 to-purple-50 dark:from-slate-950 dark:via-purple-950/20 dark:to-slate-900",children:[j,N,d,b]}),s[27]=b,s[28]=d,s[29]=v):v=s[29];let _;return s[30]!==v||s[31]!==h?(_=e.jsxs(e.Fragment,{children:[h,v]}),s[30]=v,s[31]=h,s[32]=_):_=s[32],_}export{Fe as default};
