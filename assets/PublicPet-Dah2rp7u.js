import{c as y,p as $,j as e,s as _,L as C}from"./index-DU0PUxJ_.js";import{u as k}from"./useQuery-BWCBevts.js";import{C as f,a as p,b as g,c as N,d as b}from"./card-CkPsRPVM.js";import{S as o,B as d}from"./skeleton-Dco-AQqM.js";import{B as v}from"./button-zycxiWQ6.js";function M(s){if(!s)return"";const a=new Date(s).getTime(),l=Date.now();if(isNaN(a)||l<=a)return"just now";const c=l-a,i=Math.floor(c/(1e3*60)),t=Math.floor(i/60),r=Math.floor(t/24);if(r>0){const n=t%24;return`${r} day${r>1?"s":""}${n?`, ${n} hour${n>1?"s":""}`:""}`}if(t>0){const n=i%60;return`${t} hour${t>1?"s":""}${n?`, ${n} min`:""}`}return`${i} min`}function q(){const s=y.c(14),{id:a}=$();let l;s[0]!==a?(l=["public-pet",a],s[0]=a,s[1]=l):l=s[1];const c=!!a;let i;s[2]!==a?(i=async()=>{const{data:w,error:j}=await _.from("public_pets").select("*").eq("id",a).maybeSingle();if(j)throw j;return w},s[2]=a,s[3]=i):i=s[3];let t;s[4]!==l||s[5]!==c||s[6]!==i?(t={queryKey:l,enabled:c,queryFn:i,staleTime:6e4},s[4]=l,s[5]=c,s[6]=i,s[7]=t):t=s[7];const{data:r,isLoading:n,isError:u}=k(t);let m;s[8]===Symbol.for("react.memo_cache_sentinel")?(m=e.jsx(C,{to:"/",className:"font-semibold",children:"PawTrace"}),s[8]=m):m=s[8];let x;s[9]===Symbol.for("react.memo_cache_sentinel")?(x=e.jsx("header",{className:"sticky top-0 z-30 border-b bg-background/70 backdrop-blur",children:e.jsxs("div",{className:"mx-auto flex h-14 max-w-4xl items-center justify-between px-4",children:[m,e.jsx(v,{asChild:!0,variant:"outline",size:"sm",children:e.jsx("a",{href:"/",children:"Home"})})]})}),s[9]=x):x=s[9];let h;return s[10]!==r||s[11]!==u||s[12]!==n?(h=e.jsxs("div",{className:"min-h-svh bg-background text-foreground",children:[x,e.jsx("main",{className:"mx-auto max-w-4xl p-4 md:p-6",children:n?e.jsx(f,{className:"overflow-hidden",children:e.jsxs("div",{className:"grid gap-4 p-4 md:grid-cols-[240px,1fr]",children:[e.jsx(o,{className:"h-48 w-full"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(o,{className:"h-6 w-40"}),e.jsx(o,{className:"h-4 w-56"}),e.jsx(o,{className:"h-4 w-48"}),e.jsx(o,{className:"h-4 w-72"})]})]})}):u||!r?e.jsxs(f,{children:[e.jsxs(p,{children:[e.jsx(g,{children:"Pet not found"}),e.jsx(N,{children:"The QR link is invalid or this pet is no longer available."})]}),e.jsx(b,{children:e.jsx(v,{asChild:!0,children:e.jsx("a",{href:"/",children:"Go to homepage"})})})]}):e.jsxs(f,{className:"overflow-hidden",children:[e.jsxs(p,{className:"flex flex-col gap-2 md:flex-row md:items-center md:justify-between",children:[e.jsxs(g,{className:"flex items-center gap-3",children:[e.jsx("span",{className:"truncate",children:r.name}),r.missing?e.jsx(d,{variant:"destructive",children:"Missing"}):e.jsx(d,{variant:"success",children:"Not Missing"})]}),e.jsxs(N,{className:"flex flex-wrap items-center gap-2",children:[e.jsx(d,{variant:"secondary",className:"capitalize",children:r.species}),r.breed&&e.jsx(d,{variant:"outline",children:r.breed}),r.color&&e.jsx(d,{variant:"outline",children:r.color}),r.missing&&r.missing_since&&e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Missing for ",M(r.missing_since)]})]})]}),e.jsxs(b,{className:"grid gap-4 md:grid-cols-[280px,1fr]",children:[r.photo_url?e.jsx("img",{src:r.photo_url,alt:`${r.name} photo`,className:"h-64 w-full rounded-md object-cover border bg-white",loading:"lazy"}):e.jsx("div",{className:"flex h-64 w-full items-center justify-center rounded-md border text-sm text-muted-foreground",children:"No photo provided"}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium",children:"About"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:r.description||"No description provided."})]})})]})]})})]}),s[10]=r,s[11]=u,s[12]=n,s[13]=h):h=s[13],h}export{q as default};
