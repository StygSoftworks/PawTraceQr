const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./index-CyRwK8zl.js","./index-fTncB_v3.css"])))=>i.map(i=>d[i]);
import{u as L,r as R,j as e,_ as U}from"./index-CyRwK8zl.js";import{u as j,a as f,o as y,b as g,s as o,l as I}from"./zod-BTI3yIs7.js";import{u as M}from"./useProfile-Bqara-UN.js";import{C as V,c as B,b as O,d as T,a as H,e as J}from"./card-CCAJ_q2W.js";import{B as l}from"./button-B-1CPjV4.js";import{L as a,I as i}from"./input-BtlkgNXk.js";import{S as _}from"./separator-CjyRgRRA.js";import{A as v,a as w}from"./alert-DJx_XrQi.js";import"./useQuery-XJKUzcE2.js";import"./useMutation-CDUD3ZYd.js";import"./utils-CBfrqCZ4.js";import"./index-BWrJMVUx.js";const q=y({display_name:o().min(1,"Please enter your name").max(80),avatar_url:o().url("Must be a valid URL").or(I("")).optional(),phone:o().max(15,"Must be at most 15 characters").optional(),share_email:g().optional(),share_phone:g().optional()}),z=y({new_password:o().min(8,"At least 8 characters")});function te(){const{user:d,signOut:b}=L(),{data:s,isLoading:N,update:n}=M(),{register:t,handleSubmit:S,reset:c,formState:{errors:r,isSubmitting:p}}=j({resolver:f(q),defaultValues:{display_name:"",avatar_url:"",phone:""}});R.useEffect(()=>{s&&c({display_name:s.display_name??"",avatar_url:s.avatar_url??"",phone:s.phone??"",share_email:s.share_email??!1,share_phone:s.share_phone??!1})},[s,c]);const{register:P,handleSubmit:C,reset:A,formState:{errors:h,isSubmitting:x}}=j({resolver:f(z),defaultValues:{new_password:""}}),E=async m=>{await n.mutateAsync(m)},F=async m=>{const{error:u}=await(await U(async()=>{const{supabase:k}=await import("./index-CyRwK8zl.js").then(D=>D.D);return{supabase:k}},__vite__mapDeps([0,1]),import.meta.url)).supabase.auth.updateUser({password:m.new_password});if(u)throw u;A({new_password:""})};return d?e.jsx("div",{className:"mx-auto max-w-2xl space-y-6",children:e.jsxs(V,{children:[e.jsxs(B,{children:[e.jsx(O,{children:"Account"}),e.jsx(T,{children:"Manage your profile and sign-in details."})]}),e.jsxs(H,{className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(a,{children:"Email"}),e.jsx(i,{value:d.email??"",disabled:!0})]}),e.jsx(_,{}),e.jsxs("form",{onSubmit:S(E),className:"grid gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(a,{htmlFor:"display_name",children:"Display name"}),e.jsx(i,{id:"display_name",placeholder:"Jane Doe",...t("display_name")}),r.display_name&&e.jsx("p",{className:"text-sm text-destructive",children:r.display_name.message})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(a,{htmlFor:"avatar_url",children:"Avatar URL (optional)"}),e.jsx(i,{id:"avatar_url",placeholder:"https://…",...t("avatar_url")}),r.avatar_url&&e.jsx("p",{className:"text-sm text-destructive",children:r.avatar_url.message})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(a,{htmlFor:"phone",children:"Phone number (optional)"}),e.jsx(i,{id:"phone",placeholder:"+1 (555) 123-4567",...t("phone")}),r.phone&&e.jsx("p",{className:"text-sm text-destructive",children:r.phone.message})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(a,{children:"Sharing preferences"}),e.jsxs("div",{className:"flex flex-col space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",...t("share_email"),id:"share_email",className:"h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary",defaultChecked:s?.share_email??!1}),e.jsx(a,{htmlFor:"share_email",className:"select-none",children:"Share my email with pet finders"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",...t("share_phone"),id:"share_phone",className:"h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary",defaultChecked:s?.share_phone??!1}),e.jsx(a,{htmlFor:"share_phone",className:"select-none",children:"Share my phone number with pet finders"})]})]})]}),n.isError&&e.jsx(v,{variant:"destructive",children:e.jsx(w,{children:String(n.error?.message??"Save failed")})}),n.isSuccess&&e.jsx(v,{children:e.jsx(w,{children:"Profile updated."})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(l,{type:"submit",disabled:p||N,children:p?"Saving…":"Save changes"}),e.jsx(l,{type:"button",variant:"outline",onClick:()=>c(),children:"Reset"})]})]}),e.jsx(_,{}),e.jsxs("form",{onSubmit:C(F),className:"grid gap-3",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(a,{htmlFor:"new_password",children:"New password"}),e.jsx(i,{id:"new_password",type:"password",placeholder:"••••••••",...P("new_password")}),h.new_password&&e.jsx("p",{className:"text-sm text-destructive",children:h.new_password.message})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(l,{type:"submit",disabled:x,children:x?"Updating…":"Update password"})})]})]}),e.jsxs(J,{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Signed in as ",e.jsx("span",{className:"text-foreground",children:d.email})]}),e.jsx(l,{variant:"ghost",onClick:()=>b(),children:"Sign out"})]})]})}):null}export{te as default};
