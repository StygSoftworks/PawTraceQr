import{c as ne,r as L,j as t,s as Z}from"./index-DAmRCMs6.js";import{a as G,C as E,c as D,b as V,d as Y}from"./card-AO9X5G_u.js";import{B as $}from"./button-CMJiYzf3.js";import{B as re}from"./badge-63Tbt0xk.js";import{c as ee}from"./createLucideIcon-DZjPpD2b.js";import{C as ce}from"./credit-card-BcEvF0WB.js";import"./utils-CBfrqCZ4.js";/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oe=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],de=ee("circle-check-big",oe);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],xe=ee("loader-circle",me);function Se(){const e=ne.c(42),[d,I]=L.useState(!0);let m;e[0]===Symbol.for("react.memo_cache_sentinel")?(m=[],e[0]=m):m=e[0];const[a,R]=L.useState(m),[te,se]=L.useState(null),J="https://www.sandbox.paypal.com/webapps/billing/plans/subscribe?plan_id=P-01B964946R701620HNDPMUVA",K="https://www.sandbox.paypal.com/webapps/billing/plans/subscribe?plan_id=P-4V1531673F796000SNDPMUVA",O="https://www.sandbox.paypal.com/webapps/billing/plans/subscribe?plan_id=P-99N7761092897711MNDPMUVA",Q="https://www.sandbox.paypal.com/webapps/billing/plans/subscribe?plan_id=P-0H956331A3859781YNDPMUVI";let x,h;e[1]===Symbol.for("react.memo_cache_sentinel")?(x=()=>{let s=!0;const l=async function(){I(!0);const{data:ae}=await Z.auth.getUser(),F=ae.user?.id??null;if(!s)return;if(se(F),!F){R([]),I(!1);return}const{data:ie,error:X}=await Z.from("subscriptions").select("*").eq("user_id",F).order("created_at",{ascending:!1});s&&(X?(console.error("load subscriptions error:",X),R([])):R(ie??[]),I(!1))};l();const W=()=>document.visibilityState==="visible"&&l();return document.addEventListener("visibilitychange",W),()=>{s=!1,document.removeEventListener("visibilitychange",W)}},h=[],e[1]=x,e[2]=h):(x=e[1],h=e[2]),L.useEffect(x,h);let i,u;if(e[3]!==a){const s=a.filter(pe);i=s.some(fe),u=s.filter(ue),e[3]=a,e[4]=i,e[5]=u}else i=e[4],u=e[5];const f=u.length,H=(i?3:0)+f;let p;e[6]!==f||e[7]!==i||e[8]!==H?(p={baseActive:i,addonActiveCount:f,petLimit:H},e[6]=f,e[7]=i,e[8]=H,e[9]=p):p=e[9];const{baseActive:le,addonActiveCount:T,petLimit:q}=p;if(d){let s;e[10]===Symbol.for("react.memo_cache_sentinel")?(s=t.jsx("h1",{className:"text-3xl md:text-4xl font-bold mb-8 tracking-tight",children:"Billing & Subscription"}),e[10]=s):s=e[10];let l;return e[11]===Symbol.for("react.memo_cache_sentinel")?(l=t.jsxs("div",{className:"container mx-auto px-4 sm:px-6 py-10 md:py-14 max-w-3xl",children:[s,t.jsx("div",{className:"flex justify-center items-center py-12",children:t.jsx(xe,{className:"animate-spin h-8 w-8 text-primary"})})]}),e[11]=l):l=e[11],l}if(!te){let s;e[12]===Symbol.for("react.memo_cache_sentinel")?(s=t.jsx("h1",{className:"text-3xl md:text-4xl font-bold mb-8 tracking-tight",children:"Billing & Subscription"}),e[12]=s):s=e[12];let l;return e[13]===Symbol.for("react.memo_cache_sentinel")?(l=t.jsxs("div",{className:"container mx-auto px-4 sm:px-6 py-10 md:py-14 max-w-3xl",children:[s,t.jsx(E,{className:"mb-8",children:t.jsxs(D,{children:[t.jsx(V,{children:"Sign in required"}),t.jsx(Y,{children:"Please sign in to view or manage your subscription."})]})})]}),e[13]=l):l=e[13],l}let b;e[14]===Symbol.for("react.memo_cache_sentinel")?(b=t.jsx("h1",{className:"text-3xl md:text-4xl font-bold mb-8 tracking-tight",children:"Billing & Subscription"}),e[14]=b):b=e[14];let y;e[15]===Symbol.for("react.memo_cache_sentinel")?(y=t.jsx(V,{children:"Your plan summary"}),e[15]=y):y=e[15];const z=le?"Base plan active":"No base plan";let n;e[16]!==q?(n=t.jsx("span",{className:"font-medium",children:q}),e[16]=q,e[17]=n):n=e[17];let r;e[18]!==T||e[19]!==z||e[20]!==n?(r=t.jsxs(D,{children:[y,t.jsxs(Y,{children:[z," • ",T," add-on(s) • Pet limit:"," ",n]})]}),e[18]=T,e[19]=z,e[20]=n,e[21]=r):r=e[21];let c;e[22]!==a?(c=t.jsx(G,{children:a.length===0?t.jsx("div",{className:"text-sm text-muted-foreground",children:"No subscriptions on file."}):t.jsx("div",{className:"divide-y",children:a.map(he)})}),e[22]=a,e[23]=c):c=e[23];let o;e[24]!==c||e[25]!==r?(o=t.jsxs(E,{className:"mb-8",children:[r,c]}),e[24]=c,e[25]=r,e[26]=o):o=e[26];let j;e[27]===Symbol.for("react.memo_cache_sentinel")?(j=t.jsxs(D,{children:[t.jsx(V,{children:"PawTrace Base"}),t.jsx(Y,{children:"Up to 3 pets included"})]}),e[27]=j):j=e[27];let _;e[28]===Symbol.for("react.memo_cache_sentinel")?(_=t.jsx("div",{className:"text-2xl font-bold",children:"$3 / mo"}),e[28]=_):_=e[28];let g,N,v;e[29]===Symbol.for("react.memo_cache_sentinel")?(g=t.jsx($,{asChild:!0,className:"w-full",disabled:!J,children:t.jsx("a",{href:J,target:"_blank",rel:"noreferrer",children:"Subscribe Monthly (PayPal)"})}),N=t.jsx("div",{className:"text-sm text-muted-foreground",children:"or"}),v=t.jsx("div",{className:"text-2xl font-bold",children:"$30 / yr"}),e[29]=g,e[30]=N,e[31]=v):(g=e[29],N=e[30],v=e[31]);let w;e[32]===Symbol.for("react.memo_cache_sentinel")?(w=t.jsxs(E,{children:[j,t.jsxs(G,{className:"space-y-3",children:[_,g,N,v,t.jsx($,{asChild:!0,variant:"outline",className:"w-full",disabled:!K,children:t.jsx("a",{href:K,target:"_blank",rel:"noreferrer",children:"Subscribe Yearly (PayPal)"})})]})]}),e[32]=w):w=e[32];let S;e[33]===Symbol.for("react.memo_cache_sentinel")?(S=t.jsxs(D,{children:[t.jsx(V,{children:"Extra Pets Add-on"}),t.jsx(Y,{children:"Each add-on adds 1 pet"})]}),e[33]=S):S=e[33];let P;e[34]===Symbol.for("react.memo_cache_sentinel")?(P=t.jsx("div",{className:"text-2xl font-bold",children:"$1.50 / mo"}),e[34]=P):P=e[34];let C,A,k;e[35]===Symbol.for("react.memo_cache_sentinel")?(C=t.jsx($,{asChild:!0,className:"w-full",disabled:!O,children:t.jsx("a",{href:O,target:"_blank",rel:"noreferrer",children:"Add Monthly (PayPal)"})}),A=t.jsx("div",{className:"text-sm text-muted-foreground",children:"or"}),k=t.jsx("div",{className:"text-2xl font-bold",children:"$18 / yr"}),e[35]=C,e[36]=A,e[37]=k):(C=e[35],A=e[36],k=e[37]);let B,M;e[38]===Symbol.for("react.memo_cache_sentinel")?(B=t.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[w,t.jsxs(E,{children:[S,t.jsxs(G,{className:"space-y-3",children:[P,C,A,k,t.jsx($,{asChild:!0,variant:"outline",className:"w-full",disabled:!Q,children:t.jsx("a",{href:Q,target:"_blank",rel:"noreferrer",children:"Add Yearly (PayPal)"})})]})]})]}),M=t.jsx("p",{className:"mt-6 text-xs text-muted-foreground",children:"Payments are handled by PayPal. After subscribing, it can take a moment for your subscription to appear here."}),e[38]=B,e[39]=M):(B=e[38],M=e[39]);let U;return e[40]!==o?(U=t.jsxs("div",{className:"container mx-auto px-4 sm:px-6 py-10 md:py-14 max-w-3xl",children:[b,o,B,M]}),e[40]=o,e[41]=U):U=e[41],U}function he(e){const d=e.current_period_end?new Date(e.current_period_end).toLocaleDateString():null;return t.jsxs("div",{className:"flex justify-between items-center py-3",children:[t.jsxs("div",{children:[t.jsx("div",{className:"font-medium",children:e.type==="addon"?"Extra Pets Add-on":"PawTrace Base"}),t.jsxs("div",{className:"text-xs text-muted-foreground",children:["Status: ",t.jsx(re,{variant:"outline",className:"uppercase",children:e.status})," ",d&&t.jsxs(t.Fragment,{children:["• Renews: ",d]})]}),e.plan_id&&t.jsxs("div",{className:"text-xs text-muted-foreground",children:["Plan ID: ",t.jsx("span",{className:"font-mono",children:e.plan_id})]})]}),e.status==="active"?t.jsx(de,{className:"h-5 w-5 text-green-500"}):t.jsx(ce,{className:"h-5 w-5 text-muted-foreground"})]},e.id)}function ue(e){return e.type==="addon"}function fe(e){return e.type==="base"}function pe(e){return e.status==="active"}export{Se as default};
