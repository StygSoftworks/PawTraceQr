import{j as e,R as Tt,T as Pt,P as Dt,C as Rt,u as re,a as Y,b as Bt,c as It,O as At,d as Mt,e as me}from"./radix-ui-Dl2NiEpv.js";import{r as c,u as Ft}from"./forms-BenlWNMe.js";import{u as Me,b as it,c as ke}from"./react-query-CCwEfxX5.js";import{c as U,u as Fe,s as A,D as ve,a as qt,T as Ot}from"./index-djmkGsBh.js";import{u as nt}from"./useProfile-qe-1GDBK.js";import{C as ie,a as ne,b as le,c as Ee,d as Z}from"./card-JrpAFQcq.js";import{B as X}from"./badge-DFlhK-kx.js";import{T as zt,a as $t,b as be,c as je}from"./tabs-B7A5xi0E.js";import{B as O}from"./button-DAfSnszG.js";import{S as Q}from"./skeleton-KooaUrEe.js";import{A as lt,a as ot,b as ct,c as dt,d as mt,e as ut,f as ht,g as pt}from"./alert-dialog-CZBChk0g.js";import{S as Lt}from"./switch-CsGjy4_N.js";import{L as $,I as K}from"./input-Di22cJqv.js";import{A as Te,a as Pe}from"./alert-Dydcjefr.js";import{l as Wt}from"./analytics-CiE2No0t.js";import{T as Ut,a as Vt,b as ft,c as We,d as Kt,e as Ue,Q as Qt}from"./QRCodeDialog-trzbByvq.js";import"./opentype-CPIVssqb.js";import{T as De,R as xt,b as gt,M as ye,c as Gt,d as Ht,P as Yt,E as Xt,e as vt,A as Jt,S as Zt,U as es,I as ts,X as ss,f as J,g as Re,h as pe,i as as,j as rs,k as Ve,W as is,F as ns,H as ls,l as os,m as cs,n as ds,o as we,p as Ke,q as ms,r as us,s as hs,Q as ps}from"./icons-1Q_-oHEE.js";import{f as fs}from"./date-fns-CSQe5d3I.js";import{a as xs,o as Qe,_ as Ge,s as V,u as gs,b as vs,n as bs,c as js,d as ys}from"./zod-B4P2RwCa.js";import{D as ws,a as Ns,b as Ss,c as Cs,d as _s,e as ks}from"./dialog-BnEVA_8F.js";import{T as Es}from"./textarea-6d64kz5D.js";import{S as He,a as Ye,b as Xe,c as Je,d as te}from"./select-DJ4plmKP.js";import{c as G}from"./utils-CBfrqCZ4.js";import{S as Ne}from"./separator-BVyrlf-x.js";import{g as Ts}from"./billing-X1lU7Ov_.js";import"./react-dom-CWqaeSHD.js";import"./pdf-DO90N-Wx.js";import"./supabase-Dq_AJ6PJ.js";import"./router-fBLXKt6a.js";import"./index-CdJFUDDL.js";import"./qr-CwZfYiFM.js";function Ps(s){const t=U.c(18),{days:a}=s,r=a===void 0?14:a,{user:i}=Fe(),n=i?.id??null;let u,h;t[0]!==r||t[1]!==n?(u=["scan_events",n,r],h=()=>n?Wt(n,r):Promise.resolve([]),t[0]=r,t[1]=n,t[2]=u,t[3]=h):(u=t[2],h=t[3]);const p=!!n;let d;t[4]!==u||t[5]!==h||t[6]!==p?(d={queryKey:u,queryFn:h,enabled:p,staleTime:3e4},t[4]=u,t[5]=h,t[6]=p,t[7]=d):d=t[7];const{data:m,isLoading:x,isError:b}=Me(d);let j;t[8]===Symbol.for("react.memo_cache_sentinel")?(j=e.jsx(ne,{children:"QR Scan Events"}),t[8]=j):j=t[8];let y;t[9]!==r?(y=e.jsxs(le,{children:[j,e.jsxs(Ee,{children:["Last ",r," days"]})]}),t[9]=r,t[10]=y):y=t[10];let w;t[11]!==m||t[12]!==b||t[13]!==x?(w=e.jsx(ie,{children:x?e.jsx("div",{className:"text-sm text-muted-foreground",children:"Loadingâ€¦"}):b?e.jsx("div",{className:"text-sm text-destructive",children:"Failed to load scans."}):m?.length?e.jsxs(Ut,{children:[e.jsx(Vt,{children:e.jsxs(ft,{children:[e.jsx(We,{children:"When"}),e.jsx(We,{children:"Pet"})]})}),e.jsx(Kt,{children:m.map(Ds)})]}):e.jsx("div",{className:"text-sm text-muted-foreground",children:"No scans yet."})}),t[11]=m,t[12]=b,t[13]=x,t[14]=w):w=t[14];let _;return t[15]!==y||t[16]!==w?(_=e.jsxs(Z,{children:[y,w]}),t[15]=y,t[16]=w,t[17]=_):_=t[17],_}function Ds(s){return e.jsxs(ft,{children:[e.jsx(Ue,{className:"whitespace-nowrap",children:new Date(s.scanned_at).toLocaleString()}),e.jsx(Ue,{className:"font-medium",children:s.pet_name})]},s.id)}async function Rs(s){const t=s.species==="dog"?"dog":"cat",{data:a,error:r}=await A.rpc("reserve_qr_code",{p_tag_type:t});if(r||!a||a.length===0)throw new Error(`No available ${t} QR codes in pool. Please contact support.`);const i=a[0];try{const{data:n,error:u}=await A.from("pets").insert({...s,qr_code_id:i.qr_id,short_id:i.qr_short_id,qr_url:i.qr_qr_url}).select("*").single();if(u)throw u;const{error:h}=await A.rpc("finalize_qr_assignment",{p_qr_id:i.qr_id,p_pet_id:n.id});return h&&console.error("Failed to finalize QR assignment:",h),n}catch(n){throw await A.rpc("release_qr_code",{p_qr_id:i.qr_id}),n}}async function Be(s,t){const{error:a}=await A.from("pets").update(t).eq("id",s);if(a)throw a;const{data:r,error:i}=await A.from("pets").select("*").eq("id",s).maybeSingle();return i?(console.warn("updatePet: select after update blocked by RLS:",i?.message),{id:s,...t}):r??{id:s,...t}}async function Bs(s){const{data:t,error:a}=await A.from("pets").select("*").eq("owner_id",s).order("created_at",{ascending:!1});if(a)throw a;return t??[]}async function Ze(s,t,a){if(!a||a.size===0)throw new Error("Empty image blob");const r=a.type||"image/webp",i=r==="image/jpeg"||r==="image/jpg"?"jpg":r==="image/png"?"png":r==="image/avif"?"avif":"webp",n=Date.now(),u=`${s}/${t}-${n}.${i}`,{error:h}=await A.storage.from("pet-photos").upload(u,a,{contentType:r,upsert:!1});if(h)throw console.error("storage.upload error:",h),h;const{data:p}=A.storage.from("pet-photos").getPublicUrl(u);return p.publicUrl}async function Is(s){const{error:t}=await A.from("pets").delete().eq("id",s);if(t)throw t}async function As(s){if(!s)return;const t=s.indexOf("/pet-photos/");if(t===-1)return;const a=s.substring(t+12);if(!a)return;const{error:r}=await A.storage.from("pet-photos").remove([a]);r&&console.warn("storage.remove warning:",r.message)}function Ms({pet:s,open:t,onOpenChange:a,onDeleted:r}){const[i,n]=c.useState(!1),u=async()=>{if(s){n(!0);try{s.photo_url&&await As(s.photo_url),await Is(s.id),r(),a(!1)}catch(h){alert(h?.message??"Failed to delete pet")}finally{n(!1)}}};return s?e.jsx(lt,{open:t,onOpenChange:a,children:e.jsxs(ot,{children:[e.jsxs(ct,{children:[e.jsxs(dt,{className:"flex items-center gap-2",children:[e.jsx(De,{className:"h-5 w-5 text-destructive"}),"Delete ",s.name,"?"]}),e.jsxs(mt,{children:["This will permanently remove the pet profile",s.photo_url?" and its photo":"",". This action cannot be undone."]})]}),e.jsxs(ut,{children:[e.jsx(ht,{disabled:i,children:"Cancel"}),e.jsx(pt,{disabled:i,onClick:u,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90 gap-2",children:i?e.jsxs(e.Fragment,{children:[e.jsx(xt,{className:"h-4 w-4 animate-spin"}),"Deletingâ€¦"]}):e.jsxs(e.Fragment,{children:[e.jsx(gt,{className:"h-4 w-4"}),"Delete"]})})]})]})}):null}function Fs(){const s=U.c(34),t=it();let a;s[0]===Symbol.for("react.memo_cache_sentinel")?(a={queryKey:["location-shares"],queryFn:Ws},s[0]=a):a=s[0];const{data:r,isLoading:i}=Me(a);let n;s[1]!==t?(n={mutationFn:Ls,onSuccess:()=>{t.invalidateQueries({queryKey:["location-shares"]})}},s[1]=t,s[2]=n):n=s[2];const u=ke(n);let h;s[3]!==t?(h={mutationFn:$s,onSuccess:()=>{t.invalidateQueries({queryKey:["location-shares"]})}},s[3]=t,s[4]=h):h=s[4];const p=ke(h),d=zs;if(i){let D;s[5]===Symbol.for("react.memo_cache_sentinel")?(D=e.jsx(le,{children:e.jsxs(ne,{className:"flex items-center gap-2",children:[e.jsx(ye,{className:"h-5 w-5"}),"Location Shares"]})}),s[5]=D):D=s[5];let T;return s[6]===Symbol.for("react.memo_cache_sentinel")?(T=e.jsxs(Z,{children:[D,e.jsxs(ie,{className:"space-y-3",children:[e.jsx(Q,{className:"h-24 w-full"}),e.jsx(Q,{className:"h-24 w-full"})]})]}),s[6]=T):T=s[6],T}let m,x,b,j,y,w;if(s[7]!==p||s[8]!==u||s[9]!==r){w=Symbol.for("react.early_return_sentinel");e:{const D=r?.filter(Os)||[],T=D.filter(qs).length;if(D.length===0){let l;s[16]===Symbol.for("react.memo_cache_sentinel")?(l=e.jsx(le,{children:e.jsxs(ne,{className:"flex items-center gap-2",children:[e.jsx(ye,{className:"h-5 w-5"}),"Location Shares"]})}),s[16]=l):l=s[16];let z;s[17]===Symbol.for("react.memo_cache_sentinel")?(z=e.jsxs(Z,{children:[l,e.jsx(ie,{children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"No location shares yet. When someone finds your pet and shares their location, it will appear here."})})]}),s[17]=z):z=s[17],w=z;break e}x=Z;let N;s[18]===Symbol.for("react.memo_cache_sentinel")?(N=e.jsx(ye,{className:"h-5 w-5"}),s[18]=N):N=s[18];let k;s[19]!==T?(k=T>0&&e.jsxs(X,{variant:"destructive",className:"ml-auto",children:[T," New"]}),s[19]=T,s[20]=k):k=s[20],s[21]!==k?(y=e.jsx(le,{children:e.jsxs(ne,{className:"flex items-center gap-2",children:[N,"Location Shares",k]})}),s[21]=k,s[22]=y):y=s[22],m=ie,b="space-y-4";let C;s[23]!==p||s[24]!==u?(C=l=>e.jsxs("div",{className:`border rounded-lg p-4 space-y-3 ${l.viewed_at?"border-border":"border-primary bg-primary/5"}`,children:[e.jsx("div",{className:"flex items-start justify-between gap-3",children:e.jsxs("div",{className:"space-y-1 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"font-semibold",children:l.pet_name}),!l.viewed_at&&e.jsx(X,{variant:"secondary",className:"text-xs",children:"New"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(Gt,{className:"h-3.5 w-3.5"}),fs(new Date(l.shared_at),"MMM d, yyyy 'at' h:mm a")]}),l.accuracy&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Accuracy: Â±",Math.round(l.accuracy),"m"]})]})}),l.finder_note&&e.jsxs("div",{className:"bg-muted/50 rounded p-3 space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs font-medium text-muted-foreground",children:[e.jsx(Ht,{className:"h-3 w-3"}),"Message from finder"]}),e.jsx("p",{className:"text-sm whitespace-pre-wrap",children:l.finder_note})]}),l.finder_contact&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Yt,{className:"h-3.5 w-3.5 text-muted-foreground"}),e.jsx("a",{href:l.finder_contact.includes("@")?`mailto:${l.finder_contact}`:`tel:${l.finder_contact}`,className:"text-primary hover:underline",children:l.finder_contact})]}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsxs(O,{size:"sm",onClick:()=>d(Number(l.latitude),Number(l.longitude)),className:"flex-1 gap-2",children:[e.jsx(Xt,{className:"h-3.5 w-3.5"}),"Open in Maps"]}),!l.viewed_at&&e.jsx(O,{size:"sm",variant:"outline",onClick:()=>u.mutate(l.id),disabled:u.isPending,children:e.jsx(vt,{className:"h-3.5 w-3.5"})}),e.jsx(O,{size:"sm",variant:"ghost",onClick:()=>p.mutate(l.id),disabled:p.isPending,children:e.jsx(Jt,{className:"h-3.5 w-3.5"})})]})]},l.id),s[23]=p,s[24]=u,s[25]=C):C=s[25],j=D.map(C)}s[7]=p,s[8]=u,s[9]=r,s[10]=m,s[11]=x,s[12]=b,s[13]=j,s[14]=y,s[15]=w}else m=s[10],x=s[11],b=s[12],j=s[13],y=s[14],w=s[15];if(w!==Symbol.for("react.early_return_sentinel"))return w;let _;s[26]!==m||s[27]!==b||s[28]!==j?(_=e.jsx(m,{className:b,children:j}),s[26]=m,s[27]=b,s[28]=j,s[29]=_):_=s[29];let R;return s[30]!==x||s[31]!==y||s[32]!==_?(R=e.jsxs(x,{children:[y,_]}),s[30]=x,s[31]=y,s[32]=_,s[33]=R):R=s[33],R}function qs(s){return!s.viewed_at}function Os(s){return!s.archived_at}function zs(s,t){const a=`https://www.google.com/maps/search/?api=1&query=${s},${t}`;window.open(a,"_blank")}async function $s(s){const{error:t}=await A.from("location_shares").update({archived_at:new Date().toISOString()}).eq("id",s);if(t)throw t}async function Ls(s){const{error:t}=await A.from("location_shares").update({viewed_at:new Date().toISOString()}).eq("id",s);if(t)throw t}async function Ws(){const{data:s}=await A.auth.getUser(),{user:t}=s;if(!t)return[];const{data:a,error:r}=await A.from("location_shares").select(`
          id,
          pet_id,
          latitude,
          longitude,
          accuracy,
          finder_note,
          finder_contact,
          shared_at,
          viewed_at,
          archived_at,
          pets!inner(name)
        `).eq("owner_id",t.id).is("archived_at",null).order("shared_at",{ascending:!1}).limit(10);if(r)throw r;return(a||[]).map(Us)}function Us(s){return{...s,pet_name:s.pets.name}}function Vs(s){const t=U.c(4);let a;t[0]!==s?({...a}=s,t[0]=s,t[1]=a):a=t[1];let r;return t[2]!==a?(r=e.jsx(Tt,{"data-slot":"popover",...a}),t[2]=a,t[3]=r):r=t[3],r}function Ks(s){const t=U.c(4);let a;t[0]!==s?({...a}=s,t[0]=s,t[1]=a):a=t[1];let r;return t[2]!==a?(r=e.jsx(Pt,{"data-slot":"popover-trigger",...a}),t[2]=a,t[3]=r):r=t[3],r}function Qs(s){const t=U.c(12);let a,r,i,n;t[0]!==s?({className:a,align:i,sideOffset:n,...r}=s,t[0]=s,t[1]=a,t[2]=r,t[3]=i,t[4]=n):(a=t[1],r=t[2],i=t[3],n=t[4]);const u=i===void 0?"center":i,h=n===void 0?4:n;let p;t[5]!==a?(p=G("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-72 origin-(--radix-popover-content-transform-origin) rounded-md border p-4 shadow-md outline-hidden",a),t[5]=a,t[6]=p):p=t[6];let d;return t[7]!==u||t[8]!==r||t[9]!==h||t[10]!==p?(d=e.jsx(Dt,{children:e.jsx(Rt,{"data-slot":"popover-content",align:u,sideOffset:h,className:p,...r})}),t[7]=u,t[8]=r,t[9]=h,t[10]=p,t[11]=d):d=t[11],d}var et=1,Gs=.9,Hs=.8,Ys=.17,Se=.1,Ce=.999,Xs=.9999,Js=.99,Zs=/[\\\/_+.#"@\[\(\{&]/,ea=/[\\\/_+.#"@\[\(\{&]/g,ta=/[\s-]/,bt=/[\s-]/g;function Ie(s,t,a,r,i,n,u){if(n===t.length)return i===s.length?et:Js;var h=`${i},${n}`;if(u[h]!==void 0)return u[h];for(var p=r.charAt(n),d=a.indexOf(p,i),m=0,x,b,j,y;d>=0;)x=Ie(s,t,a,r,d+1,n+1,u),x>m&&(d===i?x*=et:Zs.test(s.charAt(d-1))?(x*=Hs,j=s.slice(i,d-1).match(ea),j&&i>0&&(x*=Math.pow(Ce,j.length))):ta.test(s.charAt(d-1))?(x*=Gs,y=s.slice(i,d-1).match(bt),y&&i>0&&(x*=Math.pow(Ce,y.length))):(x*=Ys,i>0&&(x*=Math.pow(Ce,d-i))),s.charAt(d)!==t.charAt(n)&&(x*=Xs)),(x<Se&&a.charAt(d-1)===r.charAt(n+1)||r.charAt(n+1)===r.charAt(n)&&a.charAt(d-1)!==r.charAt(n))&&(b=Ie(s,t,a,r,d+1,n+2,u),b*Se>x&&(x=b*Se)),x>m&&(m=x),d=a.indexOf(p,d+1);return u[h]=m,m}function tt(s){return s.toLowerCase().replace(bt," ")}function sa(s,t,a){return s=a&&a.length>0?`${s+" "+a.join(" ")}`:s,Ie(s,t,tt(s),tt(t),0,0,{})}var de='[cmdk-group=""]',_e='[cmdk-group-items=""]',aa='[cmdk-group-heading=""]',jt='[cmdk-item=""]',st=`${jt}:not([aria-disabled="true"])`,Ae="cmdk-item-select",se="data-value",ra=(s,t,a)=>sa(s,t,a),yt=c.createContext(void 0),ue=()=>c.useContext(yt),wt=c.createContext(void 0),qe=()=>c.useContext(wt),Nt=c.createContext(void 0),St=c.forwardRef((s,t)=>{let a=ae(()=>{var o,v;return{search:"",value:(v=(o=s.value)!=null?o:s.defaultValue)!=null?v:"",selectedItemId:void 0,filtered:{count:0,items:new Map,groups:new Set}}}),r=ae(()=>new Set),i=ae(()=>new Map),n=ae(()=>new Map),u=ae(()=>new Set),h=Ct(s),{label:p,children:d,value:m,onValueChange:x,filter:b,shouldFilter:j,loop:y,disablePointerSelection:w=!1,vimBindings:_=!0,...R}=s,D=re(),T=re(),N=re(),k=c.useRef(null),C=fa();ee(()=>{if(m!==void 0){let o=m.trim();a.current.value=o,l.emit()}},[m]),ee(()=>{C(6,I)},[]);let l=c.useMemo(()=>({subscribe:o=>(u.current.add(o),()=>u.current.delete(o)),snapshot:()=>a.current,setState:(o,v,S)=>{var g,E,P,L;if(!Object.is(a.current[o],v)){if(a.current[o]=v,o==="search")f(),M(),C(1,F);else if(o==="value"){if(document.activeElement.hasAttribute("cmdk-input")||document.activeElement.hasAttribute("cmdk-root")){let q=document.getElementById(N);q?q.focus():(g=document.getElementById(D))==null||g.focus()}if(C(7,()=>{var q;a.current.selectedItemId=(q=W())==null?void 0:q.id,l.emit()}),S||C(5,I),((E=h.current)==null?void 0:E.value)!==void 0){let q=v??"";(L=(P=h.current).onValueChange)==null||L.call(P,q);return}}l.emit()}},emit:()=>{u.current.forEach(o=>o())}}),[]),z=c.useMemo(()=>({value:(o,v,S)=>{var g;v!==((g=n.current.get(o))==null?void 0:g.value)&&(n.current.set(o,{value:v,keywords:S}),a.current.filtered.items.set(o,B(v,S)),C(2,()=>{M(),l.emit()}))},item:(o,v)=>(r.current.add(o),v&&(i.current.has(v)?i.current.get(v).add(o):i.current.set(v,new Set([o]))),C(3,()=>{f(),M(),a.current.value||F(),l.emit()}),()=>{n.current.delete(o),r.current.delete(o),a.current.filtered.items.delete(o);let S=W();C(4,()=>{f(),S?.getAttribute("id")===o&&F(),l.emit()})}),group:o=>(i.current.has(o)||i.current.set(o,new Set),()=>{n.current.delete(o),i.current.delete(o)}),filter:()=>h.current.shouldFilter,label:p||s["aria-label"],getDisablePointerSelection:()=>h.current.disablePointerSelection,listId:D,inputId:N,labelId:T,listInnerRef:k}),[]);function B(o,v){var S,g;let E=(g=(S=h.current)==null?void 0:S.filter)!=null?g:ra;return o?E(o,a.current.search,v):0}function M(){if(!a.current.search||h.current.shouldFilter===!1)return;let o=a.current.filtered.items,v=[];a.current.filtered.groups.forEach(g=>{let E=i.current.get(g),P=0;E.forEach(L=>{let q=o.get(L);P=Math.max(q,P)}),v.push([g,P])});let S=k.current;ce().sort((g,E)=>{var P,L;let q=g.getAttribute("id"),he=E.getAttribute("id");return((P=o.get(he))!=null?P:0)-((L=o.get(q))!=null?L:0)}).forEach(g=>{let E=g.closest(_e);E?E.appendChild(g.parentElement===E?g:g.closest(`${_e} > *`)):S.appendChild(g.parentElement===S?g:g.closest(`${_e} > *`))}),v.sort((g,E)=>E[1]-g[1]).forEach(g=>{var E;let P=(E=k.current)==null?void 0:E.querySelector(`${de}[${se}="${encodeURIComponent(g[0])}"]`);P?.parentElement.appendChild(P)})}function F(){let o=ce().find(S=>S.getAttribute("aria-disabled")!=="true"),v=o?.getAttribute(se);l.setState("value",v||void 0)}function f(){var o,v,S,g;if(!a.current.search||h.current.shouldFilter===!1){a.current.filtered.count=r.current.size;return}a.current.filtered.groups=new Set;let E=0;for(let P of r.current){let L=(v=(o=n.current.get(P))==null?void 0:o.value)!=null?v:"",q=(g=(S=n.current.get(P))==null?void 0:S.keywords)!=null?g:[],he=B(L,q);a.current.filtered.items.set(P,he),he>0&&E++}for(let[P,L]of i.current)for(let q of L)if(a.current.filtered.items.get(q)>0){a.current.filtered.groups.add(P);break}a.current.filtered.count=E}function I(){var o,v,S;let g=W();g&&(((o=g.parentElement)==null?void 0:o.firstChild)===g&&((S=(v=g.closest(de))==null?void 0:v.querySelector(aa))==null||S.scrollIntoView({block:"nearest"})),g.scrollIntoView({block:"nearest"}))}function W(){var o;return(o=k.current)==null?void 0:o.querySelector(`${jt}[aria-selected="true"]`)}function ce(){var o;return Array.from(((o=k.current)==null?void 0:o.querySelectorAll(st))||[])}function xe(o){let v=ce()[o];v&&l.setState("value",v.getAttribute(se))}function ge(o){var v;let S=W(),g=ce(),E=g.findIndex(L=>L===S),P=g[E+o];(v=h.current)!=null&&v.loop&&(P=E+o<0?g[g.length-1]:E+o===g.length?g[0]:g[E+o]),P&&l.setState("value",P.getAttribute(se))}function Oe(o){let v=W(),S=v?.closest(de),g;for(;S&&!g;)S=o>0?ha(S,de):pa(S,de),g=S?.querySelector(st);g?l.setState("value",g.getAttribute(se)):ge(o)}let ze=()=>xe(ce().length-1),$e=o=>{o.preventDefault(),o.metaKey?ze():o.altKey?Oe(1):ge(1)},Le=o=>{o.preventDefault(),o.metaKey?xe(0):o.altKey?Oe(-1):ge(-1)};return c.createElement(Y.div,{ref:t,tabIndex:-1,...R,"cmdk-root":"",onKeyDown:o=>{var v;(v=R.onKeyDown)==null||v.call(R,o);let S=o.nativeEvent.isComposing||o.keyCode===229;if(!(o.defaultPrevented||S))switch(o.key){case"n":case"j":{_&&o.ctrlKey&&$e(o);break}case"ArrowDown":{$e(o);break}case"p":case"k":{_&&o.ctrlKey&&Le(o);break}case"ArrowUp":{Le(o);break}case"Home":{o.preventDefault(),xe(0);break}case"End":{o.preventDefault(),ze();break}case"Enter":{o.preventDefault();let g=W();if(g){let E=new Event(Ae);g.dispatchEvent(E)}}}}},c.createElement("label",{"cmdk-label":"",htmlFor:z.inputId,id:z.labelId,style:ga},p),fe(s,o=>c.createElement(wt.Provider,{value:l},c.createElement(yt.Provider,{value:z},o))))}),ia=c.forwardRef((s,t)=>{var a,r;let i=re(),n=c.useRef(null),u=c.useContext(Nt),h=ue(),p=Ct(s),d=(r=(a=p.current)==null?void 0:a.forceMount)!=null?r:u?.forceMount;ee(()=>{if(!d)return h.item(i,u?.id)},[d]);let m=_t(i,n,[s.value,s.children,n],s.keywords),x=qe(),b=H(C=>C.value&&C.value===m.current),j=H(C=>d||h.filter()===!1?!0:C.search?C.filtered.items.get(i)>0:!0);c.useEffect(()=>{let C=n.current;if(!(!C||s.disabled))return C.addEventListener(Ae,y),()=>C.removeEventListener(Ae,y)},[j,s.onSelect,s.disabled]);function y(){var C,l;w(),(l=(C=p.current).onSelect)==null||l.call(C,m.current)}function w(){x.setState("value",m.current,!0)}if(!j)return null;let{disabled:_,value:R,onSelect:D,forceMount:T,keywords:N,...k}=s;return c.createElement(Y.div,{ref:me(n,t),...k,id:i,"cmdk-item":"",role:"option","aria-disabled":!!_,"aria-selected":!!b,"data-disabled":!!_,"data-selected":!!b,onPointerMove:_||h.getDisablePointerSelection()?void 0:w,onClick:_?void 0:y},s.children)}),na=c.forwardRef((s,t)=>{let{heading:a,children:r,forceMount:i,...n}=s,u=re(),h=c.useRef(null),p=c.useRef(null),d=re(),m=ue(),x=H(j=>i||m.filter()===!1?!0:j.search?j.filtered.groups.has(u):!0);ee(()=>m.group(u),[]),_t(u,h,[s.value,s.heading,p]);let b=c.useMemo(()=>({id:u,forceMount:i}),[i]);return c.createElement(Y.div,{ref:me(h,t),...n,"cmdk-group":"",role:"presentation",hidden:x?void 0:!0},a&&c.createElement("div",{ref:p,"cmdk-group-heading":"","aria-hidden":!0,id:d},a),fe(s,j=>c.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":a?d:void 0},c.createElement(Nt.Provider,{value:b},j))))}),la=c.forwardRef((s,t)=>{let{alwaysRender:a,...r}=s,i=c.useRef(null),n=H(u=>!u.search);return!a&&!n?null:c.createElement(Y.div,{ref:me(i,t),...r,"cmdk-separator":"",role:"separator"})}),oa=c.forwardRef((s,t)=>{let{onValueChange:a,...r}=s,i=s.value!=null,n=qe(),u=H(d=>d.search),h=H(d=>d.selectedItemId),p=ue();return c.useEffect(()=>{s.value!=null&&n.setState("search",s.value)},[s.value]),c.createElement(Y.input,{ref:t,...r,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":p.listId,"aria-labelledby":p.labelId,"aria-activedescendant":h,id:p.inputId,type:"text",value:i?s.value:u,onChange:d=>{i||n.setState("search",d.target.value),a?.(d.target.value)}})}),ca=c.forwardRef((s,t)=>{let{children:a,label:r="Suggestions",...i}=s,n=c.useRef(null),u=c.useRef(null),h=H(d=>d.selectedItemId),p=ue();return c.useEffect(()=>{if(u.current&&n.current){let d=u.current,m=n.current,x,b=new ResizeObserver(()=>{x=requestAnimationFrame(()=>{let j=d.offsetHeight;m.style.setProperty("--cmdk-list-height",j.toFixed(1)+"px")})});return b.observe(d),()=>{cancelAnimationFrame(x),b.unobserve(d)}}},[]),c.createElement(Y.div,{ref:me(n,t),...i,"cmdk-list":"",role:"listbox",tabIndex:-1,"aria-activedescendant":h,"aria-label":r,id:p.listId},fe(s,d=>c.createElement("div",{ref:me(u,p.listInnerRef),"cmdk-list-sizer":""},d)))}),da=c.forwardRef((s,t)=>{let{open:a,onOpenChange:r,overlayClassName:i,contentClassName:n,container:u,...h}=s;return c.createElement(Bt,{open:a,onOpenChange:r},c.createElement(It,{container:u},c.createElement(At,{"cmdk-overlay":"",className:i}),c.createElement(Mt,{"aria-label":s.label,"cmdk-dialog":"",className:n},c.createElement(St,{ref:t,...h}))))}),ma=c.forwardRef((s,t)=>H(a=>a.filtered.count===0)?c.createElement(Y.div,{ref:t,...s,"cmdk-empty":"",role:"presentation"}):null),ua=c.forwardRef((s,t)=>{let{progress:a,children:r,label:i="Loading...",...n}=s;return c.createElement(Y.div,{ref:t,...n,"cmdk-loading":"",role:"progressbar","aria-valuenow":a,"aria-valuemin":0,"aria-valuemax":100,"aria-label":i},fe(s,u=>c.createElement("div",{"aria-hidden":!0},u)))}),oe=Object.assign(St,{List:ca,Item:ia,Input:oa,Group:na,Separator:la,Dialog:da,Empty:ma,Loading:ua});function ha(s,t){let a=s.nextElementSibling;for(;a;){if(a.matches(t))return a;a=a.nextElementSibling}}function pa(s,t){let a=s.previousElementSibling;for(;a;){if(a.matches(t))return a;a=a.previousElementSibling}}function Ct(s){let t=c.useRef(s);return ee(()=>{t.current=s}),t}var ee=typeof window>"u"?c.useEffect:c.useLayoutEffect;function ae(s){let t=c.useRef();return t.current===void 0&&(t.current=s()),t}function H(s){let t=qe(),a=()=>s(t.snapshot());return c.useSyncExternalStore(t.subscribe,a,a)}function _t(s,t,a,r=[]){let i=c.useRef(),n=ue();return ee(()=>{var u;let h=(()=>{var d;for(let m of a){if(typeof m=="string")return m.trim();if(typeof m=="object"&&"current"in m)return m.current?(d=m.current.textContent)==null?void 0:d.trim():i.current}})(),p=r.map(d=>d.trim());n.value(s,h,p),(u=t.current)==null||u.setAttribute(se,h),i.current=h}),i}var fa=()=>{let[s,t]=c.useState(),a=ae(()=>new Map);return ee(()=>{a.current.forEach(r=>r()),a.current=new Map},[s]),(r,i)=>{a.current.set(r,i),t({})}};function xa(s){let t=s.type;return typeof t=="function"?t(s.props):"render"in t?t.render(s.props):s}function fe({asChild:s,children:t},a){return s&&c.isValidElement(t)?c.cloneElement(xa(t),{ref:t.ref},a(t.props.children)):a(t)}var ga={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};function va(s){const t=U.c(8);let a,r;t[0]!==s?({className:a,...r}=s,t[0]=s,t[1]=a,t[2]=r):(a=t[1],r=t[2]);let i;t[3]!==a?(i=G("bg-popover text-popover-foreground flex h-full w-full flex-col overflow-hidden rounded-md",a),t[3]=a,t[4]=i):i=t[4];let n;return t[5]!==r||t[6]!==i?(n=e.jsx(oe,{"data-slot":"command",className:i,...r}),t[5]=r,t[6]=i,t[7]=n):n=t[7],n}function ba(s){const t=U.c(9);let a,r;t[0]!==s?({className:a,...r}=s,t[0]=s,t[1]=a,t[2]=r):(a=t[1],r=t[2]);let i;t[3]===Symbol.for("react.memo_cache_sentinel")?(i=e.jsx(Zt,{className:"size-4 shrink-0 opacity-50"}),t[3]=i):i=t[3];let n;t[4]!==a?(n=G("placeholder:text-muted-foreground flex h-10 w-full rounded-md bg-transparent py-3 text-sm outline-hidden disabled:cursor-not-allowed disabled:opacity-50",a),t[4]=a,t[5]=n):n=t[5];let u;return t[6]!==r||t[7]!==n?(u=e.jsxs("div",{"data-slot":"command-input-wrapper",className:"flex h-9 items-center gap-2 border-b px-3",children:[i,e.jsx(oe.Input,{"data-slot":"command-input",className:n,...r})]}),t[6]=r,t[7]=n,t[8]=u):u=t[8],u}function ja(s){const t=U.c(8);let a,r;t[0]!==s?({className:a,...r}=s,t[0]=s,t[1]=a,t[2]=r):(a=t[1],r=t[2]);let i;t[3]!==a?(i=G("max-h-[300px] scroll-py-1 overflow-x-hidden overflow-y-auto",a),t[3]=a,t[4]=i):i=t[4];let n;return t[5]!==r||t[6]!==i?(n=e.jsx(oe.List,{"data-slot":"command-list",className:i,...r}),t[5]=r,t[6]=i,t[7]=n):n=t[7],n}function ya(s){const t=U.c(4);let a;t[0]!==s?({...a}=s,t[0]=s,t[1]=a):a=t[1];let r;return t[2]!==a?(r=e.jsx(oe.Empty,{"data-slot":"command-empty",className:"py-6 text-center text-sm",...a}),t[2]=a,t[3]=r):r=t[3],r}function wa(s){const t=U.c(8);let a,r;t[0]!==s?({className:a,...r}=s,t[0]=s,t[1]=a,t[2]=r):(a=t[1],r=t[2]);let i;t[3]!==a?(i=G("text-foreground [&_[cmdk-group-heading]]:text-muted-foreground overflow-hidden p-1 [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium",a),t[3]=a,t[4]=i):i=t[4];let n;return t[5]!==r||t[6]!==i?(n=e.jsx(oe.Group,{"data-slot":"command-group",className:i,...r}),t[5]=r,t[6]=i,t[7]=n):n=t[7],n}function Na(s){const t=U.c(8);let a,r;t[0]!==s?({className:a,...r}=s,t[0]=s,t[1]=a,t[2]=r):(a=t[1],r=t[2]);let i;t[3]!==a?(i=G("data-[selected=true]:bg-accent data-[selected=true]:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled=true]:pointer-events-none data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",a),t[3]=a,t[4]=i):i=t[4];let n;return t[5]!==r||t[6]!==i?(n=e.jsx(oe.Item,{"data-slot":"command-item",className:i,...r}),t[5]=r,t[6]=i,t[7]=n):n=t[7],n}const kt=[{name:"Golden Retriever",defaultColors:["Golden"]},{name:"Labrador Retriever",defaultColors:["Yellow","Black","Chocolate"]},{name:"German Shepherd",defaultColors:["Black/Tan","Sable","Black"]},{name:"French Bulldog",defaultColors:["Fawn","Brindle","Cream","Pied"]},{name:"Poodle",defaultColors:["White","Black","Apricot","Red"]},{name:"Bulldog",defaultColors:["Fawn","Brindle","White","Piebald"]},{name:"Beagle",defaultColors:["Tri-color","Lemon/White","Red/White"]},{name:"Rottweiler",defaultColors:["Black/Rust"]},{name:"Dachshund",defaultColors:["Red","Black/Tan","Chocolate/Tan","Dapple"]},{name:"Yorkshire Terrier",defaultColors:["Blue/Tan"]}],Et=[{name:"Bicolor / Tuxedo",defaultColors:["Black/White","Gray/White","Seal/White"]},{name:"Calico",defaultColors:["Black/Orange/White","Dilute (Blue/Cream/White)"]},{name:"Pointed",defaultColors:["Seal point","Blue point","Chocolate point","Lilac point","Flame point"]},{name:"Shaded",defaultColors:["Shaded Silver","Shaded Golden"]},{name:"Smoke",defaultColors:["Black Smoke","Blue Smoke"]},{name:"Solid",defaultColors:["Black","White","Blue/Gray","Red/Orange","Cream"]},{name:"Spotted",defaultColors:["Brown Spotted","Silver Spotted"]},{name:"Tabby",defaultColors:["Brown Tabby","Gray/Blue Tabby","Orange Tabby","Silver Tabby","Torbie"]},{name:"Tortoiseshell (Tortie)",defaultColors:["Black/Orange","Chocolate/Cream","Dilute (Blue/Cream)"]}];function Sa(s,t){return!s||!t?[]:s==="dog"?kt.find(r=>r.name===t)?.defaultColors??[]:s==="cat"?Et.find(r=>r.name===t)?.defaultColors??[]:[]}const Ca=kt.map(s=>s.name),_a=Et.map(s=>s.name);function ka({label:s="Photo",value:t,onChange:a,options:r,accept:i="image/*",className:n}){const u=c.useRef(null),[h,p]=c.useState(!1),[d,m]=c.useState(!1),[x,b]=c.useState(null),j=c.useCallback(()=>{u.current?.click()},[]),y=c.useCallback(()=>{a(null),b(null)},[a]),w=c.useCallback(async N=>{if(!N||!N.type.startsWith("image/")){b("Please select a valid image file");return}if(N.size>10*1024*1024){b("File size must be less than 10MB");return}b(null),p(!0);try{const k=await Ea(N,r);a(k)}catch(k){b("Failed to optimize image. Please try another file."),console.error("Image optimization error:",k)}finally{p(!1)}},[r,a]),_=c.useCallback(N=>{N.preventDefault(),N.stopPropagation(),m(!0)},[]),R=c.useCallback(N=>{N.preventDefault(),N.stopPropagation(),m(!1)},[]),D=c.useCallback(N=>{N.preventDefault(),N.stopPropagation(),m(!1);const k=N.dataTransfer.files?.[0];k&&w(k)},[w]),T=t?Math.round((1-t.approxKB/t.original.sizeKB)*100):0;return e.jsxs("div",{className:n,children:[e.jsx($,{className:"mb-2 block font-medium",children:s}),t?e.jsx("div",{className:"border rounded-lg p-4 bg-card",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsxs("div",{className:"relative group",children:[e.jsx("img",{src:t.dataUrl,alt:"preview",className:"h-32 w-32 rounded-lg object-cover border-2 border-border"}),e.jsx("div",{className:"absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity rounded-lg flex items-center justify-center",children:e.jsx(ts,{className:"h-8 w-8 text-white"})})]}),e.jsxs("div",{className:"flex-1 space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm truncate",children:t.original.name}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[t.width," Ã— ",t.height,"px"]})]}),e.jsx(O,{type:"button",variant:"ghost",size:"sm",onClick:y,className:"h-8 w-8 p-0",children:e.jsx(ss,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-xs",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-muted-foreground",children:"Original"}),e.jsxs("p",{className:"font-medium",children:[t.original.sizeKB.toLocaleString()," KB"]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-muted-foreground",children:"Optimized"}),e.jsxs("p",{className:"font-medium text-green-600 dark:text-green-400",children:[t.approxKB.toLocaleString()," KB"]})]})]}),T>0&&e.jsx("div",{className:"bg-green-50 dark:bg-green-950/30 border border-green-200 dark:border-green-900 rounded-md px-3 py-2",children:e.jsxs("p",{className:"text-xs text-green-700 dark:text-green-300 font-medium",children:["â†“ ",T,"% smaller Â· ",t.mimeType]})}),e.jsx(O,{type:"button",variant:"outline",size:"sm",onClick:j,className:"w-full",children:"Replace Image"})]})]})}):e.jsx("div",{onDragOver:_,onDragLeave:R,onDrop:D,onClick:j,className:`
            relative border-2 border-dashed rounded-lg p-8 transition-all cursor-pointer
            hover:border-primary/50 hover:bg-accent/50
            ${d?"border-primary bg-accent scale-[1.02]":"border-border"}
            ${h?"pointer-events-none opacity-60":""}
          `,children:e.jsx("div",{className:"flex flex-col items-center justify-center text-center space-y-3",children:h?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-primary"}),e.jsx("p",{className:"text-sm font-medium",children:"Optimizing image..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"rounded-full bg-primary/10 p-3",children:e.jsx(es,{className:"h-6 w-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium mb-1",children:"Drop your image here, or click to browse"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"PNG, JPG, WebP up to 10MB"})]})]})})}),x&&e.jsx("div",{className:"mt-2 text-sm text-red-600 dark:text-red-400 bg-red-50 dark:bg-red-950/30 border border-red-200 dark:border-red-900 rounded-md px-3 py-2",children:x}),e.jsx(K,{ref:u,type:"file",accept:i,className:"hidden",onChange:N=>{const k=N.target.files?.[0];k&&w(k),N.currentTarget.value=""}})]})}async function Ea(s,t){const a=await s.arrayBuffer(),r=new Blob([a]),i=await Pa(r),n=t?.maxWidth??1200,u=t?.maxHeight??1200,{width:h,height:p}=Ta(i.width,i.height,n,u),d=document.createElement("canvas");d.width=h,d.height=p;const m=d.getContext("2d",{alpha:!0});m.imageSmoothingEnabled=!0,m.imageSmoothingQuality="high",m.drawImage(i,0,0,h,p);const x=t?.preferWebP??!0,b=t?.quality??.82,j=d.toDataURL("image/webp").startsWith("data:image/webp"),y=x&&j?"image/webp":"image/jpeg",w=await Da(d,y,b),_=await Ra(w);return{blob:w,dataUrl:_,width:h,height:p,approxKB:Math.round(w.size/1024),mimeType:y,original:{name:s.name,sizeKB:Math.round(s.size/1024),type:s.type}}}function Ta(s,t,a,r){const i=Math.min(a/s,r/t,1);return{width:Math.round(s*i),height:Math.round(t*i)}}function Pa(s){return new Promise((t,a)=>{const r=URL.createObjectURL(s),i=new Image;i.onload=()=>{URL.revokeObjectURL(r),t(i)},i.onerror=()=>{URL.revokeObjectURL(r),a(new Error("Failed to load image"))},i.src=r})}function Da(s,t,a){return new Promise((r,i)=>{s.toBlob(n=>{n?r(n):i(new Error("Canvas to blob conversion failed"))},t,a)})}function Ra(s){return new Promise((t,a)=>{const r=new FileReader;r.onload=()=>t(String(r.result)),r.onerror=()=>a(new Error("Failed to read blob")),r.readAsDataURL(s)})}function Ba(s){const[t,a]=c.useState(ve),[r,i]=c.useState(!0);return c.useEffect(()=>{if(!s){i(!1);return}(async()=>{try{const{data:p,error:d}=await A.from("pet_themes").select("theme_preset, custom_colors, background_image_url").eq("pet_id",s).maybeSingle();if(d)throw d;a(p?p.theme_preset:ve)}catch(p){console.error("Failed to load pet theme:",p),a(ve)}finally{i(!1)}})()},[s]),{themeId:t,isLoading:r,updatePetTheme:async h=>{if(s){a(h);try{const{error:p}=await A.from("pet_themes").upsert({pet_id:s,theme_preset:h,updated_at:new Date().toISOString()});if(p)throw p}catch(p){console.error("Failed to save pet theme:",p)}}},applyPetTheme:(h=!1)=>{qt(t,h)}}}const Ia=Qe({id:V().optional(),name:V().min(1,"Name is required"),species:Ge(["dog","cat","other"],{message:"Choose a species"}),breed:V().optional(),color:V().optional(),weight:gs([bs().min(0,"Weight must be positive"),js(),ys()]).transform(s=>typeof s=="number"&&!isNaN(s)?s:void 0).optional(),birthdate:V().optional(),microchipId:V().optional(),description:V().optional(),notes:V().optional(),vaccinations:Qe({rabies:vs().default(!1),rabiesExpires:V().optional()}).default({rabies:!1,rabiesExpires:""}),photoPreview:V().optional(),environment:Ge(["indoor","outdoor","indoor_outdoor"]).default("indoor_outdoor")});async function at(s){return await(await fetch(s)).blob()}function rt({mode:s,open:t,onOpenChange:a,initialPet:r,onSubmit:i}){const{user:n}=Fe(),[u,h]=c.useState(!1),{data:p,update:d}=nt(),m=Ft({resolver:xs(Ia),defaultValues:{id:r?.id,name:r?.name??"",species:r?.species,breed:r?.breed??"",color:r?.color??"",weight:r?.weight??void 0,birthdate:r?.birthdate??"",microchipId:r?.microchipId??"",description:r?.description??"",notes:r?.notes??"",vaccinations:{rabies:r?.vaccinations?.rabies??!1,rabiesExpires:r?.vaccinations?.rabiesExpires??""},photoPreview:r?.photoPreview??"",environment:r?.environment??"indoor_outdoor"},mode:"onSubmit"}),x=m.watch("species"),b=m.watch("breed"),[j,y]=c.useState(!1),{themeId:w,updatePetTheme:_}=Ba(r?.id),[R,D]=c.useState(w);c.useEffect(()=>{D(w)},[w]);const T=c.useRef(null),N=c.useMemo(()=>x==="dog"?Ca:x==="cat"?_a:[],[x]),k=c.useMemo(()=>Sa(x??"other",b),[x,b]),C=async l=>{if(!n?.id){alert("You must be signed in.");return}h(!0);const z={rabies:!!l.vaccinations?.rabies,rabiesExpires:l.vaccinations?.rabies&&l.vaccinations.rabiesExpires||void 0},B={owner_id:n.id,name:l.name,species:l.species,breed:l.breed||null,color:l.color||null,weight:typeof l.weight=="number"?l.weight:null,birthdate:l.birthdate||null,microchip_id:l.microchipId||null,description:l.description||null,notes:l.notes||null,vaccinations:z,environment:l.environment};try{let M;if(s==="add"){M=await Rs({...B});let F=T.current;if(!F&&l.photoPreview&&(F=await at(l.photoPreview)),F&&F.size>0){const f=await Ze(n.id,M.id,F);M=await Be(M.id,{photo_url:f})}}else{const F=l.id||r?.id;if(!F)throw new Error("Missing pet id for update.");let f=T.current;!f&&l.photoPreview&&(f=await at(l.photoPreview));const I={name:B.name,species:B.species,breed:B.breed,color:B.color,weight:B.weight,birthdate:B.birthdate,microchip_id:B.microchip_id,description:B.description,notes:B.notes,vaccinations:B.vaccinations,environment:B.environment};if(f&&f.size>0){const W=await Ze(n.id,F,f);I.photo_url=W}M=await Be(F,I)}M?.id&&await _(R),s==="add"&&p?.has_created_first_pet===!1&&await d.mutateAsync({has_created_first_pet:!0}),i?.(l),a(!1),s==="add"&&m.reset()}catch(M){console.error(M),alert(M?.message??"Failed to save pet")}finally{h(!1)}};return e.jsx(ws,{open:t,onOpenChange:l=>!u&&a(l),children:e.jsxs(Ns,{className:"sm:max-w-2xl max-h-[90vh] overflow-y-auto bg-white dark:bg-slate-900",children:[e.jsx(Ss,{className:"space-y-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-10 w-10 bg-primary/10 rounded-xl flex items-center justify-center ring-4 ring-primary/5",children:e.jsx(J,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{children:[e.jsx(Cs,{className:"text-2xl",children:s==="add"?"Add New Pet":"Edit Pet"}),e.jsx(_s,{className:"text-base",children:s==="add"?"Enter your pet's details to create their profile":"Update your pet's information"})]})]})}),e.jsxs("form",{onSubmit:m.handleSubmit(C),className:"space-y-6 mt-4",children:[e.jsxs("section",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm font-semibold text-foreground",children:[e.jsx(Re,{className:"h-4 w-4 text-primary"}),"Basic Information"]}),e.jsxs("div",{className:"space-y-4 pl-6 border-l-2 border-primary/20",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs($,{htmlFor:"name",className:"text-sm font-medium flex items-center gap-2",children:["Name ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(K,{id:"name",...m.register("name"),placeholder:"e.g., Milo, Luna, Max",className:"h-11 transition-all duration-200 focus:ring-2 focus:ring-primary/20"}),m.formState.errors.name&&e.jsxs("p",{className:"text-sm text-destructive flex items-center gap-1.5 animate-in fade-in-50",children:[e.jsx(pe,{className:"h-3.5 w-3.5"}),m.formState.errors.name.message]})]}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs($,{className:"text-sm font-medium flex items-center gap-2",children:["Species ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsxs(He,{value:x,onValueChange:l=>{m.setValue("species",l,{shouldValidate:!0}),m.setValue("breed",""),m.setValue("color","")},children:[e.jsx(Ye,{className:"h-11",children:e.jsx(Xe,{placeholder:"Select species"})}),e.jsxs(Je,{children:[e.jsx(te,{value:"dog",children:"ðŸ• Dog"}),e.jsx(te,{value:"cat",children:"ðŸ± Cat"}),e.jsx(te,{value:"other",children:"ðŸ¾ Other"})]})]}),m.formState.errors.species&&e.jsxs("p",{className:"text-sm text-destructive flex items-center gap-1.5",children:[e.jsx(pe,{className:"h-3.5 w-3.5"}),m.formState.errors.species.message]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs($,{htmlFor:"birthdate",className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(as,{className:"h-3.5 w-3.5"}),"Birthdate"]}),e.jsx(K,{id:"birthdate",type:"date",...m.register("birthdate"),className:"h-11"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs($,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(J,{className:"h-3.5 w-3.5"}),x==="cat"?"Pattern":"Breed",x==="other"&&e.jsx("span",{className:"text-muted-foreground text-xs",children:"(optional)"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(K,{placeholder:x==="dog"?"e.g., Golden Retriever":x==="cat"?"e.g., Tabby, Calico":"e.g., Rabbit, Guinea Pig",...m.register("breed"),className:"h-11 flex-1"}),N.length>0&&e.jsxs(Vs,{open:j,onOpenChange:y,children:[e.jsx(Ks,{asChild:!0,children:e.jsxs(O,{type:"button",variant:"outline",className:"w-36 justify-between h-11",children:["Suggestions ",e.jsx(rs,{className:"h-4 w-4 opacity-60"})]})}),e.jsx(Qs,{className:"p-0 w-64",children:e.jsxs(va,{children:[e.jsx(ba,{placeholder:"Searchâ€¦"}),e.jsxs(ja,{children:[e.jsx(ya,{children:"No matches found."}),e.jsx(wa,{children:N.map(l=>e.jsx(Na,{value:l,onSelect:z=>{m.setValue("breed",z),y(!1)},children:l},l))})]})]})})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs($,{htmlFor:"color",className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Ve,{className:"h-3.5 w-3.5"}),"Color"]}),e.jsx(K,{id:"color",...m.register("color"),placeholder:"e.g., Brown, White, Mixed",className:"h-11"}),k.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 pt-1",children:k.map(l=>e.jsx("button",{type:"button",onClick:()=>m.setValue("color",l,{shouldValidate:!0}),className:"rounded-full border border-primary/20 bg-primary/5 px-3 py-1 text-xs font-medium hover:bg-primary/10 transition-colors",children:l},l))})]}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs($,{htmlFor:"weight",className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(is,{className:"h-3.5 w-3.5"}),"Weight (lbs)"]}),e.jsx(K,{id:"weight",type:"number",step:"0.1",placeholder:"e.g., 45.5",...m.register("weight",{valueAsNumber:!0}),className:"h-11"}),m.formState.errors.weight&&e.jsxs("p",{className:"text-sm text-destructive flex items-center gap-1.5",children:[e.jsx(pe,{className:"h-3.5 w-3.5"}),m.formState.errors.weight.message]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs($,{htmlFor:"microchipId",className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(ns,{className:"h-3.5 w-3.5"}),"Microchip ID"]}),e.jsx(K,{id:"microchipId",...m.register("microchipId"),placeholder:"e.g., 981000012345678",className:"h-11"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs($,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(ls,{className:"h-3.5 w-3.5"}),"Pet Environment"]}),e.jsxs(He,{value:m.watch("environment"),onValueChange:l=>{m.setValue("environment",l,{shouldValidate:!0})},children:[e.jsx(Ye,{className:"h-11",children:e.jsx(Xe,{placeholder:"Select environment"})}),e.jsxs(Je,{children:[e.jsx(te,{value:"indoor",children:"ðŸ  Indoor Only"}),e.jsx(te,{value:"outdoor",children:"ðŸŒ³ Outdoor Only"}),e.jsx(te,{value:"indoor_outdoor",children:"ðŸ¡ Indoor & Outdoor"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{htmlFor:"description",className:"text-sm font-medium",children:"Physical Description"}),e.jsx(K,{id:"description",...m.register("description"),placeholder:"e.g., White paws, brown spot on left ear",className:"h-11"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{htmlFor:"notes",className:"text-sm font-medium",children:"Additional Notes"}),e.jsx(Es,{id:"notes",...m.register("notes"),placeholder:"Allergies, medications, behavioral notes, vet contact info...",className:"min-h-[80px] resize-none"})]})]})]}),e.jsx(Ne,{}),e.jsxs("section",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm font-semibold text-foreground",children:[e.jsx(os,{className:"h-4 w-4 text-primary"}),"Vaccinations"]}),e.jsxs("div",{className:"space-y-3 pl-6 border-l-2 border-primary/20",children:[e.jsx(Te,{className:"border-blue-200 bg-blue-50 dark:border-blue-900 dark:bg-blue-950",children:e.jsx(Pe,{className:"text-xs text-blue-800 dark:text-blue-200",children:"Keep track of your pet's vaccination records for their health and safety"})}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-3 bg-secondary/30 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[e.jsx("input",{id:"rabies",type:"checkbox",className:"h-4 w-4 rounded border-primary text-primary focus:ring-primary",checked:!!m.watch("vaccinations.rabies"),onChange:l=>m.setValue("vaccinations.rabies",l.target.checked)}),e.jsx($,{htmlFor:"rabies",className:"text-sm font-medium cursor-pointer",children:"Rabies Vaccination"})]}),e.jsxs("div",{className:"flex items-center gap-2 sm:w-48",children:[e.jsx($,{htmlFor:"rabiesExpires",className:"text-xs text-muted-foreground whitespace-nowrap",children:"Expires:"}),e.jsx(K,{id:"rabiesExpires",type:"date",disabled:!m.watch("vaccinations.rabies"),...m.register("vaccinations.rabiesExpires"),className:"h-9"})]})]})]})]}),e.jsx(Ne,{}),e.jsxs("section",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm font-semibold text-foreground",children:[e.jsx(Ve,{className:"h-4 w-4 text-primary"}),"Page Theme"]}),e.jsxs("div",{className:"pl-6 border-l-2 border-primary/20",children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Choose a color theme for your pet's public page"}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-3",children:Object.values(Ot).map(l=>e.jsxs("button",{type:"button",onClick:()=>D(l.id),className:G("relative p-3 rounded-lg border-2 transition-all hover:scale-105",R===l.id?"border-primary shadow-md":"border-border hover:border-primary/50"),children:[e.jsx("div",{className:G("h-16 rounded-md mb-2 bg-gradient-to-br",l.previewGradient)}),e.jsx("p",{className:"text-xs font-medium text-center",children:l.name}),R===l.id&&e.jsx("div",{className:"absolute top-2 right-2 h-5 w-5 bg-primary rounded-full flex items-center justify-center",children:e.jsx(cs,{className:"h-3 w-3 text-primary-foreground"})})]},l.id))})]})]}),e.jsx(Ne,{}),e.jsxs("section",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm font-semibold text-foreground",children:[e.jsx(ds,{className:"h-4 w-4 text-primary"}),"Pet Photo"]}),e.jsx("div",{className:"pl-6 border-l-2 border-primary/20",children:e.jsx(ka,{label:"",value:m.watch("photoPreview")?{blob:new Blob,dataUrl:m.watch("photoPreview"),width:0,height:0,approxKB:0,mimeType:"image/*",original:{name:"",sizeKB:0,type:""}}:null,onChange:l=>{T.current=l?.blob??null,m.setValue("photoPreview",l?.dataUrl??"")},options:{maxWidth:1200,maxHeight:1200,quality:.82,preferWebP:!0}})})]}),e.jsxs(ks,{className:"gap-2 sm:gap-0 pt-4",children:[e.jsx(O,{type:"button",variant:"outline",onClick:()=>a(!1),disabled:u,className:"transition-all hover:scale-105",children:"Cancel"}),e.jsx(O,{type:"submit",disabled:u,className:"transition-all hover:scale-105",children:u?e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsxs("svg",{className:"animate-spin h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),s==="add"?"Creating...":"Updating..."]}):e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(J,{className:"h-4 w-4"}),s==="add"?"Create Pet Profile":"Save Changes"]})})]})]})]})})}function hr(){const{user:s}=Fe(),t=it(),a=s?.id??null,{data:r}=nt(),{data:i,isLoading:n,isError:u}=Me({queryKey:["pets",a],queryFn:async()=>a?Bs(a):[],enabled:!!a,staleTime:3e4}),[h,p]=c.useState(!1),[d,m]=c.useState(null),[x,b]=c.useState(null),[j,y]=c.useState(null),[w,_]=c.useState(null),[R,D]=c.useState(!1),[T,N]=c.useState(!1);c.useEffect(()=>{if(!r||!i||n||T)return;const f=i.length===0,I=r.has_created_first_pet===!1;f&&I&&!h&&p(!0)},[r,i,n,h,T]);const k=f=>{const W=`${window.location.origin}/p/${f.short_id}`;window.open(W,"_blank")},C=async()=>{await t.invalidateQueries({queryKey:["pets",a]}),await t.invalidateQueries({queryKey:["profile",a]}),m(null),p(!1)},l=f=>{p(f),!f&&r?.has_created_first_pet===!1&&(!i||i.length===0)&&N(!0)},z=async()=>{await t.invalidateQueries({queryKey:["pets",a]}),b(null)},B=ke({mutationFn:async({id:f,missing:I})=>Be(f,{missing:I,missing_since:I?new Date().toISOString():null}),onSuccess:async()=>{await t.invalidateQueries({queryKey:["pets",a]})}}),M=async(f,I)=>{if(I)_(f);else try{D(!0),await B.mutateAsync({id:f.id,missing:!1})}catch(W){alert(W?.message??"Failed to update")}finally{D(!1)}},F=async()=>{if(w)try{D(!0),await B.mutateAsync({id:w.id,missing:!0})}catch(f){alert(f?.message??"Failed to update")}finally{D(!1),_(null)}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("h1",{className:"text-3xl font-bold tracking-tight flex items-center gap-3",children:[e.jsx("div",{className:"h-10 w-10 bg-primary/10 rounded-xl flex items-center justify-center ring-4 ring-primary/5",children:e.jsx(J,{className:"h-5 w-5 text-primary"})}),"Dashboard"]}),e.jsx("p",{className:"text-muted-foreground",children:"Manage your pets, QR codes, and track activity"})]}),T&&r?.has_created_first_pet===!1&&(!i||i.length===0)&&e.jsxs(Te,{className:"border-primary/30 bg-primary/5 animate-in fade-in-50 slide-in-from-top-5",children:[e.jsx(Re,{className:"h-4 w-4 text-primary"}),e.jsxs(Pe,{className:"flex items-center justify-between gap-4",children:[e.jsx("span",{className:"text-sm",children:"Ready to get started? Create your first pet profile to activate your QR tag"}),e.jsxs(O,{size:"sm",onClick:()=>{N(!1),p(!0)},className:"gap-2 shrink-0",children:[e.jsx(we,{className:"h-3.5 w-3.5"}),"Add Pet"]})]})]}),e.jsxs(zt,{defaultValue:"pets",className:"space-y-4",children:[e.jsxs($t,{className:"grid w-full max-w-2xl grid-cols-3",children:[e.jsxs(be,{value:"pets",className:"gap-2",children:[e.jsx(J,{className:"h-4 w-4"}),"My Pets"]}),e.jsxs(be,{value:"locations",className:"gap-2",children:[e.jsx(Ke,{className:"h-4 w-4"}),"Locations"]}),e.jsxs(be,{value:"activity",className:"gap-2",children:[e.jsx(Ke,{className:"h-4 w-4"}),"Activity"]})]}),e.jsxs(je,{value:"pets",className:"space-y-4",children:[e.jsxs(Z,{className:"shadow-lg border-primary/10",children:[e.jsx(le,{className:"space-y-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-4",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs(ne,{className:"text-2xl flex items-center gap-2",children:[e.jsx(Re,{className:"h-5 w-5 text-primary"}),"Registered Pets"]}),e.jsx(Ee,{className:"text-base",children:"Manage profiles, photos, QR tags, and missing status"})]}),e.jsxs(O,{onClick:()=>p(!0),disabled:!a,className:"gap-2 transition-all hover:scale-105",children:[e.jsx(we,{className:"h-4 w-4"}),"Add Pet"]})]})}),e.jsx(ie,{children:n?e.jsx("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:Array.from({length:6}).map((f,I)=>e.jsxs(Z,{className:"p-4 space-y-3",children:[e.jsx(Q,{className:"h-5 w-40"}),e.jsx(Q,{className:"h-4 w-24"}),e.jsx(Q,{className:"h-32 w-full rounded-md"}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsx(Q,{className:"h-9 w-16"}),e.jsx(Q,{className:"h-9 w-16"}),e.jsx(Q,{className:"h-9 w-16"})]})]},I))}):u?e.jsxs(Te,{variant:"destructive",children:[e.jsx(pe,{className:"h-4 w-4"}),e.jsx(Pe,{children:"Failed to load pets. Please try again."})]}):i&&i.length>0?e.jsx("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:i.map(f=>e.jsxs(Z,{className:"overflow-hidden transition-all duration-200 hover:shadow-lg hover:scale-[1.02] border-primary/10",children:[e.jsxs(le,{className:"pb-3",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs(ne,{className:"text-lg truncate flex items-center gap-2",children:[e.jsx(J,{className:"h-4 w-4 text-primary flex-shrink-0"}),f.name]}),e.jsxs("div",{className:"flex flex-col gap-1.5 items-end",children:[f.missing&&e.jsxs(X,{variant:"destructive",className:"gap-1 animate-pulse",children:[e.jsx(De,{className:"h-3 w-3"}),"Missing"]}),e.jsx(X,{variant:Ts(f.subscription_status),className:"gap-1 text-xs",children:f.subscription_status==="active"?e.jsxs(e.Fragment,{children:[e.jsx(ms,{className:"h-3 w-3"}),"Active"]}):e.jsxs(e.Fragment,{children:[e.jsx(us,{className:"h-3 w-3"}),f.subscription_status==="expired"?"Expired":f.subscription_status==="cancelled"?"Cancelled":f.subscription_status==="pending"?"Pending":"Inactive"]})}),e.jsx(X,{variant:"secondary",className:"capitalize text-xs",children:f.species}),e.jsxs(X,{variant:"outline",className:"text-xs gap-1",children:[f.environment==="indoor"&&"ðŸ  Indoor",f.environment==="outdoor"&&"ðŸŒ³ Outdoor",f.environment==="indoor_outdoor"&&"ðŸ¡ Both"]}),e.jsx(X,{variant:"outline",className:"text-xs capitalize",title:`Physical tag size: ${f.tag_type}`,children:f.tag_type==="dog"?"ðŸ·ï¸ Dog Tag":"ðŸ·ï¸ Cat Tag"})]})]}),e.jsx(Ee,{className:"line-clamp-2 text-sm",children:f.breed||f.description||"No description"})]}),f.photo_url&&e.jsx("div",{className:"px-4 pb-3",children:e.jsx("img",{src:f.photo_url,alt:`${f.name} photo`,className:"w-full h-40 rounded-lg object-cover ring-1 ring-primary/10",loading:"lazy"})}),e.jsxs(ie,{className:"space-y-3 pt-3 border-t",children:[e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs(O,{size:"sm",onClick:()=>m(f),className:"gap-1.5 flex-1 transition-all hover:scale-105",children:[e.jsx(hs,{className:"h-3.5 w-3.5"}),"Edit"]}),e.jsxs(O,{size:"sm",variant:"outline",onClick:()=>k(f),className:"gap-1.5 flex-1 transition-all hover:scale-105",children:[e.jsx(vt,{className:"h-3.5 w-3.5"}),"View"]}),e.jsxs(O,{size:"sm",variant:"outline",onClick:()=>y(f),className:"gap-1.5 flex-1 transition-all hover:scale-105",title:"View QR Code",children:[e.jsx(ps,{className:"h-3.5 w-3.5"}),"QR"]})]}),e.jsxs("div",{className:"flex items-center justify-between pt-2 border-t",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($,{htmlFor:`missing-${f.id}`,className:"text-sm font-medium cursor-pointer",children:"Mark Missing"}),e.jsx(Lt,{id:`missing-${f.id}`,checked:!!f.missing,disabled:R||B.isPending,onCheckedChange:I=>M(f,I)})]}),e.jsxs(O,{size:"sm",variant:"ghost",onClick:()=>b(f),className:"gap-1.5 text-destructive hover:text-destructive hover:bg-destructive/10",children:[e.jsx(gt,{className:"h-3.5 w-3.5"}),"Delete"]})]})]})]},f.id))}):e.jsxs("div",{className:"text-center py-12 space-y-4",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"h-20 w-20 bg-primary/10 rounded-full flex items-center justify-center",children:e.jsx(J,{className:"h-10 w-10 text-primary/60"})})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-lg font-medium text-foreground",children:"No pets yet"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Click ",e.jsx("span",{className:"font-medium text-foreground",children:"Add Pet"})," to create your first pet profile"]})]}),e.jsxs(O,{onClick:()=>p(!0),className:"gap-2 mt-4",children:[e.jsx(we,{className:"h-4 w-4"}),"Add Your First Pet"]})]})})]}),e.jsx(rt,{mode:"add",open:h,onOpenChange:l,onSubmit:C}),d&&e.jsx(rt,{mode:"edit",open:!!d,onOpenChange:f=>!f&&m(null),initialPet:{id:d.id,name:d.name,species:d.species,breed:d.breed??void 0,color:d.color??void 0,weight:d.weight??void 0,birthdate:d.birthdate??void 0,microchipId:d.microchip_id??void 0,description:d.description??void 0,notes:d.notes??void 0,vaccinations:d.vaccinations?{rabies:d.vaccinations.rabies??!1,rabiesExpires:d.vaccinations.rabiesExpires??void 0}:void 0,photoPreview:d.photo_url??void 0,environment:d.environment},onSubmit:C}),a&&e.jsx(Qt,{pet:j,open:!!j,onOpenChange:f=>!f&&y(null),ownerId:a}),e.jsx(Ms,{pet:x,open:!!x,onOpenChange:f=>!f&&b(null),onDeleted:z}),e.jsx(lt,{open:!!w,onOpenChange:f=>!f&&_(null),children:e.jsxs(ot,{children:[e.jsxs(ct,{children:[e.jsxs(dt,{className:"flex items-center gap-2",children:[e.jsx(De,{className:"h-5 w-5 text-orange-500"}),"Mark ",w?.name," as missing?"]}),e.jsx(mt,{children:"This helps highlight their profile and can trigger your outreach flow. You can turn this off later."})]}),e.jsxs(ut,{children:[e.jsx(ht,{disabled:R,children:"Cancel"}),e.jsx(pt,{disabled:R,onClick:F,className:"gap-2",children:R?e.jsxs(e.Fragment,{children:[e.jsx(xt,{className:"h-4 w-4 animate-spin"}),"Savingâ€¦"]}):"Yes, mark missing"})]})]})})]}),e.jsx(je,{value:"locations",className:"mt-4",children:e.jsx(Fs,{})}),e.jsx(je,{value:"activity",className:"mt-4",children:e.jsx(Ps,{days:30})})]})]})}export{hr as default};
